window.fusionForms={onLoad:function(){var e=jQuery("body").hasClass("fusion-builder-live");setTimeout(function(){window.fusionForms.calcSelectArrowDimensions()},100),jQuery(".fusion-form-recaptcha-v2").length&&window.fusionForms.renderRecaptcha(),window.fusionForms.calcTooltipWidth(),e||jQuery("#fusion-form-preview").length||jQuery("body").hasClass("awb-generating-critical-css")||jQuery.each(jQuery(".fusion-form-builder"),function(e,t){var i=jQuery(this).data("config");void 0!==i.nonce_method&&"ajax"!==i.nonce_method||window.fusionForms.ajaxUpdateView(this)}),document.querySelectorAll(".fusion-form-input").forEach(e=>{null===e.getAttribute("data-empty-notice")&&null===e.getAttribute("data-invalid-notice")||(e.addEventListener("input",()=>{e.setCustomValidity(""),e.checkValidity()}),e.addEventListener("invalid",()=>(window.fusionForms.checkIfEmpty(e)&&null!==e.getAttribute("data-empty-notice")?e.setCustomValidity(e.getAttribute("data-empty-notice")):null!==e.getAttribute("data-invalid-notice")&&e.setCustomValidity(e.getAttribute("data-invalid-notice")),!1)),e.addEventListener("change",()=>{"radio"!==e.type&&"checkbox"!==e.type||document.querySelectorAll('input[name="'+e.name+'"]').forEach(e=>{e.setCustomValidity("")})}))})},onReady:function(){formCreatorConfig.post_id="undefined"!=typeof fusion&&"function"==typeof fusion.getCurrentPostID?fusion.getCurrentPostID():0,window.fusionForms.startFlatpickr(),jQuery(".fusion-form-range-field-container").on("change input",function(e){var t=jQuery(e.target),i=parseInt(t.attr("max")),r=parseInt(t.attr("min")),o=parseInt(t.val()),n=t.hasClass("fusion-form-range-value")?".fusion-form-input":".fusion-form-range-value";(o<r||o>i)&&(o=o<r?r:i,t.val(o)),t.siblings(n).val(o)}),jQuery(".fusion-form-upload-field-button").on("click",function(e){e.preventDefault(),jQuery(this).closest(".fusion-form-upload-field-container").find('input[type="file"]').trigger("click")}),jQuery('.fusion-form-upload-field-container input[type="file"]').on("change",function(){window.fusionForms.fileUploadChange(this)}),jQuery(".form-form-submit").on("click",function(e){window.fusionForms.hiddenFields(e,this),window.fusionForms.submitClick(e,this)}),jQuery("form.fusion-form").on("submit",function(e){window.fusionForms.submitForm(e,this)}),jQuery("body").on("click",".fusion-alert .close",function(e){e.preventDefault(),jQuery(this).parent().slideUp()}),jQuery(".fusion-form-field input, .fusion-form-field textarea").on("blur",function(){var e=jQuery(this).closest(".fusion-form-field");e.hasClass("error")&&this.checkValidity()&&e.removeClass("error")}),jQuery(".fusion-form-upload-field").on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){jQuery(this).addClass("focused")}).on("dragleave dragend drop",function(){jQuery(this).removeClass("focused")}).on("drop",function(e){var t=e.originalEvent.dataTransfer.files;jQuery(this).find('input[type="file"]').prop("files",t).trigger("change")})},checkIfEmpty:function(e){var t=!1;switch(e.type){case"radio":case"checkbox":t=null===document.querySelector('input[name="'+e.name+'"]:checked');break;default:t=""===e.value}return t},startFlatpickr:function(){jQuery('.fusion-form-field input[type="date"]').each(function(){var e=jQuery(this),t=e.attr("data-type"),i=e.attr("data-format"),r="custom"===t;"native"!==t&&(i=void 0===i||""===i?"Y-m-d":i,e.flatpickr({allowInput:!0,disableMobile:r,dateFormat:i}))}),jQuery('.fusion-form-field input[type="time"]').each(function(){var e=jQuery(this),t=e.attr("data-type"),i="custom"===t,r="full"===e.attr("data-clock");"native"!==t&&e.flatpickr({allowInput:!0,disableMobile:i,enableTime:!0,noCalendar:!0,dateFormat:r?"H:i":"h:i K",time_24hr:r})})},renderRecaptcha:function(){var e;jQuery.each(jQuery(".fusion-form-recaptcha-v2"),function(t,i){e=jQuery(this).attr("id"),grecaptcha.render(e,{sitekey:jQuery(this).data("sitekey"),type:jQuery(this).data("type"),theme:jQuery(this).data("theme")})})},calcTooltipWidth:function(){jQuery.each(jQuery(".fusion-form-tooltip-content"),function(e,t){var i;jQuery(t).closest(".fusion-form-tooltip").css({position:"inherit"}),i=jQuery(t).width()+23,jQuery(t).css({width:i+"px"}),jQuery(t).closest(".fusion-form-tooltip").removeAttr("style")})},calcSelectArrowDimensions:function(){jQuery(".fusion-form-select-wrapper .select-arrow").filter(":visible").each(function(){0<jQuery(this).prev().innerHeight()&&jQuery(this).css({height:jQuery(this).prev().innerHeight(),width:jQuery(this).prev().innerHeight(),"line-height":jQuery(this).prev().innerHeight()+"px"})})},withinViewport:function(e){var t=e.offset().top,i=t+e.outerHeight(),r=jQuery(window).scrollTop(),o=r+jQuery(window).height();return i>r&&t<o},submitClick:function(e,t){var i,r=jQuery(t).closest("form.fusion-form"),o=jQuery(t).data("form-number"),n=jQuery(".fusion-form-form-wrapper.fusion-form-"+o).data("config"),a=[];"post"!==n.form_type&&(e.preventDefault(),r.find('[data-holds-private-data="true"]').each(function(e,t){a.push(t.name)}),r.find('[name="fusion-fields-hold-private-data"]').length||r.append('<input type="hidden" name="fusion-fields-hold-private-data" value="'+a.join(",")+'">'),setTimeout(function(){i=new CustomEvent("fusion-form-before-submit",{detail:{event:e,form:r,formConfig:n}}),window.dispatchEvent(i),r.trigger("submit")},50))},hiddenFields:function(e,t){jQuery(t).closest("form.fusion-form").find(".fusion-form-field-hidden").find("input, textarea, select").attr("required",!1)},submitForm:function(e,t){var i=jQuery(t),r=i.find(".form-form-submit").data("form-number"),o=jQuery(".fusion-form-form-wrapper.fusion-form-"+r).data("config"),n=i.find('[data-fusion-is-honeypot="true"]'),a=i.find("[data-awb-fieldset-min-required], [data-awb-fieldset-max-required]");if("post"!==o.form_type){if(e.preventDefault(),i.find(".fusion-form-field.error").removeClass("error"),a.each(function(e,t){window.fusionForms.checkCustomRequiredCheckboxNum(jQuery(t))||window.fusionForms.insertCustomRequiredCheckboxMessage(jQuery(t))}),!i[0].checkValidity())return i[0].reportValidity(),void i.find("input:invalid, textarea:invalid").each(function(){jQuery(this).closest(".fusion-form-field").addClass("error")});(n=n.filter(function(e,t){return!!jQuery(t).val()})).length?this.revealAlert(i,"error"):0==i.find(".error:not(.fusion-alert)").length&&window.fusionForms.ajaxSubmit(i,o)}},getFormData:function(e,t){var i,r,o=new FormData,n=e.find('input[type="file"]'),a=e.serializeArray(),f=e.parent().data("form-id"),s=[];for(n.length&&n.each(function(){var e=jQuery(this).attr("name").replace("[]",""),t=this.files.length;jQuery.each(this.files,function(i,r){1<t?o.append("files["+e+"@|@"+(i+1)+"]",r):o.append("files["+e+"]",r)})}),jQuery.each(e.find(".fusion-form-field-hidden input:not(.fusion-form-range-value):not(.fusion-form-upload-field), .fusion-form-field-hidden textarea, .fusion-form-field-hidden select, .fusion-form-honeypot-field input"),function(){var e=jQuery(this).attr("name").replace("[]","");-1===s.indexOf(e)&&s.push(e)}),i=0,r=a.length;i<r;i++)a[i].value=jQuery.trim(a[i].value);return o.append("formData",jQuery.param(a)),o.append("action","fusion_form_submit_ajax"),o.append("fusion_form_nonce",e.find("#fusion-form-nonce-"+f).val()),o.append("form_id",t.form_id),o.append("post_id",t.post_id),o.append("field_labels",JSON.stringify(t.field_labels)),o.append("hidden_field_names",JSON.stringify(s)),e.find(".fusion-form-recaptcha-v2").length&&o.append("g-recaptcha-response",e.find(".g-recaptcha-response").val()),e.find(".fusion-form-recaptcha-v3").length&&o.append("g-recaptcha-response",e.find(".g-recaptcha-response").val()),"url"===t.form_type&&(o.append("fusionAction",e.attr("action")),o.append("fusionActionMethod",e.attr("method"))),o},ajaxSubmit:function(e,t){var i=this,r=window.fusionForms.getFormData(e,t);e.find(".form-form-submit").addClass("fusion-form-working"),jQuery.ajax({type:"POST",url:formCreatorConfig.ajaxurl,data:r,action:"fusion_form_submit_ajax",dataType:"json",processData:!1,contentType:!1}).done(function(o){if(o.captcha||jQuery(e)[0].reset(),"success"==o.status&&"redirect"==t.confirmation_type&&""!==t.redirect_url?window.location=t.redirect_url:i.revealAlert(e,o),jQuery(window).trigger("fusion-form-ajax-submit-done",{result:o,formConfig:t,data:r}),"success"==o.status){const t=e.parent(".fusion-form").data("off-canvas");t&&window.awbOffCanvas.open_off_canvas(t)}}).fail(function(){i.revealAlert(e,"error"),jQuery(window).trigger("fusion-form-ajax-submit-fail",{formConfig:t})}).always(function(){e.find(".form-form-submit").removeClass("fusion-form-working"),window.fusionForms.reloadCaptcha(e),jQuery(window).trigger("fusion-form-ajax-submitted",{formConfig:t,data:r})})},reloadCaptcha:function(e){var t=jQuery(e).closest("form.fusion-form"),i=t.find("div.recaptcha-container").attr("id");void 0!==i&&"undefined"!=typeof active_captcha&&void 0!==active_captcha[i]&&grecaptcha.execute(active_captcha[i],{action:"contact_form"}).then(function(e){t.find("div.recaptcha-container").find(".g-recaptcha-response").val(e)})},revealAlert:function(e,t){var i=e.find(".form-submission-notices"),r="object"==typeof t&&void 0!==t.status?t.status:t,o=-1!==r.indexOf("error")?"error":r,n=i.find(" > .fusion-form-response-"+o);if(i.find(".fusion-form-response").hide(),"error"===r&&"object"==typeof t&&"object"==typeof t.info){const e=n.find(".fusion-alert-content span.errors-wrap");e.length?e.empty():n.find(".fusion-alert-content").append('<span class="errors-wrap"></span>'),jQuery.each(t.info,function(e,t){n.find(".fusion-alert-content span.errors-wrap").append("<br><br>"+t)})}n.length&&(this.withinViewport(i)?(n.attr("role","alert"),n.slideDown(300)):(n.attr("role","alert"),n.css({display:"block"}),jQuery(".fusion-page-load-link").attr("href","#"+i.attr("id")).fusion_scroll_to_anchor_target(30)))},ajaxUpdateView:function(e){jQuery.ajax({type:"POST",url:formCreatorConfig.ajaxurl,data:{action:"fusion_form_update_view",form_id:jQuery(e).data("form-id")},success:function(t){jQuery(e).find(".fusion-form").append(t)},dataType:"html"})},fileUploadChange:function(e){var t=jQuery(e),i=t.val(),r=t.attr("accept"),o=(jQuery(e).prop("files")[0].size/1024/1024).toFixed(4),n=t.data("size"),a=t.closest(".fusion-form-upload-field"),f=i.match(/\.([^\.]+)$/)[1].toLowerCase();if(a.removeClass("error"),1<jQuery(e).prop("files").length){if(i="",jQuery.each(jQuery(e).prop("files"),function(e,s){return o=(s.size/1024/1024).toFixed(4),f=s.name.match(/\.([^\.]+)$/)[1].toLowerCase(),i+=""!==i?", "+s.name.split("\\").pop():s.name.split("\\").pop(),void 0===r||r.toLowerCase().includes(f)?void 0!==n&&o>n?(a.find('input[type="text"]').val(formCreatorConfig.file_size_error+n+"MB"),a.addClass("error"),t.val(""),!1):void 0:(a.find('input[type="text"]').val(formCreatorConfig.file_ext_error+r),a.addClass("error"),t.val(""),!1)}),a.hasClass("error"))return}else{if(i=i.split("\\").pop(),void 0!==r&&!r.toLowerCase().includes(f))return a.find('input[type="text"]').val(formCreatorConfig.file_ext_error+r),a.addClass("error"),void t.val("");if(void 0!==n&&o>n)return a.find('input[type="text"]').val(formCreatorConfig.file_size_error+n+"MB"),a.addClass("error"),void t.val("")}t.closest(".fusion-form-upload-field-container").find(".fusion-form-upload-field").val(i).trigger("change")},checkCustomRequiredCheckboxNum:function(e){var t=e.attr("data-awb-fieldset-min-required"),i=e.attr("data-awb-fieldset-max-required"),r=e.find("input"),o=e.find("input:checked").length,n=r.first();return isNaN(t)&&(t=0),isNaN(i)&&(i=0),(n=n.get(0))&&n.nodeType&&n.setCustomValidity(""),!!e.is(":hidden")||o>=t&&(o<=i||0===parseInt(i))},insertCustomRequiredCheckboxMessage:function(e){var t=e.find("input").first(),i=e.attr("data-awb-fieldset-error");t.length&&(t=t.get(0))&&t.nodeType&&t.setCustomValidity(i)}},function(e){e(window).on("load",function(){window.fusionForms.onLoad()}),e(document).ready(function(){window.fusionForms.onReady()}),e(window).on("fusion-element-render-fusion_form",function(){window.fusionForms.startFlatpickr()})}(jQuery);