var FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.template=_.memoize(function(e){var i,t={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(n){return(i=i||_.template(e,null,t))(n)}}),function(e,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define?define(i):this.fusionBuilderStickyHeader=i()}(0,function(){return function(e,i){var t,n,o,a=document.getElementById("fusion_builder_container"),s=i||0,r=22,u=p(e),l=document.getElementById("fusion_builder_main_container"),d={position:"fixed",top:s+"px",left:u.left+"px",width:u.width+"px","border-top":r+"px solid #ffffff","z-index":999},c={};function f(){var i,n,o,f=jQuery("#fusion_builder_controls").height();if(t=p(l),i="fixed"===jQuery("#fusion_builder_controls").css("position")?t.height+u.height-f:t.height,jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),m().top>u.top-s-r&&m().top+s+r+u.height<t.top+i){for(o in n=a.left+"px",d.left=n,d.width=jQuery("#fusion_builder_container").outerWidth()+"px",d)e.style[o]=d[o];jQuery(".fusion-builder-update-buttons").stop().animate({bottom:0},100)}else{for(o in c)e.style[o]=c[o];m().top+s+r+u.height<t.top&&jQuery(".fusion-builder-update-buttons").stop().animate({bottom:"-50px"},100)}}function p(e){var i,t,n=e.getBoundingClientRect(),o=m();return t=n.top+o.top,jQuery(e).parents("#fusion_builder_layout").hasClass("closed")&&(t=(i=jQuery(e).parents("#fusion_builder_layout").find(".ui-sortable-handle")[0].getBoundingClientRect()).top+i.height+o.top),{left:n.left+o.left,top:t,width:n.width,height:n.height}}function m(){return{top:window.pageYOffset||document.documentElement.scrollTop,left:window.pageXOffset||document.documentElement.scrollLeft}}["position","top","left","z-index","border-top"].forEach(function(i){c[i]=e.style[i],c.width="100%"}),jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),window.onscroll&&(n=window.onscroll),window.onresize&&(o=window.onresize),window.onscroll=function(e){f(),n&&n(e)},window.onresize=function(i){var n=jQuery("#fusion_builder_container").outerWidth()+"px",a=l.top;u=p(e),void 0!==t&&t.top!==a&&(e.style.position="absolute",u=p(e)),jQuery(".fusion-builder-history-list").css("max-height",jQuery(window).height()-100),m().top>u.top-s?e.style.width=n:e.style.width=c.width,f(),o&&o(i)}}});FusionPageBuilder=FusionPageBuilder||{};jQuery(document).ready(function(){FusionPageBuilder.Element=Backbone.Model.extend({defaults:{type:"element"}})});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Studio=Backbone.Model.extend({importData:{},initialize:function(){this.studioData=!1,this.studioRequest=!1},getStudioData:function(){var e=this;if(!e.studioData||!e.studioData)return!1!==e.studioRequest?e.studioRequest:jQuery.post(fusionBuilderConfig.ajaxurl,{action:"fusion_builder_load_studio_elements",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce},function(i){e.studioData=i},"json")},setImportOptions:function(e){var i=e.closest(".studio-wrapper").find(".awb-import-options-group");jQuery.each({"load-type":"load-type-replace","overwrite-type":"replace-pos",invert:"dont-invert",images:"do-import-images"},function(e,t){i.find('input[name="'+e+'"]').is(":checked")||i.find("#"+t).prop("checked",!0)})},getImportOptions:function(e){var i=jQuery(e.currentTarget).closest(".studio-wrapper"),t=i.find('input[name="overwrite-type"]:checked').val(),n=i.find('input[name="invert"]:checked').val(),o=i.find('input[name="load-type"]:checked').val(),a=i.find('input[name="images"]:checked').val();return{overWriteType:t,shouldInvert:n,loadType:o,layoutID:jQuery(e.currentTarget).closest(".fusion-page-layout").data("layout-id"),imagesImport:a}},filterLayouts:function(e){var i="object"==typeof fusionBuilderConfig.plugins_active&&fusionBuilderConfig.plugins_active;return _.filter(e,function(e){var t=!0;return!(!1!==i&&"object"==typeof e.plugins&&(_.each(e.plugins,function(e){i[e]||(t=!1)}),!t)||"object"==typeof e.locations&&!e.locations.includes(fusionBuilderConfig.template_category))})},initFilter:function(e){var i=[],t=this;e.find("li").off(),e.find("li").on("click",function(){var n,o=jQuery(this).closest(".studio-wrapper").find(".studio-imports").find("li.fusion-page-layout"),a=jQuery(this).attr("data-slug"),s=1,r=[],u=[];if(jQuery(this).hasClass("current"))return!1;jQuery.each(i,function(e,i){clearTimeout(i)}),e.find("li.current").removeClass("current"),o.css({display:"none"}).addClass("hidden"),o.each(function(){var e=jQuery(this);if(void 0===e.data("slug"))return!0;"all"!==a&&-1===e.data("slug").indexOf(a)||(e.css({display:"inline-block"}),u.push(e))}),setTimeout(function(){for(jQuery.each(u,function(){var e=jQuery(this),i=e.position();i.$el=e,r.push(i)}),r.sort(t.SortByTop),n=0;n<r.length;n++)i.push(t.doSetTimeout(n,r,s)),s++},50),jQuery(this).addClass("current")})},doSetTimeout:function(e,i,t){setTimeout(function(){i[e].$el.removeClass("hidden")},50*t)},SortByTop:function(e,i){return e.top<i.top?-1:e.top>i.top?1:0},initLazyLoad:function(e){var i,t=e.find(".lazy-load"),n={root:e.closest(".ui-dialog")[0],rootMargin:"0px",threshold:0};"IntersectionObserver"in window?(i=new IntersectionObserver(function(e,t){jQuery.each(e,function(e,t){var n=jQuery(t.target),o=n.find("img");void 0!==o.data("src")&&""!==o.data("src")&&"undefined"!==o.data("src")?t.isIntersecting&&(o.attr("src",o.data("src")),o.imagesLoaded().done(function(){n.removeClass("lazy-load").addClass("lazy-loaded"),o.attr("alt",o.data("alt"))}),i.unobserve(t.target)):i.unobserve(t.target)})},n),t.each(function(){i.observe(this)})):t.each(function(){var e=jQuery(this),i=e.find("img");void 0!==i.data("src")&&""!==i.data("src")&&"undefined"!==i.data("src")&&(i.attr("src",i.data("src")),i.imagesLoaded().done(function(){e.removeClass("lazy-load").addClass("lazy-loaded"),i.attr("alt",i.data("alt"))}))})},setImportData:function(e){this.importData=e},getImportData:function(){return this.importData},resetImportData:function(){this.importData={}}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.Website=FusionPageBuilder.Studio.extend({initialize:function(){this.websiteData=!1,this.websiteRequest=!1,this.layoutIsLoading=!1,this.mediaImportKeys=[],this.state={current:"",title:"",nextCat:""}},getWebsiteData:function(){var e=this;if(!e.websiteData||!e.websiteData)return!1!==e.websiteRequest?e.websiteRequest:jQuery.post(fusionBuilderConfig.ajaxurl,{action:"awb_load_websites",load_website_data:!0,fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce},function(i){_.isNull(i)||(e.websiteData=i)},"json")},initFilter:function(e){var i=[],t=this,n=jQuery("#fusion-builder-layouts-demos");e.find("li").off(),e.find("li").on("click",function(){var n,o=jQuery(this).closest(".studio-wrapper").find(".studio-imports"),a=o.find("li"),s=jQuery(this).attr("data-slug"),r=1,u=[],l=[];if(jQuery(this).hasClass("current"))return!1;jQuery.each(i,function(e,i){clearTimeout(i)}),o.next().hasClass("hidden")||o.removeClass("hidden").next().addClass("hidden").find(".demo-"+t.state.current).addClass("hidden"),e.find("li.current").removeClass("current"),a.css({display:"none"}).addClass("hidden"),a.each(function(){var e=jQuery(this);if(void 0===e.data("slug"))return!0;"all"!==s&&-1===e.data("slug").indexOf(s)||(e.css({display:"inline-block"}),l.push(e))}),setTimeout(function(){for(jQuery.each(l,function(){var e=jQuery(this),i=e.position();i.$el=e,u.push(i)}),u.sort(t.SortByTop),n=0;n<u.length;n++)i.push(t.doSetTimeout(n,u,r)),r++},50),jQuery(this).addClass("current")}),n.find("#awb_sites_search_demos").on("change paste keyup",_.debounce(function(){var e,i,o=jQuery(this).val();"/"===(o=o.replace("https://","").replace("http://",""))[o.length-1]||_.isEmpty(o)||(o+="/"),i=(e=n.find('li[data-page-link="'+o+'"]')).closest(".awb-page-item"),e.length&&(n.find(".site-details").hasClass("hidden")&&n.find(".site-details").removeClass("hidden").prev().addClass("hidden"),e.removeClass("hidden").siblings().addClass("hidden"),t.state.current=i.data("website_id"),t.state.title=i.data("website_title"),i.removeClass("hidden").siblings().addClass("hidden"),t.updateDetailHeader(n))},100))},initImport:function(e){var i=this;e.find(".studio-imports > li").on("click",function(t){t.preventDefault(),i.state.current=jQuery(this).data("website_id"),i.state.title=jQuery(this).data("website_title"),jQuery(this).closest(".studio-imports").addClass("hidden").next().removeClass("hidden").find(".demo-"+i.state.current).removeClass("hidden").find("li.hidden").removeClass("hidden"),i.updateDetailHeader(e)}).end().find(".awb-sites-back-js").on("click",function(e){e.preventDefault(),jQuery(this).closest(".site-details").find(".demo-"+i.state.current).addClass("hidden").end().closest(".site-details").addClass("hidden").prev().removeClass("hidden")}).end().find(".awb-sites-import-js").on("click",this.loadDemoPage.bind(this)).end().find(".awb-sites-next-js").on("click",function(t){t.preventDefault(),e.find('aside li[data-slug="'+i.state.nextCat+'"]').trigger("click")})},updateDetailHeader:function(e){this.state.nextCat=e.find("aside ul > li.current").next().data("slug"),e.find(".awb-sites-title").html(this.state.title),this.state.nextCat&&this.websiteData.tags[this.state.nextCat]?e.find(".awb-sites-next-js").removeClass("vs-hidden").html(this.websiteData.tags[this.state.nextCat].name):e.find(".awb-sites-next-js").addClass("vs-hidden")},loadDemoPage:function(e){var i,t,n,o=this;e&&e.preventDefault(),!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,i=jQuery(e.currentTarget).data("demo-name"),t=jQuery(e.currentTarget).data("post-id"),n=jQuery(e.currentTarget).data("page-id"),jQuery.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"awb_load_websites_page",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,page_id:n,demo_name:i,post_id:t},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),jQuery("body").removeClass("fusion_builder_inner_row_no_scroll"),jQuery(".fusion_builder_modal_inner_row_overlay").remove(),jQuery("#fusion-builder-layouts").hide(),jQuery("#fusion-loader .awb-studio-import-status").html(fusionBuilderText.demo_importing_content)}}).done(function(e){var i,t,n=[],a=jQuery.Deferred(),s=a;if(!(i=JSON.parse(e)).success)return o.layoutIsLoading=!1,alert(fusionBuilderText.api_error_text),void FusionPageBuilderEvents.trigger("fusion-hide-loader");if(a.resolve(),o.mediaImportKeys=[],"object"==typeof i.avada_media&&Object.keys(i.avada_media).forEach(function(e){"object"!=typeof i.avada_media[e]||Array.isArray(i.avada_media[e])||o.mediaImportKeys.push(e)}),0<o.mediaImportKeys.length){for(o.setImportData(i),t=0;t<o.mediaImportKeys.length;t++)!function(e){s=s.then(function(){return o.importMedia(o.getImportData(),o.mediaImportKeys[e])}),n.push(s)}(t);jQuery.when.apply(null,n).then(function(){o.setPageContent(i,o.getImportData().post_content),FusionPageBuilderEvents.trigger("fusion-hide-loader"),o.resetImportData()},function(){jQuery("#fusion-loader .awb-studio-import-status").html(fusionBuilderText.demo_importing_content_failed),FusionPageBuilderEvents.trigger("fusion-hide-loader"),o.resetImportData()})}else o.setPageContent(i,i.post_content),FusionPageBuilderEvents.trigger("fusion-hide-loader")}))},importMedia:function(e,i){var t=this;return jQuery("#fusion-loader .awb-studio-import-status").html(fusionBuilderText.demo_importing_media+" "+i.replace("_"," ")),jQuery.ajax({type:"POST",url:ajaxurl,dataType:"JSON",data:{action:"awb_studio_import_media",data:{mediaImportKey:i,postData:e},fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce},success:function(e){t.setImportData(e)}})},setPageContent:function(e,i){var t;FusionPageBuilderApp.layoutLoaded(),void 0!==e.page_template&&jQuery("#page_template").val(e.page_template),t=e.meta,_.each(t,function(e,i){jQuery("#"+i).val(e).trigger("change")}),FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.createBuilderLayout(i),this.layoutIsLoading=!1}});FusionPageBuilder=FusionPageBuilder||{};jQuery(document).ready(function(){FusionPageBuilder.BaseLibraryView=window.wp.Backbone.View.extend({mediaImportKeys:[],initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-columns-added",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-studio-content-imported",this.loadBuilderAssets),this.attachDynamicEvents()},attachDynamicEvents:function(){},removeDynamicEvents:function(){},removeView:function(){FusionPageBuilderApp.activeModal="",this.removeDynamicEvents(),this.remove()},toggleImportOptions:function(e){var i=jQuery(e.currentTarget).closest(".studio-wrapper");i.hasClass("fusion-studio-preview-active")||i.find(".awb-import-options").toggleClass("open")},loadStudio:function(e){var i=this,t="fusion_template"===e?jQuery("#fusion-builder-"+e+"-studio"):this.$el.find("#fusion-builder-"+e+"-studio"),n=t.find(".studio-imports"),o=t.find("aside > ul");if("1"===fusionBuilderConfig.studio_status){if(FusionPageBuilderApp.studio.setImportOptions(n),!n.children().length)return FusionPageBuilderApp.studio.studioData?void i.insertStudioContent(n,o,e):void jQuery.when(FusionPageBuilderApp.studio.getStudioData()).done(function(){i.insertStudioContent(n,o,e)});FusionPageBuilderApp.studio.initFilter(o),FusionPageBuilderApp.studio.initLazyLoad(n)}},insertStudioContent:function(e,i,t){var n=FusionPageBuilder.template(jQuery("#tmpl-fusion_studio_layout").html()),o={};e.prev(".fusion-loader").hide(),"fusion_template"===t&&"string"==typeof fusionBuilderConfig.template_category&&0<fusionBuilderConfig.template_category.length&&(t=fusionBuilderConfig.template_category),"fusion_template"===t&&"string"==typeof fusionBuilderConfig.post_type&&"fusion_form"===fusionBuilderConfig.post_type&&(t="forms"),"fusion_template"===t&&"string"==typeof fusionBuilderConfig.post_type&&"awb_off_canvas"===fusionBuilderConfig.post_type&&(t="awb_off_canvas"),"object"==typeof FusionPageBuilderApp.studio.studioData&&void 0!==FusionPageBuilderApp.studio.studioData[t]&&(o=FusionPageBuilderApp.studio.filterLayouts(FusionPageBuilderApp.studio.studioData[t]),_.each(o,function(i){e.append(jQuery(n(i)))}),i.append('<li data-slug="all" class="current">'+fusionBuilderText.all+" <span>"+_.size(o)+"</span></li>"),_.each(FusionPageBuilderApp.studio.studioData.studio_tags[t],function(e){i.append('<li data-slug="'+e.slug+'">'+e.name+" <span>"+e.count+"</span></li>")})),FusionPageBuilderApp.studio.initFilter(i),FusionPageBuilderApp.studio.initLazyLoad(e)},importStudioMedia:function(e,i,t){return jQuery(".fusion-loader .awb-studio-import-status").html(fusionBuilderText.studio_importing_media+" "+i.replace("_"," ")),jQuery.ajax({type:"POST",url:ajaxurl,dataType:"JSON",data:{action:"awb_studio_import_media",data:{mediaImportKey:i,postData:e},overWriteType:t.overWriteType,shouldInvert:t.shouldInvert,imagesImport:t.imagesImport,fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce},success:function(e){FusionPageBuilderApp.studio.setImportData(e)}})},loadWebsite:function(){var e=this,i=jQuery("#fusion-builder-layouts-demos");if(!i.find(".studio-imports").children().length){if(FusionPageBuilderApp.website.websiteData)return void e.insertWebsiteContent(i);jQuery.when(FusionPageBuilderApp.website.getWebsiteData()).done(function(){e.insertWebsiteContent(i)})}},insertWebsiteContent:function(e){var i=e.find(".studio-imports"),t=e.find("aside"),n=e.find(".awb-pages-container"),o=FusionPageBuilder.template(jQuery("#tmpl-fusion_website_layout").html()),a=FusionPageBuilder.template(jQuery("#tmpl-fusion_website_pages").html()),s=FusionPageBuilder.template(jQuery("#tmpl-fusion_website_tags").html()),r={};i.prev(".fusion-loader").hide(),"object"==typeof FusionPageBuilderApp.website.websiteData?(e.find(".awb-sites-failed-msg").hide().end().find(".awb-sites-wrapper").css("display",""),r=FusionPageBuilderApp.website.websiteData.data,_.each(r,function(e){i.append(jQuery(o(e))),n.append(jQuery(a(e)))}),t.append(jQuery(s(FusionPageBuilderApp.website.websiteData)))):e.find(".awb-sites-failed-msg").show().end().find(".awb-sites-wrapper").hide(),FusionPageBuilderApp.website.initFilter(t),FusionPageBuilderApp.website.initLazyLoad(i),FusionPageBuilderApp.website.initImport(e)},loadBuilderAssets:function(e){void 0!==e.custom_icons&&(jQuery.each(e.custom_icons,function(e,i){jQuery("head").append('<link rel="stylesheet" id="'+i.post_name+'" href="'+i.css_url+'" type="text/css" media="all">'),Array.isArray(fusionBuilderConfig.customIcons)&&0===fusionBuilderConfig.customIcons.length&&(fusionBuilderConfig.customIcons={}),fusionBuilderConfig.customIcons[i.post_name]=i}),FusionPageBuilder.reInitIconPicker())}})});FusionPageBuilder=FusionPageBuilder||{};jQuery(document).ready(function(){var e,i=[],t=[],n=[],o=[],a=0;jQuery("#content").text(),e=_.sortBy(fusionAllElements,function(e){return e.name.toLowerCase()}),_.each(e,function(e){var a,s=t;if(void 0===e.hide_from_builder){if(a={title:e.name,label:e.shortcode},void 0!==e.component&&e.component&&(s=n),void 0!==e.allow_in_form&&e.allow_in_form&&o.push(a),void 0!==e.form_component&&e.form_component)return void o.push(a);void 0===e.generator_only&&void 0===e.form_component&&i.push(a),s.push(Object.assign({},a,{generator_only:void 0!==e.generator_only||e.generator_only,templates:void 0!==e.templates&&e.templates,components_per_template:void 0!==e.components_per_template&&e.components_per_template,template_tooltip:void 0!==e.template_tooltip&&e.template_tooltip}))}}),n.forEach(function(e){"string"!=typeof fusionBuilderConfig.template_category||"object"==typeof e.templates&&!e.templates.includes(fusionBuilderConfig.template_category)||a++}),FusionPageBuilder.ViewManager=Backbone.Model.extend({defaults:{modules:i,generator_elements:t,components:n,componentsCounter:a,elementCount:0,form_components:o,views:{}},getView:function(e){return this.get("views")[e]},getChildViews:function(e){var i=this.get("views"),t={};return _.each(i,function(i,n){e===i.model.attributes.parent&&(t[n]=i)}),t},generateCid:function(){var e=this.get("elementCount")+1;return this.set({elementCount:e}),e},addView:function(e,i){var t=this.get("views");t[e]=i,this.set({views:t})},removeView:function(e){var i=this.get("views"),t={};_.each(i,function(i,n){n!=e&&(t[n]=i)}),this.set({views:t})},removeViews:function(){this.set({views:{}})},countElementsByType:function(e){var i=this.get("views"),t=0;return _.each(i,function(i){i.model.attributes.element_type===e&&t++}),t}}),window.FusionPageBuilderViewManager=new FusionPageBuilder.ViewManager});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.DynamicValues=Backbone.Model.extend({defaults:{values:{},options:{},optionTypes:{},orderedParams:!1},getOrderedParams:function(){var e=this.get("orderedParams"),i=this.getOptions();return e||(e={},_.each(i,function(i,t){var n,o;"object"==typeof i&&(o=n=i.group,"string"!=typeof i.group&&(n="other",o=fusionBuilderText.other),n=n.replace(/\s+/g,"_").toLowerCase(),"object"!=typeof e[n]&&(e[n]={label:"",params:{}}),e[n].label=o,e[n].params[t]=i)})),e},addData:function(e,i,t){this.set("values",e),this.set("options",i),this.set("optionTypes",t)},supportsType:function(e){var i=_.values(this.getOptionTypes());return-1!==_.indexOf(i,e)},getOptionTypes:function(){var e=this.get("optionTypes");return jQuery.extend(!0,{},e)},getOptions:function(){var e=this.get("options");return jQuery.extend(!0,{},e)},getOption:function(e){var i=this.getOptions();return void 0!==i[e]&&i[e]},getAll:function(){var e=this.get("values");return jQuery.extend(!0,{},e)}});FusionPageBuilder=FusionPageBuilder||{};jQuery,FusionPageBuilder.DynamicParams=Backbone.Model.extend({defaults:{params:{},elementView:!1,backup:{}},initialize:function(){},setData:function(e){"object"==typeof e&&this.set("params",e)},getAll:function(){var e=this.get("params");return jQuery.extend(!0,{},e)},createBackup:function(){this.set("backup",this.getAll())},restoreBackup:function(){this.set("params",this.get("backup")),this.set("backup",{})},hasDynamicParam:function(e){return void 0!==this.getAll()[e]},addParam:function(e,i){var t=this.getAll(),n=FusionPageBuilderApp.dynamicValues.getOptions();"object"!=typeof i&&(i={data:i}),_.each(n[i.data].fields,function(e,t){void 0===i[t]&&(void 0!==e.default?i[t]=e.default:void 0!==e.value&&(i[t]=e.value))}),t[e]=i,this.set("params",t),FusionPageBuilderEvents.trigger("fusion-dynamic-data-added",e)},updateParam:function(e,i,t){var n=this.getAll();"object"==typeof n[e]&&(n[e][i]=t,this.set("params",n))},removeParam:function(e){var i=this.getAll();this.get("elementView"),delete i[e],this.set("params",i),FusionPageBuilderEvents.trigger("fusion-dynamic-data-removed",e)}});FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.Collection=Backbone.Collection.extend({model:FusionPageBuilder.Element}),window.FusionPageBuilderElements=new FusionPageBuilder.Collection});FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ElementView=window.wp.Backbone.View.extend({className:"fusion_module_block fusion_builder_column_element",template:FusionPageBuilder.template(e("#fusion-builder-block-module-template").html()),events:{"click .fusion-builder-settings":"showSettings","click .fusion-builder-clone-module":"cloneElement","click .fusion-builder-remove":"removeElement","click .fusion-builder-save-module-dialog":"saveElementDialog"},initialize:function(){this.elementIsCloning=!1,this.initDynamicParams()},initDynamicParams:function(){var e="object"==typeof this.model.get("params")?this.model.get("params"):{},i=e.dynamic_params;if("string"==typeof e.dynamic_params&&""!==e.dynamic_params)try{FusionPageBuilderApp.base64Encode(FusionPageBuilderApp.base64Decode(i))===i&&(i=FusionPageBuilderApp.base64Decode(i),i=_.unescape(i),i=JSON.parse(i)),this.model.set("dynamic_params",i)}catch(e){}},render:function(){return this.$el.html(this.template(this.model.attributes)),void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-element",this.model.attributes.params.fusion_global,this.model.get("cid")),this},saveElementDialog:function(i){i&&i.preventDefault(),FusionPageBuilderApp.showLibrary(),e("#fusion-builder-layouts-elements-trigger").click(),e("#fusion-builder-layouts-elements .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_element+"</a></div></div>")},saveElement:function(i){var t=this.getElementContent(),n=e("#fusion_builder_main_container"),o=e("#fusion-builder-save-element-input").val(),a=e("#fusion_save_global").is(":checked"),s=e("#fusion-builder-layouts-elements .fusion-page-layouts"),r=e("#fusion-builder-layouts-elements .fusion-page-layouts .fusion-empty-library-message"),u=this.model,l=!1,d=null,c={};i&&i.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<n.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(d=this.model.attributes.params.fusion_global,delete(c=this.model.get("params")).fusion_global,this.model.set("params",c),t=this.getElementContent(),c.fusion_global=d,this.model.set("params",c)),e.each(jQuery("ul.fusion-page-layouts.fusion-layout-elements li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(e=e.replace(/\u2013|\u2014/g,"-"),o.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),l=!0,!1}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==l&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==o?e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:o,fusion_save_global:a,fusion_layout_content:t,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"elements"},complete:function(i){FusionPageBuilderApp.layoutIsSaving=!1,s.prepend(i.responseText),e(".fusion-save-element-fields").remove(),r.hide(),a&&(u.attributes.params.fusion_global=e(i.responseText).attr("data-layout_id"),e('div.fusion_builder_column_element[data-cid="'+u.get("cid")+'"]').addClass("fusion-global-element"),e('div.fusion_builder_column_element[data-cid="'+u.get("cid")+'"]').attr("fusion-global-layout",e(i.responseText).attr("data-layout_id")),e('div.fusion_builder_column_element[data-cid="'+u.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+u.get("cid")+'"><span>'+fusionBuilderText.global_element+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,u.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getElementContent:function(){return FusionPageBuilderApp.generateElementShortcode(this.$el,!1)},removeElement:function(e){var i;e&&e.preventDefault(),i=this.model.get("parent"),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,i)},cloneElement:function(i,t){var n;i&&i.preventDefault(),this.$el.children(".fusion-builder-module-controls-container").hasClass("cloning-disabled")||!0===this.elementIsCloning||(this.elementIsCloning=!0,(n=e.extend(!0,{},this.model.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),n.targetElement=this.$el,"undefined"!==n.from&&delete n.from,t&&(n.parent=t),FusionPageBuilderApp.collection.add(n),t||(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.elementIsCloning=!1,i&&FusionPageBuilderEvents.trigger("fusion-element-cloned"),n.parent&&setTimeout(FusionPageBuilderApp.checkGlobalParents,500,n.parent))},showSettings:function(i){var t,n={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};i&&i.preventDefault(),t=new FusionPageBuilder.ModalView(n),e("body").append(t.render().el)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.ElementPreviewView=window.wp.Backbone.View.extend({className:"fusion_module_block_preview ",dynamicParams:{},contentPreviewElements:["fusion_text","fusion_title","fusion_alert","fusion_button","fusion_imageframe","fusion_sharing"],globalIconPlaceholder:"#fusion_dynamic_data_icon#",initialize:function(){this.dynamicParams=this.options.dynamicParams,jQuery("#"+fusionAllElements[this.model.attributes.element_type].preview_id).length?this.template=FusionPageBuilder.template(jQuery("#"+fusionAllElements[this.model.attributes.element_type].preview_id).html()):this.template=FusionPageBuilder.template(jQuery("#fusion-builder-block-module-default-preview-template").html())},render:function(){var e=this.template(this.getTemplateAttributes());return this.$el.html(this.updatePreview(e)),this},getTemplateAttributes:function(){var e=jQuery.extend(!0,{},this.model.attributes),i=this.getDynamicData(),t="";return-1!==this.contentPreviewElements.indexOf(this.model.attributes.element_type)&&(_.isEmpty(i)||void 0===i.element_content||(t="","undefined"!=typeof FusionApp&&void 0!==FusionApp.data.dynamicOptions[i.element_content.data]?t=FusionApp.data.dynamicOptions[i.element_content.data].label:void 0!==fusionDynamicData.dynamicOptions[i.element_content.data]&&(t=fusionDynamicData.dynamicOptions[i.element_content.data].label),e.params.element_content=this.globalIconPlaceholder+t)),e},updatePreview:function(e){var i,t=this.getDynamicData(),n=[],o=!1,a='<span class="fusiona-dynamic-data"></span>',s="",r="";return void 0!==this.model.attributes.multi&&"multi_element_parent"===this.model.attributes.multi&&void 0!==this.model.attributes.params.element_content&&-1!==this.model.attributes.params.element_content.indexOf("dynamic_params")&&(o=!0),-1!==this.contentPreviewElements.indexOf(this.model.attributes.element_type)||_.isEmpty(t)&&!o||(i=jQuery("<div />",{html:e}),o&&(i.find("ul").remove(),void 0!==fusionAllElements[this.model.attributes.element_type]&&void 0!==fusionAllElements[fusionAllElements[this.model.attributes.element_type].element_child]&&(r=fusionAllElements[fusionAllElements[this.model.attributes.element_type].element_child].name,n.push(r))),_.each(t,function(e){s="","undefined"!=typeof FusionApp&&void 0!==FusionApp.data.dynamicOptions[e.data]?s=FusionApp.data.dynamicOptions[e.data].label:void 0!==fusionDynamicData.dynamicOptions[e.data]&&(s=fusionDynamicData.dynamicOptions[e.data].label),n.push(s)}),i.append('<div class="fusion-builder-dynamic-data-preview fusion-builder-dynamic-data-preview-inline">'+a+n.join(", ")+"</div>"),e=i.html()),e.replace(this.globalIconPlaceholder,a)},getDynamicData:function(){var e={};return void 0!==this.dynamicParams?e=this.dynamicParams.getAll():void 0!==this.model.attributes.dynamic_params&&(e=this.model.attributes.dynamic_params),e}})});FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ElementLibraryView=FusionPageBuilder.BaseLibraryView.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(e("#fusion-builder-modules-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element:not(.fusion-builder-element-generator,.fusion-builder-disabled-element)":"addModule","click .fusion_builder_custom_elements_load":"addCustomModule","click .fusion-builder-column-layouts li":"addNestedColumns","click .awb-import-options-toggle":"toggleImportOptions","click .awb-import-studio-item":"loadStudioElement"},render:function(){var e=this;return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),FusionPageBuilderApp.showSavedElements("elements",this.$el.find("#custom-elements")),"true"===FusionPageBuilderApp.innerColumn&&this.$el.addClass("fusion-add-to-nested"),this.loadStudio("elements"),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addCustomModule:function(i){var t,n,o;i&&i.preventDefault(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,t=e(i.currentTarget).closest("li").data("layout_id"),n=e(i.currentTarget).find(".fusion_module_title").text(),o=e(i.currentTarget).closest("li").hasClass("fusion-global"),e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:o,fusion_layout_id:t}}).done(function(t){var n=JSON.parse(t);FusionPageBuilderApp.shortcodesToBuilder(n.post_content,FusionPageBuilderApp.parentColumnId),FusionPageBuilderApp.layoutIsLoading=!1,e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide(),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,FusionPageBuilderApp.parentColumnId)}).always(function(){fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_element+n,FusionPageBuilderEvents.trigger("fusion-element-added")}))},loadStudioElement:function(e){var i,t,n=this,o=jQuery(e.currentTarget).closest(".fusion-page-layout"),a=FusionPageBuilderApp.studio.getImportOptions(e);e&&e.preventDefault(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,i=o.data("layout-id"),void 0!==this.options.targetElement&&(t=this.options.targetElement),jQuery.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"JSON",data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:!1,fusion_layout_id:i,overWriteType:a.overWriteType,shouldInvert:a.shouldInvert,imagesImport:a.imagesImport,fusion_studio:!0,category:"elements",post_id:fusionBuilderConfig.post_id},beforeSend:function(){jQuery("#fusion-builder-elements-studio").find(".fusion-loader").show(),jQuery("#fusion-builder-elements-studio").find(".studio-wrapper").addClass("loading"),jQuery(".fusion-loader .awb-studio-import-status").html(fusionBuilderText.studio_importing_content)},success:function(i){var o,s=[],r=jQuery.Deferred(),u=r;if(r.resolve(),n.mediaImportKeys=[],"object"==typeof i.avada_media&&Object.keys(i.avada_media).forEach(function(e){"object"!=typeof i.avada_media[e]||Array.isArray(i.avada_media[e])||n.mediaImportKeys.push(e)}),0<n.mediaImportKeys.length){for(FusionPageBuilderApp.studio.setImportData(i),o=0;o<n.mediaImportKeys.length;o++)!function(e){u=u.then(function(){return n.importStudioMedia(FusionPageBuilderApp.studio.getImportData(),n.mediaImportKeys[e],a)}),s.push(u)}(o);jQuery.when.apply(null,s).then(function(){void 0!==t?FusionPageBuilderApp.shortcodesToBuilder(FusionPageBuilderApp.studio.getImportData().post_content,FusionPageBuilderApp.parentColumnId,!1,!1,t,"after"):FusionPageBuilderApp.shortcodesToBuilder(FusionPageBuilderApp.studio.getImportData().post_content,FusionPageBuilderApp.parentColumnId),FusionPageBuilderApp.layoutIsLoading=!1,FusionPageBuilderEvents.trigger("fusion-studio-content-imported",FusionPageBuilderApp.studio.getImportData()),n.studioElementImportComplete(e),FusionPageBuilderApp.studio.resetImportData()},function(){jQuery(".fusion-loader .awb-studio-import-status").html(fusionBuilderText.studio_importing_content_failed),n.studioElementImportComplete(e),FusionPageBuilderApp.studio.resetImportData()})}else void 0!==t?FusionPageBuilderApp.shortcodesToBuilder(i.post_content,FusionPageBuilderApp.parentColumnId,!1,!1,t,"after"):FusionPageBuilderApp.shortcodesToBuilder(i.post_content,FusionPageBuilderApp.parentColumnId),FusionPageBuilderApp.layoutIsLoading=!1,FusionPageBuilderEvents.trigger("fusion-studio-content-imported",i),n.studioElementImportComplete(e)}}))},studioElementImportComplete:function(e){var i=jQuery(e.currentTarget).closest(".fusion-page-layout").find(".fusion_module_title").text();jQuery("#fusion-builder-elements-studio").find(".fusion-loader").hide(),jQuery("#fusion-builder-elements-studio").find(".studio-wrapper").removeClass("loading"),FusionPageBuilderApp.loaded=!0,this.model.unset("added"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_studio_element+i,FusionPageBuilderEvents.trigger("fusion-element-added")},addModule:function(i){var t,n,o,a,s,r,u;i&&i.preventDefault(),(t=e(i.currentTarget).find(".fusion_module_label").text())in fusionAllElements?(n=fusionAllElements[t].params,a=fusionAllElements[t].multi,s=fusionAllElements[t].shortcode,r=fusionAllElements[t].name,u=fusionAllElements[t].allow_generator,o=fusionAllElements[t].params,n={},_.each(o,function(e){n[e.param_name]=_.isObject(e.value)?e.default:e.value})):(n="",a="",s="",u=""),i&&(window.fusionHistoryState=fusionBuilderText.added+" "+r+" "+fusionBuilderText.element),this.collection.add([{type:"element",added:"manually",cid:FusionPageBuilderViewManager.generateCid(),element_type:s,params:n,parent:this.attributes["data-parent_cid"],view:this.options.view,allow_generator:u,multi:a}]),this.remove(),FusionPageBuilderEvents.trigger("fusion-element-added")},addNestedColumns:function(i,t){var n,o,a,s,r,u,l;i&&i.preventDefault(),n=FusionPageBuilderViewManager.generateCid(),this.collection.add([{type:"fusion_builder_row_inner",element_type:"fusion_builder_row_inner",cid:n,parent:this.model.get("cid"),view:this,appendAfter:t}]),FusionPageBuilderApp.activeModal="column",o=this,a=(e(i.target).is("li")?e(i.target):e(i.target).closest("li")).data("layout").split(","),_.size(a),s=this.options.view,r=fusionAllElements.fusion_builder_column_inner.params,u={},_.each(r,function(e){l=_.isObject(e.value)?e.default:e.value,u[e.param_name]=l}),_.each(a,function(e,i){var t={type:"fusion_builder_column_inner",element_type:"fusion_builder_column_inner",cid:FusionPageBuilderViewManager.generateCid(),parent:n,layout:e,view:s,params:u};o.collection.add([t])}),this.remove(),FusionPageBuilderEvents.trigger("fusion-columns-added"),i&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.GeneratorElementsView=window.wp.Backbone.View.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(e("#fusion-builder-generator-modules-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element":"addElement","click .fusion-builder-column-layouts .generator-column":"addColumns","click .fusion-builder-column-layouts .generator-section":"addContainer"},initialize:function(e){this.options=e,this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.remove)},render:function(){var e=this;return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},addElement:function(i){var t,n,o,a,s,r,u,l;i&&i.preventDefault(),(t=e(i.currentTarget)).find(".fusion_module_title").text(),(n=t.find(".fusion_module_label").text())in fusionAllElements?(a=fusionAllElements[n].multi,s=fusionAllElements[n].shortcode):(o="",a="",s=""),u=e.extend(!0,{},fusionAllElements[n].params),o={},_.each(u,function(e){var i;i=_.isObject(e.value)?e.default:e.value,o[e.param_name]=i}),l={type:"generated_element",added:"manually",element_type:s,params:o,view:this.options.view,multi:a,cid:FusionPageBuilderViewManager.generateCid()},"undefined"!==o.element_content&&"undefined"!=typeof tinyMCE&&"undefined"!==tinyMCE.activeEditor&&void 0===a&&window.tinyMCE.activeEditor&&(r=window.tinyMCE.activeEditor.selection.getContent())&&(l.params.element_content=r,window.tinyMCE.activeEditor.selection.setContent(""),r="",delete l.added),this.collection.add(l),this.remove()},addColumns:function(i){var t,n,o,a,s,r,u,l="[fusion_builder_row_inner]",d="fusion_builder_column_inner",c="[/fusion_builder_row_inner]";!FusionPageBuilderApp.builderActive&&jQuery(i.target).parents("#builder-regular-columns").length&&(l="",d="fusion_builder_column",c=""),i&&i.preventDefault(),FusionPageBuilderApp.activeModal="column",t=this,n=(e(i.target).is("li")?e(i.target):e(i.target).closest("li")).data("layout").split(","),_.size(n),o=this.options.view,a=fusionAllElements[d].params,s={},_.each(a,function(e){r=_.isObject(e.value)?e.default:e.value,s[e.param_name]=r}),_.each(n,function(e,i){var n;s.type=e,n={type:"generated_element",added:"manually",element_type:d,layout:e,view:o,params:s},u=t.collection.add(n),l+=FusionPageBuilderApp.generateElementShortcode(u,!1,!0)}),l+=c,fusionBuilderInsertIntoEditor(l,FusionPageBuilderApp.shortcodeGeneratorEditorID),FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID="",this.remove()},addContainer:function(e){var i,t,n;e&&e.preventDefault(),FusionPageBuilderApp.activeModal="container",FusionPageBuilderViewManager.generateCid(),i=fusionAllElements.fusion_builder_container.params,t={},_.each(i,function(e){n=_.isObject(e.value)?e.default:e.value,t[e.param_name]=n}),this.collection.add([{type:"generated_element",added:"manually",element_type:"fusion_builder_container",params:t,view:this}])}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ContainerView=window.wp.Backbone.View.extend({className:"fusion_builder_container",template:FusionPageBuilder.template(e("#fusion-builder-container-template").html()),events:{"click .fusion-builder-clone-container":"cloneContainer","click .fusion-builder-remove":"removeContainer","click .fusion-builder-section-add":"addContainer","click .fusion-builder-toggle":"toggleContainer","click .fusion-builder-settings-container":"showSettings","paste .fusion-builder-section-name":"renameContainer","keydown .fusion-builder-section-name":"renameContainer","click .fusion-builder-save-element":"saveElementDialog"},initialize:function(){this.typingTimer,this.doneTypingInterval=800},render:function(){return this.setValues(),this.$el.html(this.template(this.model.toJSON())),void 0!==this.model.attributes.params.admin_toggled&&"yes"===this.model.attributes.params.admin_toggled&&(this.$el.addClass("fusion-builder-section-folded"),this.$el.find("span").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down")),void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-container",this.model.attributes.params.fusion_global,this.model.get("cid")),this.updateStatusIcons(),this},setValues:function(){var e=this.model.get("params"),i="object"==typeof fusionAllElements?fusionAllElements.fusion_builder_container.defaults:{},t=jQuery.extend(!0,{},i,e);this.model.set("values",t)},updateFlexOptions:function(){var e,i="fusion-builder-section-content fusion-builder-data-cid";this.setValues(),"flex"===(e=this.model.get("values")).type&&(i+=" fusion-flex-container",i+=" fusion-flex-align-items-"+e.flex_align_items,"stretch"!==e.align_content&&(i+=" fusion-flex-align-content-"+e.align_content),"flex-start"!==e.flex_justify_content&&(i+=" fusion-flex-justify-content-"+e.flex_justify_content)),this.$el.find(".fusion-builder-section-content").attr("class",i)},updateStatusIcons:function(){var e=this.$el.find(".fusion-builder-container-utility-toolbar"),i="";e.find(".fusion-builder-publish-tooltip").remove(),"draft"===this.model.attributes.params.status?(i='<div class="fusion-builder-publish-tooltip fusion-container-draft" data-cid="'+this.model.get("cid")+'"><span>'+fusionBuilderText.container_draft+"<br>"+fusionBuilderText.container_publish+"</span></div>",e.prepend(i)):"published_until"!==this.model.attributes.params.status&&"publish_after"!==this.model.attributes.params.status||(i='<div class="fusion-builder-publish-tooltip fusion-container-scheduled" data-cid="'+this.model.get("cid")+'"><span>'+fusionBuilderText.container_scheduled+"<br>"+fusionBuilderText.container_publish+"</span></div>",e.prepend(i))},saveElement:function(i){var t=this.getContainerContent(),n=e("#fusion_builder_main_container"),o=e("#fusion-builder-save-element-input").val(),a=e("#fusion_save_global").is(":checked"),s=e("#fusion-builder-layouts-sections .fusion-page-layouts"),r=e("#fusion-builder-layouts-sections .fusion-empty-library-message"),u=this.model,l=!1,d=null,c={};i&&i.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<n.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(d=this.model.attributes.params.fusion_global,delete(c=this.model.get("params")).fusion_global,this.model.set("params",c),t=this.getContainerContent(),c.fusion_global=d,this.model.set("params",c)),e.each(jQuery("ul.fusion-page-layouts.fusion-layout-sections li"),function(e,i){var t,n=jQuery(this).find("h4.fusion-page-layout-title");if(n.length&&(t=(t=n.html().split("<div ")[0]).replace(/\u2013|\u2014/g,"-"),o.toLowerCase().trim()===t.toLowerCase().trim()))return alert(fusionBuilderText.duplicate_element_name_error),l=!0,!1}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==l&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==o?e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:o,fusion_save_global:a,fusion_layout_content:t,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"sections"},complete:function(i){FusionPageBuilderApp.layoutIsSaving=!1,s.prepend(i.responseText),e(".fusion-save-element-fields").remove(),r.hide(),a&&(u.attributes.params.fusion_global=e(i.responseText).attr("data-layout_id"),e('div[data-cid="'+u.get("cid")+'"]').closest(".fusion_builder_container").addClass("fusion-global-container"),e('div[data-cid="'+u.get("cid")+'"]').attr("fusion-global-layout",e(i.responseText).attr("data-layout_id")),e('div[data-cid="'+u.get("cid")+'"]').closest(".fusion_builder_container").find(".fusion-builder-container-utility-toolbar").length?e('div[data-cid="'+u.get("cid")+'"]').closest(".fusion_builder_container").find(".fusion-builder-container-utility-toolbar").append('<div class="fusion-builder-global-tooltip" data-cid="'+u.get("cid")+'"><span>'+fusionBuilderText.global_container+"</span></div>"):e('div[data-cid="'+u.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+u.get("cid")+'"><span>'+fusionBuilderText.global_container+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0)}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getContainerContent:function(i,t,n){var o="",a=this.$el.find(".fusion-builder-section-content");return o+=FusionPageBuilderApp.generateElementShortcode(this.$el,!0),a.find(".fusion_builder_row").each(function(){var i=e(this);o+="[fusion_builder_row]",i.find(".fusion-builder-column-outer").each(function(){var i=e(this),t=i.data("cid"),n=FusionPageBuilderViewManager.getView(t);o+=n.getColumnContent(i)}),o+="[/fusion_builder_row]"}),o+="[/fusion_builder_container]"},saveElementDialog:function(i){var t;t=void 0!==this.model.get("admin_label")&&""!==this.model.get("admin_label")?this.model.get("admin_label"):"",i&&i.preventDefault(),FusionPageBuilderApp.showLibrary(),e("#fusion-builder-layouts-sections-trigger").click(),e("#fusion-builder-layouts-sections .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="'+t+'" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_section+"</a></div></div>")},showSettings:function(i){var t,n={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};i&&i.preventDefault(),void 0===n.model.attributes.params.type&&(n.model.attributes.params.type=1===parseInt(fusionBuilderConfig.container_legacy_support)?"legacy":"flex"),1===parseInt(fusionBuilderConfig.is_header_layout_section_edited)&&(n.model.attributes.params.type="flex"),t=new FusionPageBuilder.ModalView(n),e("body").append(t.render().el),this.hideHundredPercentOption()},hideHundredPercentOption:function(){var e=jQuery("#page_template"),i=jQuery("#pyre_blog_width_100").val(),t=jQuery("#pyre_portfolio_width_100").val(),n=jQuery('.fusion_builder_container li[data-option-id="hundred_percent"]'),o="object"==typeof fusionBuilderConfig.is_content_override_active;jQuery("body").hasClass("fusion-tb-section-edit")||!1!==o?"no"===jQuery("#pyre_fusion_tb_section_width_100").val()&&n.hide():void 0!==i||"fusion_element"===fusionBuilderConfig.post_type||"fusion_template"===fusionBuilderConfig.post_type?("no"===i||"default"===i&&""===FusionPageBuilderApp.fullWidth)&&n.hide():void 0!==t?("no"===t||"default"===t&&""===FusionPageBuilderApp.fullWidth)&&n.hide():"100-width.php"!==e.val()&&n.hide()},addContainer:function(e){var i,t,n,o;e&&(e.preventDefault(),FusionPageBuilderApp.newContainerAdded=!0),FusionPageBuilderApp.activeModal="container",i=FusionPageBuilderViewManager.generateCid(),t=fusionAllElements.fusion_builder_container.params,n={},_.each(t,function(e){o=_.isObject(e.value)?e.default:e.value,n[e.param_name]=o,"dimension"===e.type&&_.isObject(e.value)&&_.each(e.value,function(e,i){n[i]=e})}),this.collection.add([{type:"fusion_builder_container",added:"manually",element_type:"fusion_builder_container",cid:i,params:n,view:this,created:"auto"}]),FusionPageBuilderApp.activeModal=""},addRow:function(){var e=FusionPageBuilderViewManager.generateCid();this.collection.add([{type:"fusion_builder_row",element_type:"fusion_builder_row",added:"manually",cid:e,parent:this.model.get("cid"),view:this}])},cloneContainer:function(i){var t;i&&i.preventDefault(),(t=e.extend(!0,{},this.model.attributes)).cid=FusionPageBuilderViewManager.generateCid(),t.created="manually",t.view=this,FusionPageBuilderApp.collection.add(t),this.$el.find(".fusion-builder-row-content:not(.fusion_builder_row_inner .fusion-builder-row-content)").each(function(){var i=e(this),n=i.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===n}),a=e.extend(!0,{},o.attributes);a.created="manually",a.cid=FusionPageBuilderViewManager.generateCid(),a.parent=t.cid,FusionPageBuilderApp.collection.add(a),i.find(".fusion-builder-column-outer").each(function(){var i=e(this),t=i.data("cid"),n=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),o=e.extend(!0,{},n.attributes);o.created="manually",o.cid=FusionPageBuilderViewManager.generateCid(),o.parent=a.cid,o.from="fusion_builder_container",o.cloned=!0,FusionPageBuilderApp.collection.add(o),i.children(".fusion_module_block, .fusion_builder_row_inner").each(function(){var i,t,n,a,s,r;e(this).hasClass("fusion_module_block")?(i=e(this),t=i.data("cid"),n=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),(a=e.extend(!0,{},n.attributes)).created="manually",a.cid=FusionPageBuilderViewManager.generateCid(),a.parent=o.cid,a.from="fusion_builder_container",FusionPageBuilderApp.collection.add(a)):e(this).hasClass("fusion_builder_row_inner")&&(s=e(this).data("cid"),void 0!==(r=FusionPageBuilderViewManager.getView(s))&&r.cloneNestedRow("",o.cid))})})}),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned_section,FusionPageBuilderEvents.trigger("fusion-element-cloned")},removeContainer:function(e){var i;e&&e.preventDefault(),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){"fusion_builder_row"===e.model.get("type")&&e.removeRow()}),1<FusionPageBuilderViewManager.countElementsByType("fusion_builder_container")||(FusionPageBuilderApp.blankPage=!0),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),!0!==FusionPageBuilderApp.blankPage?e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted_section,FusionPageBuilderEvents.trigger("fusion-element-removed")):FusionPageBuilderApp.clearBuilderLayout(!0)},toggleContainer:function(i){var t=e(i.currentTarget);i&&i.preventDefault(),this.$el.toggleClass("fusion-builder-section-folded"),t.find("span").toggleClass("dashicons-arrow-up").toggleClass("dashicons-arrow-down"),this.$el.hasClass("fusion-builder-section-folded")?this.model.attributes.params.admin_toggled="yes":this.model.attributes.params.admin_toggled="no",FusionPageBuilderEvents.trigger("fusion-element-edited")},renameContainer:function(e){var i,t;if(13==(e.keyCode||e.which))return e.preventDefault(),this.$el.find(".fusion-builder-section-name").blur(),!1;i=this.model,t=this.$el.find(".fusion-builder-section-name"),clearTimeout(this.typingTimer),this.typingTimer=setTimeout(function(){i.attributes.params.admin_label=t.val().replace(/[[\]]+/g,""),FusionPageBuilderEvents.trigger("fusion-element-edited")},this.doneTypingInterval)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.BlankPageView=window.wp.Backbone.View.extend({className:"fusion_builder_blank_page",template:FusionPageBuilder.template(e("#fusion-builder-blank-page-template").html()),events:{"click .fusion-builder-new-section-add":"addContainer","click .fusion-builder-video-button":"openVideoModal"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el.find("#video-dialog").dialog({dialogClass:"fusion-builder-dialog",autoOpen:!1,modal:!0,height:420,width:590}),this},openVideoModal:function(e){e.preventDefault(),jQuery("#video-dialog").dialog("open"),jQuery("#video-dialog iframe")[0].contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*")},addContainer:function(e){var i,t,n,o;e&&(e.preventDefault(),FusionPageBuilderApp.newContainerAdded=!0),FusionPageBuilderApp.activeModal="container",i=FusionPageBuilderViewManager.generateCid(),t=fusionAllElements.fusion_builder_container.params,n={},_.each(t,function(e){o=_.isObject(e.value)?e.default:e.value,n[e.param_name]=o,"dimension"===e.type&&_.isObject(e.value)&&_.each(e.value,function(e,i){n[i]=e})}),this.collection.add([{type:"fusion_builder_container",added:"manually",element_type:"fusion_builder_container",cid:i,params:n,view:this,created:"auto"}]),this.remove()},removeBlankPageHelper:function(e){e&&e.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove()}}),jQuery("body").on("click",".ui-dialog-titlebar-close",function(){var e=jQuery(this).closest(".ui-dialog");e.find("#video-dialog").length&&(e.find("#video-dialog iframe")[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),e.hide())})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.RowView=window.wp.Backbone.View.extend({className:"fusion_builder_row",template:FusionPageBuilder.template(e("#fusion-builder-row-template").html()),events:{"click .fusion-builder-insert-column":"displayColumnsOptions"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.sortableColumns(),"manually"!==this.model.get("created")&&this.$el.find(".fusion-builder-insert-column").trigger("click"),this},sortableColumns:function(){var i=this;i.$el.find(".fusion-builder-row-container").sortable({helper:"clone",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-column, .fusion-builder-resize-column, .column-sizes, .fusion-builder-save-column-dialog, .fusion-builder-save-inner-row-dialog-button, .fusion-builder-remove-inner-row, .fusion_builder_row_inner .fusion-builder-row-content",items:".fusion-builder-column-outer",connectWith:".fusion-builder-row-container",tolerance:"pointer",update:function(t,n){var o=n.item.data("cid"),a=i.collection.find(function(e){return e.get("cid")===o});a.get("parent")===i.model.attributes.cid&&e(n.item).closest(t.target).length||a.set("parent",i.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved_column,FusionPageBuilderEvents.trigger("fusion-element-sorted")}}).disableSelection()},displayColumnsOptions:function(i){var t;i&&i.preventDefault(),FusionPageBuilderApp.parentRowId=this.model.get("cid"),t=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"column_library"},view:this}),e("body").append(t.render().el)},removeRow:function(e){var i;e&&e.preventDefault(),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){e.removeColumn()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.InnerRowView=window.wp.Backbone.View.extend({className:"fusion_builder_row_inner fusion_builder_column_element",template:FusionPageBuilder.template(e("#fusion-builder-row-inner-template").html()),events:{"click .fusion-builder-remove-inner-row":"removeRow","click .fusion-builder-save-inner-row-dialog-button":"saveElementDialog","click .fusion-builder-clone-inner-row":"cloneNestedRow","click .fusion-builder-inner-row-overlay":"showInnerRowDialog","click .fusion-builder-inner-row-close":"hideInnerRowDialog","click .fusion-builder-inner-row-close-icon":"hideInnerRowDialog","click .fusion-builder-modal-save":"saveInnerRowSettings","click .fusion-builder-insert-inner-column":"displayInnerColumn"},initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.listenTo(FusionPageBuilderEvents,"fusion-close-inner-modal",this.hideInnerRowDialog)},showInnerRowDialog:function(i){var t=this.$el;i&&i.preventDefault(),FusionPageBuilderApp.allContent=fusionBuilderGetContent("content",!0),FusionPageBuilderApp.pauseBuilder=!0,t.find(".fusion-builder-row-content").show(),e("body").addClass("fusion_builder_inner_row_no_scroll").append('<div class="fusion_builder_modal_inner_row_overlay"></div>')},hideInnerRowDialog:function(i){var t=this.$el,n="";i&&i.preventDefault(),FusionPageBuilderApp.pauseBuilder&&(FusionPageBuilderApp.pauseBuilder=!1,FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(FusionPageBuilderApp.allContent)),t.find(".fusion-builder-row-content").hide(),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),this.$el.find(".fusion-builder-column-inner").each(function(){void 0!==jQuery(this)[0].dataset?n+=jQuery(this)[0].dataset.columnSize.replace("_","/")+" + ":n+=jQuery(this).data("column-size").replace("_","/")+" + "}),this.$el.find("> p").html(n.slice(0,n.length-3))},saveInnerRowSettings:function(i){var t,n,o="";"object"==typeof i&&i.preventDefault(),FusionPageBuilderApp.pauseBuilder=!1,n=this.$el,(t=FusionPageBuilderElements.find(function(e){return e.get("cid")===n.data("cid")})).set({chnaged:{changed:!0}}),FusionPageBuilderEvents.trigger("fusion-element-edited"),this.$el.find(".fusion-builder-column-inner").each(function(){void 0!==jQuery(this)[0].dataset?o+=jQuery(this)[0].dataset.columnSize.replace("_","/")+" + ":o+=jQuery(this).data("column-size").replace("_","/")+" + "}),this.$el.find("> p").html(o.slice(0,o.length-3)),this.$el.find(".fusion-builder-row-content").hide(),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),t.set({chnaged:{}}),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.edited_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-edited")},displayInnerColumn:function(i){var t;i&&i.preventDefault(),FusionPageBuilderApp.parentRowId=this.model.get("cid"),t=new FusionPageBuilder.NestedColumnLibraryView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"nested_column_library"},view:this}),e(this.$el).find(".fusion-builder-row-content").append(t.render().el)},render:function(){var e=this.$el,i="";return this.$el.html(this.template(this.model.toJSON())),this.sortableColumns(),setTimeout(function(){e.find(".fusion-builder-column-inner").each(function(){var e=String(jQuery(this).data("column-size"));i+=e.includes("_")?e.replace("_","/"):e,i+=" + "}),e.find("> h4").after("<p>"+i.slice(0,i.length-3)+"</p>")},100),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-element",this.model.attributes.params.fusion_global,this.model.get("cid")),this},cloneNestedRow:function(i,t){var n;i&&i.preventDefault(),(n=e.extend(!0,{},this.model.attributes)).created="manually",n.cid=FusionPageBuilderViewManager.generateCid(),i&&(n.appendAfter=this.$el),t&&(n.parent=t),FusionPageBuilderApp.collection.add(n),this.$el.find(".fusion-builder-column-inner").each(function(){var i=e(this),t=i.data("cid"),o=FusionPageBuilderElements.findWhere({cid:t}),a=e.extend(!0,{},o.attributes);a.created="manually",a.cid=FusionPageBuilderViewManager.generateCid(),a.parent=n.cid,FusionPageBuilderApp.collection.add(a),i.find(".fusion_module_block").each(function(){var i=e(this),t=void 0===i.data("cid")?i.find(".fusion-builder-data-cid").data("cid"):i.data("cid"),n=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),o=e.extend(!0,{},n.attributes);o.created="manually",o.cid=FusionPageBuilderViewManager.generateCid(),o.parent=a.cid,o.from="fusion_builder_row_inner",FusionPageBuilderApp.collection.add(o)})}),t||(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.cloned_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned")),n.parent&&setTimeout(FusionPageBuilderApp.checkGlobalParents,500,n.parent)},saveElementDialog:function(i){i&&i.preventDefault(),FusionPageBuilderApp.showLibrary(),e("#fusion-builder-layouts-elements-trigger").click(),e("#fusion-builder-layouts-elements .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_element+"</a></div></div>")},saveElement:function(i){var t=this.getInnerRowContent(),n=e("#fusion_builder_main_container"),o=e("#fusion-builder-save-element-input").val(),a=e("#fusion_save_global").is(":checked"),s=e("#fusion-builder-layouts-elements .fusion-page-layouts"),r=e("#fusion-builder-layouts-elements .fusion-page-layouts .fusion-empty-library-message"),u=this.model,l=!1,d=null,c={};i&&i.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<n.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(d=this.model.attributes.params.fusion_global,delete(c=this.model.get("params")).fusion_global,this.model.set("params",c),t=this.getInnerRowContent(),c.fusion_global=d,this.model.set("params",c)),e.each(jQuery("ul.fusion-page-layouts.fusion-layout-elements li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(e=e.replace(/\u2013|\u2014/g,"-"),o.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),l=!0,!1}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==l&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==o?e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_name:o,fusion_save_global:a,fusion_layout_content:t,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"elements",fusion_layout_element_type:"nested"},complete:function(i){FusionPageBuilderApp.layoutIsSaving=!1,s.prepend(i.responseText),e(".fusion-save-element-fields").remove(),r.hide(),a&&(u.attributes.params={fusion_global:e(i.responseText).attr("data-layout_id")},e('div.fusion_builder_column_element[data-cid="'+u.get("cid")+'"]').addClass("fusion-global-element"),e('div.fusion_builder_column_element[data-cid="'+u.get("cid")+'"]').attr("fusion-global-layout",e(i.responseText).attr("data-layout_id")),e('div.fusion_builder_column_element[data-cid="'+u.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+u.get("cid")+'"><span>'+fusionBuilderText.global_column+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,u.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getInnerRowContent:function(){var i="",t=this.$el,n=t.data("cid");FusionPageBuilderElements.findWhere({cid:n});return i+="[fusion_builder_row_inner]",t.find(".fusion-builder-column-inner").each(function(){var t=e(this),n=t.data("cid"),o=FusionPageBuilderViewManager.getView(n);i+=o.getColumnContent(t)}),i+="[/fusion_builder_row_inner]"},sortableColumns:function(){var i=this;i.$el.find(".fusion-builder-row-container-inner").sortable({items:".fusion-builder-column-inner",helper:"clone",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-column, .fusion-builder-resize-column, .column-sizes, .fusion-builder-save-column-dialog",tolerance:"pointer",update:function(t,n){var o=n.item.data("cid"),a=i.collection.find(function(e){return e.get("cid")===o});a.get("parent")===i.model.attributes.cid&&e(n.item).closest(t.target).length||a.set("parent",i.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved_nested_column,FusionPageBuilderEvents.trigger("fusion-element-sorted")}}).disableSelection()},removeRow:function(e,i){var t,n;e&&e.preventDefault(),n=this.model.get("parent"),t=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(t,function(e){e.removeColumn()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,n)}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.NestedColumnLibraryView=FusionPageBuilder.BaseLibraryView.extend({className:"fusion-builder-modal-settings-container",template:FusionPageBuilder.template(e("#fusion-builder-nested-column-library-template").html()),events:{"click .fusion-builder-all-modules .fusion-builder-element":"addModule","click .fusion_builder_custom_elements_load":"addCustomModule","click .fusion-builder-column-layouts li":"addNestedColumns","click .fusion-builder-modal-close":"closeModal"},render:function(){return this.$el.html(this.template(FusionPageBuilderViewManager.toJSON())),this.$el.addClass("fusion-add-to-nested"),this},addNestedColumns:function(i){var t,n,o,a,s,r,u;i&&i.preventDefault(),FusionPageBuilderViewManager.generateCid(),u=this.$el.parents(".fusion-builder-row-content").find(".fusion-builder-row-container-inner"),t=this,n=(e(i.target).is("li")?e(i.target):e(i.target).closest("li")).data("layout").split(","),_.size(n),o=this.options.view,a=fusionAllElements.fusion_builder_column_inner.params,s={},_.each(a,function(e){r=_.isObject(e.value)?e.default:e.value,s[e.param_name]=r}),_.each(n,function(e,i){var n={type:"fusion_builder_column_inner",element_type:"fusion_builder_column_inner",cid:FusionPageBuilderViewManager.generateCid(),parent:FusionPageBuilderApp.parentRowId,layout:e,view:o,params:s,appendAfter:u};t.collection.add([n])}),this.remove(),FusionPageBuilderEvents.trigger("fusion-columns-added"),i&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_nested_columns,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},closeModal:function(e){e.preventDefault(),this.remove()}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.BaseColumnView=window.wp.Backbone.View.extend({initialize:function(){this.$el.attr("data-cid",this.model.get("cid")),this.$el.attr("data-column-size",this.model.get("layout")),this.isNested="fusion_builder_column"!==this.model.get("type"),this.parentContainer=FusionPageBuilderApp.getParentContainer(this.model.get("parent")),this.model.attributes.params.type=this.model.get("layout"),this.listenTo(this.model,"change:params",this.onParamsChange)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.sortableElements(),this.updateContainerSizeAndLabel(this.model.get("layout")),this.updateFlexOptions(),this.isNested||void 0!==this.model.attributes.params.fusion_global&&FusionPageBuilderApp.addClassToElement(this.$el,"fusion-global-column",this.model.attributes.params.fusion_global,this.model.get("cid")),this},updateFlexOptions:function(){var e=this.model.get("params");void 0!==e.align_self&&""!==e.align_self&&this.$el.css({"align-self":e.align_self})},updateContainerSizeAndLabel:function(e){var i="";e.includes("_")?(i=e.replace("_","/"),this.$el.addClass("fusion-builder-column-"+e),this.$el.find(".column-size-"+e).addClass("active-size")):"auto"===e?(i="auto",this.$el.css({width:"97%"})):(i=(100*this.validateColumnSize(e)).toFixed(2),this.$el.css({width:i-3+"%"}),i+="%"),this.$el.find(this.isNested?".fusion-builder-resize-inner-column":".fusion-builder-resize-column").text(i)},sortableElements:function(){var i=this,t={items:this.isNested?".fusion_module_block":".fusion_module_block:not(.fusion_builder_row_inner .fusion_module_block), .fusion_builder_row_inner",connectWith:this.isNested?".fusion-builder-column-inner":".fusion-builder-column-outer",cancel:".fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-add-element, .fusion-builder-insert-column, .fusion-builder-save-module-dialog",tolerance:"pointer",update:function(t,n){var o=e(n.item),a=n.item.data("cid"),s=i.collection.find(function(e){return e.get("cid")===a});e(n.item).closest(t.target).length&&1===e(t.target).find(".fusion_module_block, .fusion_builder_row_inner").length&&o.insertBefore(e(t.target).find("> .fusion-builder-add-element")),s.get("parent")===i.model.attributes.cid&&e(n.item).closest(t.target).length||s.set("parent",i.model.attributes.cid),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.moved+" "+fusionAllElements[s.get("element_type")].name+" "+fusionBuilderText.element,FusionPageBuilderEvents.trigger("fusion-element-sorted")}};this.isNested||(t.cancel+=" .fusion-builder-remove-inner-row, .fusion-builder-save-inner-row-dialog-button, .fusion-builder-remove-inner-row, .fusion_builder_row_inner .fusion-builder-row-content",t.over=function(i){1===e(i.target).find(".fusion_module_block, .fusion_builder_row_inner").length&&e(i.target).find(".ui-sortable-placeholder").insertBefore(e(i.target).find(".fusion-builder-add-element"))}),this.$el.sortable(t)},saveColumnDialog:function(i){i&&i.preventDefault(),FusionPageBuilderApp.showLibrary(),e("#fusion-builder-layouts-columns-trigger").click(),e("#fusion-builder-layouts-columns .fusion-builder-layouts-header-element-fields").append('<div class="fusion-save-element-fields"><input type="text" value="" id="fusion-builder-save-element-input" class="fusion-builder-save-element-input" placeholder="'+fusionBuilderText.enter_name+'" /><div class="save-as-global"><label><input type="checkbox" id="fusion_save_global" name="fusion_save_global">'+fusionBuilderText.save_global+'</label><a href="#" class="fusion-builder-save-column fusion-builder-element-button-save" data-element-cid="'+this.model.get("cid")+'">'+fusionBuilderText.save_column+"</a></div></div>")},saveElement:function(i){var t=this.$el,n=this.getColumnContent(t),o=e("#fusion_builder_main_container"),a=e("#fusion-builder-save-element-input").val(),s=e("#fusion_save_global").is(":checked"),r=e("#fusion-builder-layouts-columns .fusion-page-layouts"),u=e("#fusion-builder-layouts-columns .fusion-page-layouts .fusion-empty-library-message"),l=this.model,d=!1,c=null,f={};i&&i.preventDefault(),void 0!==this.model.attributes.params&&void 0!==this.model.attributes.params.fusion_global&&0<o.find('[fusion-global-layout="'+this.model.attributes.params.fusion_global+'"]').length&&(c=this.model.attributes.params.fusion_global,delete(f=this.model.get("params")).fusion_global,this.model.set("params",f),n=this.getColumnContent(t),f.fusion_global=c,this.model.set("params",f)),e.each(jQuery("ul.fusion-page-layouts.fusion-layout-columns li"),function(){var e=jQuery(this).find("h4.fusion-page-layout-title").html().split("<div ")[0];if(e=e.replace(/\u2013|\u2014/g,"-"),a.toLowerCase().trim()===e.toLowerCase().trim())return alert(fusionBuilderText.duplicate_element_name_error),d=!0,!1}),!0!==FusionPageBuilderApp.layoutIsSaving&&!0!==d&&(FusionPageBuilderApp.layoutIsSaving=!0,""!==a?e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_name:a,fusion_save_global:s,fusion_layout_content:n,fusion_layout_post_type:"fusion_element",fusion_layout_new_cat:"columns"},complete:function(i){FusionPageBuilderApp.layoutIsSaving=!1,r.prepend(i.responseText),e(".fusion-save-element-fields").remove(),u.hide(),s&&(l.attributes.params.fusion_global=e(i.responseText).attr("data-layout_id"),e('div[data-cid="'+l.get("cid")+'"]').addClass("fusion-global-column"),e('div[data-cid="'+l.get("cid")+'"]').attr("fusion-global-layout",e(i.responseText).attr("data-layout_id")),e('div[data-cid="'+l.get("cid")+'"]').append('<div class="fusion-builder-global-tooltip" data-cid="'+l.get("cid")+'"><span>'+fusionBuilderText.global_column+"</span></div>"),FusionPageBuilderEvents.trigger("fusion-element-added"),FusionPageBuilderApp.saveGlobal=!0,setTimeout(FusionPageBuilderApp.checkGlobalParents,500,l.get("parent")))}}):(FusionPageBuilderApp.layoutIsSaving=!1,alert(fusionBuilderText.please_enter_element_name)))},getColumnContent:function(i){var t,n="",o=i.data("cid"),a=FusionPageBuilderElements.findWhere({cid:o}),s=a.get("type"),r=s.includes("inner")?".fusion_module_block":".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)",u={};return _.each(a.get("params"),function(e,i){u[i]="undefined"===e||void 0===e?"":e,"padding"===i&&""===u[i]&&(u.padding_top="",u.padding_right="",u.padding_bottom="",u.padding_left="",delete u[i]),"dimension_margin"===i&&""===u[i]&&(u.margin_top="",u.margin_bottom="",delete u[i])}),t={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(t,function(e,i){void 0===u[i]&&(u[i]=e)}),FusionPageBuilderApp.beforeGenerateShortcode(o),n+="["+s+' type="'+a.get("layout")+'"',delete u.type,_.each(u,function(e,i){("on"===fusionBuilderConfig.removeEmptyAttributes&&""!==e||"off"===fusionBuilderConfig.removeEmptyAttributes)&&(n+=" "+i+'="'+e+'"')}),n+="]",i.find(r).each(function(){var i,t,o;e(this).hasClass("fusion_module_block")?n+=FusionPageBuilderApp.generateElementShortcode(e(this),!1):(t=(i=e(this)).data("cid"),void 0!==(o=FusionPageBuilderElements.findWhere({cid:t})).attributes.params&&void 0!==o.attributes.params.fusion_global?n+='[fusion_builder_row_inner fusion_global="'+o.attributes.params.fusion_global+'"]':n+="[fusion_builder_row_inner]",i.find(".fusion-builder-column-inner").each(function(){var i,t=e(this),o=t.data("cid"),a=FusionPageBuilderElements.findWhere({cid:o}),s={};FusionPageBuilderApp.beforeGenerateShortcode(o),_.each(a.get("params"),function(e,i){s[i]="undefined"===e||void 0===e?"":e}),i={min_height:"",last:"no",hover_type:"none",link:"",border_position:"all"},_.each(i,function(e,i){void 0===s[i]&&(s[i]=e)}),n+='[fusion_builder_column_inner type="'+a.get("layout")+'"',delete s.type,_.each(s,function(e,i){("on"===fusionBuilderConfig.removeEmptyAttributes&&""!==e||"off"===fusionBuilderConfig.removeEmptyAttributes)&&(n+=" "+i+'="'+e+'"')}),n+="]",t.find(".fusion_module_block").each(function(){n+=FusionPageBuilderApp.generateElementShortcode(e(this),!1)}),n+="[/fusion_builder_column_inner]"}),n+="[/fusion_builder_row_inner]")}),n+="[/"+s+"]"},showSettings:function(i){var t,n={model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_settings"}};i&&i.preventDefault(),t=new FusionPageBuilder.ModalView(n),e("body").append(t.render().el)},removeColumn:function(e){var i,t;e&&e.preventDefault(),t=this.model.get("parent"),i=FusionPageBuilderViewManager.getChildViews(this.model.get("cid")),_.each(i,function(e){"fusion_builder_row"===e.model.get("type")||"fusion_builder_row_inner"===e.model.get("type")?e.removeRow():e.removeElement()}),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.deleted+" "+fusionBuilderText.column,FusionPageBuilderEvents.trigger("fusion-element-removed")),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,t)},addModule:function(i){var t,n;i&&(i.preventDefault(),i.stopPropagation()),FusionPageBuilderApp.removeContextMenu(),FusionPageBuilderApp.innerColumn=this.isNested?"true":"false",FusionPageBuilderApp.parentColumnId=this.model.get("cid"),((n=e(i.target)).is("span")?n.parent(".fusion-builder-add-element"):n).parent().is(i.delegateTarget)&&(t=new FusionPageBuilder.ModalView({model:this.model,collection:this.collection,attributes:{"data-modal_view":"element_library"},view:this}),e("body").append(t.render().el))},cloneColumn:function(i){var t,n,o=e.extend(!0,{},this.model.attributes);i&&i.preventDefault(),o.created="manually",o.cid=FusionPageBuilderViewManager.generateCid(),o.targetElement=this.$el,o.cloned=!0,FusionPageBuilderApp.collection.add(o),t=this.$el,n=this.isNested?".fusion_builder_column_element":".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)",t.find(n).each(function(){var i,t,n,a,s,r,u;e(this).hasClass("fusion_module_block")?(i=e(this),t=void 0===i.data("cid")?i.find(".fusion-builder-data-cid").data("cid"):i.data("cid"),n=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),(a=e.extend(!0,{},n.attributes)).created="manually",a.cid=FusionPageBuilderViewManager.generateCid(),a.parent=o.cid,a.from="fusion_builder_column",FusionPageBuilderApp.collection.add(a)):e(this).hasClass("fusion_builder_row_inner")&&(r=void 0===(s=e(this)).data("cid")?s.find(".fusion-builder-data-cid").data("cid"):s.data("cid"),void 0!==(u=FusionPageBuilderViewManager.getView(r))&&u.cloneNestedRow("",o.cid))}),i&&(fusionHistoryManager.turnOnTracking(),this.isNested?window.fusionHistoryState=fusionBuilderText.cloned_nested_columns:window.fusionHistoryState=fusionBuilderText.cloned+" "+fusionBuilderText.column,FusionPageBuilderEvents.trigger("fusion-element-cloned"))},columnSizeDialog:function(e){var i=this.$el.position().left,t=this.$el.parents(".fusion-builder-row-container-inner").width();e&&e.preventDefault(),this.isNested&&t-i<240&&this.$el.find(".column-sizes").css({left:"auto",right:"0"}),this.$el.find(".column-sizes").toggle()},onParamsChange:function(e,i){this.columnSize()},columnSize:function(i){var t,n=this.model.get("layout");i?(t=e(i.currentTarget).attr("data-column-size"),i.preventDefault()):t=this.model.attributes.params.type,void 0!==t&&(this.$el.removeClass("fusion-builder-column-"+n),this.$el.find(".column-sizes .column-size").removeClass("active-size"),this.$el.css({width:""}),this.model.set("layout",t),this.isNested&&this.$el.attr("data-column-size",t),this.model.attributes.params.type=t,this.updateContainerSizeAndLabel(t),this.$el.find(".column-sizes").hide(),i&&(fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.resized_column+" "+t,FusionPageBuilderEvents.trigger("fusion-element-edited")))},validateColumnSize:function(e){var i;return void 0===e&&(e="1_3"),-1!==e.indexOf("_")?(i=e.split("_"),parseFloat(i[0])/parseFloat(i[1])):1<parseFloat(e)?parseFloat(e)/100:e}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.NestedColumnView=FusionPageBuilder.BaseColumnView.extend({template:FusionPageBuilder.template(e("#fusion-builder-inner-column-template").html()),events:{"click .fusion-builder-add-element":"addModule","click .fusion-builder-settings-column":"showSettings","click .fusion-builder-resize-inner-column":"columnSizeDialog","click .column-size":"columnSize","click .fusion-builder-remove-inner-column":"removeColumn","click .fusion-builder-clone-inner-column":"cloneColumn"}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ColumnView=FusionPageBuilder.BaseColumnView.extend({template:FusionPageBuilder.template(e("#fusion-builder-column-template").html()),events:{"click .fusion-builder-add-element:not(.fusion-builder-column-inner .fusion-builder-add-element)":"addModule","click .fusion-builder-settings-column:not(.fusion-builder-column-inner .fusion-builder-settings-column)":"showSettings","click .fusion-builder-resize-column:not(.fusion-builder-column-inner .fusion-builder-resize-column)":"columnSizeDialog","click .column-size:not(.fusion-builder-column-inner .column-size)":"columnSize","click .fusion-builder-clone-column:not(.fusion-builder-column-inner .fusion-builder-clone-column)":"cloneColumn","click .fusion-builder-remove-column:not(.fusion-builder-column-inner .fusion-builder-remove-column)":"removeColumn","click .fusion-builder-save-column-dialog:not(.fusion-builder-column-inner .fusion-builder-save-column-dialog)":"saveColumnDialog"}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ModalView=window.wp.Backbone.View.extend({className:"fusion-builder-modal-settings-container",template:FusionPageBuilder.template(e("#fusion-builder-modal-template").html()),events:{"click .fusion-builder-modal-save":"saveSettings","click .fusion-builder-modal-close":"closeModal"},initialize:function(e){this.listenTo(FusionPageBuilderEvents,"fusion-columns-added",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-remove-modal-view",this.removeView),this.listenTo(FusionPageBuilderEvents,"fusion-close-modal",this.closeModal),this.options=e,this.elementType=""},initDynamicParams:function(){var e=void 0!==this.model&&"object"==typeof this.model.get("params")?this.model.get("params"):{},i=e.dynamic_params;if(this.dynamicParams=new FusionPageBuilder.DynamicParams({elementView:this}),"string"==typeof e.dynamic_params&&""!==e.dynamic_params)try{FusionPageBuilderApp.base64Encode(FusionPageBuilderApp.base64Decode(i))===i&&(i=FusionPageBuilderApp.base64Decode(i),i=_.unescape(i),i=JSON.parse(i)),this.dynamicParams.setData(i)}catch(e){}},render:function(){var i,t,n,o={model:this.model,collection:this.collection,view:this.options.view};return this.initDynamicParams(),o.dynamicParams=this.dynamicParams,void 0===this.model||void 0===this.model.get("view")||"row_inner"!==this.model.get("element_type")&&"fusion_builder_row"!==this.model.get("element_type")||this.model.get("parent")===this.model.get("view").$el.data("cid")||this.model.set("view",FusionPageBuilderViewManager.getView(this.model.get("parent")),{silent:!0}),void 0!==this.model?this.$el.html(this.template(this.model.toJSON())):this.$el.html(this.template()),n=this.$el.find(".fusion-builder-modal-container"),"column_library"===this.attributes["data-modal_view"]?i=new FusionPageBuilder.ColumnLibraryView(o):"element_library"===this.attributes["data-modal_view"]?(o.attributes={"data-parent_cid":this.model.get("cid")},i=new FusionPageBuilder.ElementLibraryView(o)):"all_elements_generator"===this.attributes["data-modal_view"]?(o.attributes={},i=new FusionPageBuilder.GeneratorElementsView(o)):"multi_element_child_settings"===this.attributes["data-modal_view"]?(o.attributes={},i=new FusionPageBuilder.MultiElementSettingsView(o)):"element_settings"===this.attributes["data-modal_view"]&&(o.attributes={"data-element_type":this.model.get("element_type")},void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")&&(this.elementType="multi"),o.view=this,i=void 0!==(t=fusionAllElements[this.model.get("element_type")].custom_settings_view_name)&&""!==t?new FusionPageBuilder[t](o):new FusionPageBuilder.ElementSettingsView(o)),this.settingsView=i,n.append(i.render().el),1>e(".fusion_builder_modal_overlay").length&&1>e(".fusion_builder_modal_inner_row_overlay").length&&e("body").addClass("fusion_builder_no_scroll").append('<div class="fusion_builder_modal_overlay"></div>'),"column_library"!==this.attributes["data-modal_view"]&&"element_library"!==this.attributes["data-modal_view"]&&"all_elements_generator"!==this.attributes["data-modal_view"]||this.elementSearchFilter(),"multi"===this.elementType&&this.$el.addClass("fusion_builder_modal_multi_element_settings_container"),this},closeModal:function(i){var t,n,o,a,s,r,u,l;i&&i.preventDefault(),FusionPageBuilderApp.activeModal="",this.$el.find(".awb-color-picker").each(function(){e(this).awbColorPicker("close")}),FusionPageBuilderApp.codeEditor&&FusionPageBuilderApp.codeEditor.toTextArea(),!0===FusionPageBuilderApp.newContainerAdded&&(FusionPageBuilderApp.newContainerAdded=!1),this.$el.find(".tinymce").each(function(){u=e(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(u)}),void 0!==this.model&&!0!==FusionPageBuilderApp.MultiElementChildSettings&&"undefined"!==this.model.get("added")&&"manually"===this.model.get("added")?fusionHistoryManager.turnOnTracking():FusionPageBuilderApp.MultiElementChildSettings=!1,!0===FusionPageBuilderApp.shortcodeGenerator?void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")?(FusionPageBuilderApp.shortcodeGeneratorMultiElement="",FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",FusionPageBuilderApp.shortcodeGenerator="",l=this.$el.find(".fusion-builder-option-advanced-module-settings").data("cid"),FusionPageBuilderViewManager.getView(l).removeView(),l=""):void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_child"===this.model.get("multi")?FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="":(FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID=""):"undefined"!==this.model.get("added")&&"manually"===this.model.get("added")&&("fusion_builder_row"===this.model.get("element_type")?(t=this.model.get("parent"),void 0!==(n=FusionPageBuilderViewManager.getView(t))&&n.removeContainer()):(a=fusionAllElements[this.model.get("element_type")].params,o={},_.each(a,function(e){s=_.isObject(e.value)?e.default:e.value,o[e.param_name]=s}),r={params:o},this.model.set(r),i&&FusionPageBuilderEvents.trigger("fusion-element-added")),"element"===this.model.get("type")&&this.deleteModel(),void 0!==this.model&&void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")&&FusionPageBuilderEvents.trigger("fusion-multi-remove-sortables-view")),this.removeOverlay(),FusionPageBuilderEvents.trigger("fusion-settings-modal-cancel"),this.remove()},removeView:function(){this.removeOverlay(),void 0!==this.model&&"fusion_builder_row"!==this.model.get("type")&&"fusion_builder_column"!==this.model.get("type")&&"fusion_builder_row_inner"!==this.model.get("type")&&"fusion_builder_column_inner"!==this.model.get("type")||this.remove()},saveSettings:function(i){var t,n,o,a,s,r,u=this;i&&i.preventDefault(),this.$el.find(".awb-color-picker").each(function(){e(this).awbColorPicker("close")}),FusionPageBuilderApp.codeEditor&&FusionPageBuilderApp.codeEditor.toTextArea(),!0!==FusionPageBuilderApp.MultiElementChildSettings?fusionHistoryManager.turnOnTracking():FusionPageBuilderApp.MultiElementChildSettings=!1,t={params:{}},"fusion_builder_container"===this.model.get("element_type")&&void 0!==this.model.attributes.params.admin_label&&(t.params.admin_label=this.model.attributes.params.admin_label),void 0!==this.model.attributes.params.fusion_global&&(t.params.fusion_global=this.model.attributes.params.fusion_global),this.$el.find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var i,n,o=e(this);void 0!==(n=u.getSettingName(o,!1))&&(i=u.getSettingValue(o,!1),t.params[n]=i)}),(r=this.getDynamicValues())?(t.params.dynamic_params=r.string,t.dynamic_params=r.object):(delete t.params.dynamic_params,t.dynamic_params={}),void 0!==fusionAllElements[this.model.get("element_type")].escape_html&&!0===fusionAllElements[this.model.get("element_type")].escape_html&&(t.params.element_content=_.escape(t.params.element_content)),void 0!==fusionAllElements[this.model.get("element_type")].on_save&&(a=fusionAllElements[this.model.get("element_type")].on_save,"function"==typeof FusionPageBuilderApp[a]&&(t=FusionPageBuilderApp[a](t,this))),!0===FusionPageBuilderApp.shortcodeGenerator?"multi_element_parent"===this.model.get("multi")?(this.model.set(t,{silent:!0}),n=FusionPageBuilderApp.generateElementShortcode(this.model,!1,!0),fusionBuilderInsertIntoEditor(n),FusionPageBuilderApp.shortcodeGeneratorMultiElement="",FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",FusionPageBuilderApp.shortcodeGenerator="",void 0!==(s=this.$el.find(".fusion-builder-option-advanced-module-settings").data("cid"))&&FusionPageBuilderViewManager.getView(s).removeView(),s="","",this.remove(),this.removeOverlay()):"multi_element_child"===this.model.get("multi")?(this.model.set(t),FusionPageBuilderEvents.trigger("fusion-multi-element-edited"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),FusionPageBuilderApp.shortcodeGeneratorMultiElementChild="",this.remove()):("fusion_builder_column"===this.model.get("element_type")&&(t.params.type=this.model.get("layout")),"fusion_builder_container"===this.model.get("element_type")&&(t.params.element_content="[fusion_builder_row][/fusion_builder_row]"),this.model.set(t,{silent:!0}),n=FusionPageBuilderApp.generateElementShortcode(this.model,!1,!0),fusionBuilderInsertIntoEditor(n,FusionPageBuilderApp.shortcodeGeneratorEditorID),"video"!==FusionPageBuilderApp.shortcodeGeneratorEditorID&&(FusionPageBuilderApp.shortcodeGenerator="",FusionPageBuilderApp.shortcodeGeneratorEditorID=""),this.remove(),!1!==FusionPageBuilderApp.builderActive&&!0!==FusionPageBuilderApp.fromExcerpt||(this.removeOverlay(),FusionPageBuilderApp.fromExcerpt=!1)):("multi_element_child"===this.model.get("multi")?(this.model.set(t,{silent:!0}),FusionPageBuilderEvents.trigger("fusion-multi-element-edited"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),this.remove()):"multi_element_parent"===this.model.get("multi")?(void 0===this.model.get("added")&&(window.fusionHistoryState=fusionBuilderText.edited+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.model.unset("added"),this.model.set(t),this.$el.find(".tinymce").each(function(){o=e(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(o)}),FusionPageBuilderEvents.trigger("fusion-multi-remove-sortables-view"),this.remove(),FusionPageBuilderEvents.trigger("fusion-modal-view-removed"),this.generatePreview(),this.removeOverlay()):(void 0===this.model.get("added")&&(window.fusionHistoryState=fusionBuilderText.edited+" "+fusionAllElements[this.model.get("element_type")].name+" "+fusionBuilderText.element),this.model.unset("added"),this.model.set(t),this.$el.find(".tinymce").each(function(){o=e(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(o)}),this.remove(),FusionPageBuilderEvents.trigger("fusion-modal-view-removed"),!0===FusionPageBuilderApp.builderActive&&this.generatePreview(),this.removeOverlay()),i&&FusionPageBuilderEvents.trigger("fusion-element-added")),FusionPageBuilderApp.manuallyAdded&&(FusionPageBuilderApp.shortcodeGenerator=FusionPageBuilderApp.manualGenerator,FusionPageBuilderApp.shortcodeGeneratorEditorID=FusionPageBuilderApp.manualEditor,FusionPageBuilderApp.manuallyAdded=!1),this.$el.find(".tinymce").each(function(){o=e(this).find("textarea.fusion-editor-field").attr("id"),FusionPageBuilderApp.fusionBuilderMCEremoveEditor(o)}),FusionPageBuilderApp.activeModal="",FusionPageBuilderEvents.trigger("fusion-settings-modal-save")},getSettingName:function(e,i){if(!e.parents(".repeater-fields, .dynamic-param-fields").length||i)return"string"==typeof e.attr("data-subset")?e.attr("name"):e.is("#generator_element_content")||e.is("#fusion_builder_content_main")||e.is("#element_content")||e.is("#generator_multi_child_content")?"element_content":e.attr("id")},getSettingValue:function(e,i){var t;if(!e.parents(".repeater-fields, .dynamic-param-fields").length||i)return e.is("#fusion_builder_content_main")?t=e.val():e.is(":checkbox")||(t=e.is("#generator_element_content")?fusionBuilderGetContent("generator_element_content"):e.is("#generator_multi_child_content")?fusionBuilderGetContent("generator_multi_child_content"):e.is("textarea#element_content")&&e.parents(".fusion-builder-option").hasClass("tinymce")?fusionBuilderGetContent("element_content"):e.val()),e.is("input")&&""!==t&&(e.hasClass("fusion-builder-upload-field")||e.is("#generator_element_content")||e.is("#generator_multi_child_content")||e.closest("ul").hasClass("dynamic-param-fields")||(t=_.escape(t))),(e.hasClass("fusion-builder-raw-textarea")||e.hasClass("fusion-builder-raw-text"))&&(t=FusionPageBuilderApp.base64Encode(t)),e.hasClass("fusion-builder-code-block")&&1===Number(FusionPageBuilderApp.disable_encoding)&&(t=FusionPageBuilderApp.base64Encode(t)),e.hasClass("fusion-repeater-value")&&(t=this.getRepeaterValues(e)),"infobox_content"===name&&(t=_.escape(t)),t},getRepeaterValues:function(e){var i,t=[],n=this;return e.parent().find(".repeater-row").each(function(){i={},jQuery(this).find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var e=jQuery(this),t=n.getSettingName(e,!0),o=n.getSettingValue(e,!0);i[t]=o}),t.push(i)}),t=JSON.stringify(t),t=FusionPageBuilderApp.base64Encode(t)},getDynamicValues:function(){var e=this,i=!1;return this.$el.find('[data-dynamic="true"]:not([data-parent-content="true"])').length&&(i={},this.$el.find('[data-dynamic="true"]:not([data-parent-content="true"])').each(function(){var t=jQuery(this).attr("data-option-id"),n=jQuery(this).find(".dynamic-wrapper").attr("data-id");i[t]={data:n},jQuery(this).find("input, select, textarea, #fusion_builder_content_main, #fusion_builder_content_main_child, #generator_element_content, #generator_multi_child_content, #element_content").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){var n=jQuery(this),o=e.getSettingName(n,!0),a=e.getSettingValue(n,!0);i[t][o]=a})})),!!i&&{string:FusionPageBuilderApp.base64Encode(JSON.stringify(i)),object:i}},removeOverlay:function(){e(".fusion_builder_modal_overlay").length&&2>e(".fusion-builder-modal-settings-container").length&&(e(".fusion_builder_modal_overlay").remove(),e("body").removeClass("fusion_builder_no_scroll"))},generatePreview:function(){var e,i,t,n,o,a=this.model.get("element_type");"fusion_builder_container"===a&&(n=this.model.get("params"),i=FusionPageBuilderViewManager.getView(this.model.get("cid")).$el,o=fusionBuilderText.empty_section,""!==n.background_image&&(o=fusionBuilderText.empty_section_with_bg),i.find(".fusion-builder-empty-section").html(o),FusionPageBuilderViewManager.getView(this.model.get("cid")).updateStatusIcons(),FusionPageBuilderViewManager.getView(this.model.get("cid")).updateFlexOptions()),"fusion_builder_column"===a&&FusionPageBuilderViewManager.getView(this.model.get("cid")).updateFlexOptions(),void 0!==fusionAllElements[a].preview&&(e={model:this.model,collection:FusionPageBuilderElements},i=FusionPageBuilderViewManager.getView(this.model.get("cid")).$el.find(".fusion-builder-module-preview"),t=new FusionPageBuilder.ElementPreviewView(e),i.html("").append(t.render().el))},deleteModel:function(){FusionPageBuilderViewManager.getView(this.model.get("cid")).$el.find(".fusion-builder-remove").click()},elementSearchFilter:function(){var i,t,n=this.$el;n.find(".fusion-elements-filter").on("change paste keyup",function(){e(this).val()?(t=e(this).val().toLowerCase(),n.find(".fusion-builder-all-modules li, .studio-imports li").each(function(){var n=jQuery(this).find(".fusion_module_label").length?jQuery(this).find(".fusion_module_label").text().trim().toLowerCase():"";"portfolio"===(i=(i=e(this).find(".fusion_module_title").text().trim().toLowerCase()).replace("this is a global column.",""))&&(i+=" recent works"),"fusion_imageframe"===n&&(i+=" "+fusionBuilderText.logo.trim().toLowerCase()),-1!==i.search(t)?e(this).show():e(this).hide()})):(n.find(".fusion-builder-all-modules li").show(),n.find(".studio-imports li").show())})}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.NextPage=window.wp.Backbone.View.extend({className:"fusion-builder-next-page",template:FusionPageBuilder.template(e("#fusion-builder-next-page-template").html()),events:{"click .fusion-builder-delete-next-page":"removeContainer"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},removeContainer:function(e){e&&e.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.checkoutForm=window.wp.Backbone.View.extend({className:"fusion-checkout-form",template:FusionPageBuilder.template(e("#fusion-checkout-form-template").html()),events:{"click .fusion-builder-delete-checkout-form":"removeContainer"},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},removeContainer:function(e){e&&e.preventDefault(),FusionPageBuilderViewManager.removeView(this.model.get("cid")),this.model.destroy(),this.remove(),e&&FusionPageBuilderEvents.trigger("fusion-element-removed")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.ContextMenuView=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(jQuery("#fusion-builder-context-menu").html()),className:"fusion-builder-context-menu",events:{'click [data-action="edit"]':"editTrigger",'click [data-action="save"]':"saveTrigger",'click [data-action="clone"]':"cloneTrigger",'click [data-action="remove"]':"removeTrigger",'click [data-action="copy"]':"copy",'click [data-action="paste-before"]':"pasteBefore",'click [data-action="paste-after"]':"pasteAfter",'click [data-action="paste-start"]':"pasteStart",'click [data-action="paste-end"]':"pasteEnd"},initialize:function(){this.copyData={data:{type:!1,content:!1}},this.getCopy()},render:function(){var e=jQuery("#fusion_builder_layout .inside").offset();return this.$el.html(this.template(jQuery.extend(!0,this.copyData,this.model.parent.attributes,{pageType:this.model.pageType}))),this.$el.css({top:this.model.event.pageY-e.top+"px",left:this.model.event.pageX-e.left+"px"}),this},editTrigger:function(e){"fusion_builder_row_inner"===this.model.parent.attributes.element_type?this.model.parentView.showInnerRowDialog(e):this.model.parentView.showSettings(e)},saveTrigger:function(e){"fusion_builder_column"===this.model.parent.attributes.element_type?this.model.parentView.saveColumnDialog(e):this.model.parentView.saveElementDialog(e)},cloneTrigger:function(e){switch(this.model.parent.attributes.element_type){case"fusion_builder_container":this.model.parentView.cloneContainer(e);break;case"fusion_builder_column_inner":case"fusion_builder_column":this.model.parentView.cloneColumn(e);break;case"fusion_builder_row_inner":this.model.parentView.cloneNestedRow(e);break;default:this.model.parentView.cloneElement(e)}},removeTrigger:function(e){switch(this.model.parent.attributes.element_type){case"fusion_builder_container":this.model.parentView.removeContainer(e);break;case"fusion_builder_column_inner":case"fusion_builder_column":this.model.parentView.removeColumn(e);break;case"fusion_builder_row_inner":this.model.parentView.removeRow(e);break;default:this.model.parentView.removeElement(e)}},copy:function(){var e,i,t=this.model.parent.attributes.element_type,n=jQuery("<textarea>");switch(this.model.parent.attributes.element_type){case"fusion_builder_container":e=this.model.parentView.getContainerContent();break;case"fusion_builder_column_inner":case"fusion_builder_column":e=this.model.parentView.getColumnContent(this.model.parentView.$el);break;case"fusion_builder_row_inner":e=this.model.parentView.getInnerRowContent();break;default:e=this.model.parentView.getElementContent()}jQuery("body").append(n),n.val(e).select(),document.execCommand("copy"),n.remove(),i={type:t,content:e},this.storeCopy(i)},storeCopy:function(e){"undefined"!=typeof Storage&&(localStorage.setItem("fusionCopyContent",e.content),localStorage.setItem("fusionCopyType",e.type),this.getCopy())},getCopy:function(){"undefined"!=typeof Storage&&localStorage.getItem("fusionCopyContent")&&(this.copyData.data.content=localStorage.getItem("fusionCopyContent"),this.copyData.data.type=localStorage.getItem("fusionCopyType"))},pasteAfter:function(){this.paste("after")},pasteBefore:function(){this.paste("before")},pasteStart:function(){this.paste("start")},pasteEnd:function(){this.paste("end")},paste:function(e){var i,t=this.copyData.data,n=t.type,o=t.content,a=!1,s="";"after"===e||"before"===e?(i=this.model.parent.attributes.parent,a=this.model.parentView.$el,"fusion_builder_container"===this.model.parent.attributes.type&&(i=this.model.parent.attributes.cid,FusionPageBuilderApp.targetContainerCID=this.model.parent.attributes.cid)):(i=this.model.parent.attributes.cid,a=!1,"fusion_builder_container"===this.model.parent.attributes.type&&(i=this.model.parentView.$el.find(".fusion-builder-row-content").first().data("cid"))),FusionPageBuilderApp.shortcodesToBuilder(o,i,a,e),-1===n.indexOf("fusion_builder_")&&(s=" "+fusionBuilderText.element),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.pasted+" "+fusionAllElements[n].name+s,FusionPageBuilderEvents.trigger("fusion-element-cloned")},removeMenu:function(e){e&&e.preventDefault(),FusionPageBuilderApp.contextMenuView=!1,this.remove()}})});FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ElementSettingsView=window.wp.Backbone.View.extend({className:"fusion_builder_module_settings",template:FusionPageBuilder.template(e("#fusion-builder-block-module-settings-template").html()),events:{"click #qt_element_content_fusion_shortcodes_text_mode":"activateSCgenerator","click .option-dynamic-content":"addDynamicContent"},activateSCgenerator:function(i){openShortcodeGenerator(e(i.target))},initialize:function(){var e,i,t;this.listenTo(FusionPageBuilderEvents,"fusion-modal-view-removed",this.removeElement),void 0!==fusionAllElements[this.model.get("element_type")].on_settings&&(e=fusionAllElements[this.model.get("element_type")].on_settings,"function"==typeof FusionPageBuilderApp[e]&&(i=this.model.get("params"),t=FusionPageBuilderApp[e](i,this),this.model.set("params",t))),this.listenTo(FusionPageBuilderEvents,"fusion-dynamic-data-removed",this.removeDynamicStatus),this.listenTo(FusionPageBuilderEvents,"fusion-dynamic-data-added",this.addDynamicStatus),this.dynamicSelection=!1,this.dynamicParams="object"==typeof this.options&&"object"==typeof this.options.dynamicParams&&this.options.dynamicParams,this.onInit()},onInit:function(){},addDynamicContent:function(e){var i,t=jQuery(e.target).closest(".fusion-builder-option"),n=t.attr("data-option-id"),o=!1;this.dynamicSelection&&(n===this.dynamicSelection.model.get("param")&&(o=!0),this.dynamicSelection.removeView()),o||(i={model:new FusionPageBuilder.Element({param:n,option:t,parent:this})},this.dynamicSelection=new FusionPageBuilder.DynamicSelection(i),t.find(".fusion-dynamic-selection").html(this.dynamicSelection.render().el))},removeDynamicStatus:function(e){this.$el.find('.fusion-builder-option[data-option-id="'+e+'"]').attr("data-dynamic",!1),this.$el.find("#"+e).trigger("change")},addDynamicStatus:function(e){this.$el.find('.fusion-builder-option[data-option-id="'+e+'"]').attr("data-dynamic",!0),this.$el.find("#"+e).trigger("change")},render:function(){var e,i=this.$el,t=this.model.attributes;return this.beforeRender(),"object"==typeof this.dynamicParams&&(this.dynamicParams.createBackup(),t.dynamic_params=this.dynamicParams.getAll()),i.html(this.template({atts:t})),i.attr("data-cid",this.model.get("cid")),i.addClass(FusionPageBuilderApp.isFlex(FusionPageBuilderApp.getParentContainer(this.model.get("cid")))?"has-flex":""),i.addClass(FusionPageBuilderApp.isBlockLayoutColumn(FusionPageBuilderApp.getParentColumn(this.model.get("cid")))&&"fusion_builder_column"!==this.model.get("element_type")&&"fusion_builder_column_inner"!==this.model.get("element_type")?"has-block-column":""),i.attr("data-type",this.model.get("type")),this.optionInit(i),setTimeout(function(){i.find("select, input, textarea, radio").filter(":eq(0)").not("[data-placeholder]").focus()},1),void 0!==this.model&&void 0!==this.model.get&&(e=void 0!==this.model.get("parent_values")&&this.model.get("parent_values"),FusionPageBuilderApp.checkOptionDependency(fusionAllElements[this.model.get("element_type")],i,e)),this.onRender(),FusionPageBuilderEvents.trigger("fusion-settings-modal-open"),this},beforeRender:function(){},onRender:function(){var e=this.$el.find('li[data-option-id="content_layout"]'),i="column";e.length&&(i=e.find("#content_layout").val(),e.attr("data-direction",i),e.find("#content_layout").on("change",function(){e.attr("data-direction",jQuery(this).val())}))},optionInit:function(i){var t,n,o,a,s,r,u,l,d,c,f,p,m,g,h,b,v,y,w,B,P,F,C,j,A,x,E,k,Q,T,S,M,I,V,D,O,$,L,z,N,G,W,H,R,U,J,K,q,Y,Z,X=i,ee=this,ie="",te=this.model.get("params"),ne=!1,oe=this,ae=!1,se=[],re={};if("undefined"!==(j=this.model).attributes.params.settings_lvl&&"parent"===j.attributes.params.settings_lvl&&(ae=!0,V=j.attributes.params),void 0!==j.get&&void 0!==j.get("allow_generator")&&!0===j.get("allow_generator")&&(FusionPageBuilderApp.allowShortcodeGenerator=!0),N=void 0!==this.model.get&&void 0!==this.model.get("parent_values")&&this.model.get("parent_values"),S=X.find("[data-placeholder]"),n=X.find(".fusion-editor-field"),a=X.find(".fusion-builder-color-picker-hex"),s=X.find(".fusion-builder-upload-button"),r=X.find(".fusion-iconpicker"),u=X.find(".fusion-form-multiple-select"),l=X.find(".fusion-form-checkbox-button-set"),d=X.find(".fusion-form-radio-button-set"),F=X.find(".fusion-slider-container"),A=X.find(".fusion-select-field:not( .fusion-skip-init )"),w=X.find(".fusion-select-field[data-conditions]"),E=X.find(".single-builder-dimension"),Q=X.find(".fusion-builder-code-block"),D=X.find(".fusion-builder-link-button"),O=X.find(".fusion-datetime.full-picker"),$=X.find(".fusion-datetime.date-picker"),L=X.find(".fusion-datetime.time-picker"),z=X.find(".fusion-multiple-image-container"),G=X.find(".fusion-builder-option.repeater"),W=X.find(".fusion-builder-option.sortable"),H=X.find(".fusion-builder-option.sortable_text"),J=X.find(".fusion-builder-option.connected_sortable"),Y=X.find(".fusion-form-column-width"),R=X.find(".fusion-form-form-options"),U=X.find(".fusion-builder-option-logics"),Z=X.find(".fusion-image-focus-point"),S.length&&S.on("focus",function(e){jQuery(e.target).data("placeholder")===jQuery(e.target).val()&&jQuery(e.target).val("")}),D.length&&FusionPageBuilderApp.fusionBuilderActivateLinkSelector(D),O.length&&jQuery(O).fusiondatetimepicker({format:"yyyy-MM-dd hh:mm:ss"}),$.length&&jQuery($).fusiondatetimepicker({format:"yyyy-MM-dd",pickTime:!1}),L.length&&jQuery(L).fusiondatetimepicker({format:"hh:mm:ss",pickDate:!1}),this.optionDynamicData(X),a.length&&a.each(function(){var i=e(this).parents(".fusion-builder-option").find(".fusion-builder-default-reset");e(this).awbColorPicker(),i.on("click",function(e){var i,t=jQuery(this).closest(".fusion-builder-option").find(".color-picker");e.preventDefault(),(i=t.attr("data-default")||t.attr("data-default-color"))&&t.val(i).trigger("change"),t.val("").trigger("change")})}),z.length&&z.each(function(){var e,i=jQuery(this);i.html(""),"string"==typeof i.parent().find("#image_ids").val()&&(e=i.parent().find("#image_ids").val().split(","),jQuery.each(e,function(e,i){""!==i&&"NaN"!==i&&void 0===wp.media.attachment(i).get("url")&&se.push(i)}),0<se.length?wp.media.query({post__in:se,posts_per_page:se.length}).more().then(function(t){oe.renderAttachments(e,i)}):oe.renderAttachments(e,i))}),Q.length&&Q.each(function(){var i;void 0!==wp.CodeMirror&&(k=e(this).attr("id"),T=X.find("#"+k),i=jQuery(this).data("language"),void 0!==(K=X.find("."+k).val())&&((K=JSON.parse(K)).lineNumbers=!0),void 0!==i&&"default"!==i&&(K.mode="text/"+i),FusionPageBuilderApp.codeEditor=wp.CodeMirror.fromTextArea(T[0],K),setTimeout(function(){FusionPageBuilderApp.codeEditor.refresh(),FusionPageBuilderApp.codeEditor.focus()},100))}),E.length&&E.each(function(){jQuery(this).find(".fusion-builder-dimension input").on("change paste keyup",function(){jQuery(this).parents(".single-builder-dimension").find('input[type="hidden"]').val((jQuery(this).parents(".single-builder-dimension").find("div:nth-child(1) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(1) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(2) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(2) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(3) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(3) input").val():"0px")+" "+(jQuery(this).parents(".single-builder-dimension").find("div:nth-child(4) input").val().length?jQuery(this).parents(".single-builder-dimension").find("div:nth-child(4) input").val():"0px"))})}),A.length)if(A.closest(".fusion-builder-option").find(".awb-quick-edit-button").length){const e=A.closest(".fusion-builder-option").find(".awb-quick-edit-button");A.select2().on("change",function(){var e=jQuery(this).val();!jQuery(this).closest(".fusion-builder-option").find(".awb-quick-edit-button").length||"0"!=e&&""!=e?jQuery(this).closest(".fusion-builder-option").find(".awb-quick-edit-button").addClass("has-quick-edit"):jQuery(this).closest(".fusion-builder-option").find(".awb-quick-edit-button").removeClass("has-quick-edit")}),e.on("click",function(){const e=jQuery(this).data("type"),i=jQuery(this).closest(".fusion-builder-option").find("select").val(),t=jQuery(this).data("items");let n;"menu"===e?window.open(fusionBuilderConfig.admin_url+"nav-menus.php?action=edit&menu="+t[i],"_blank").focus():(n="live"===fusionBuilderConfig.builder_type?t[i]+"?fb-edit=1":fusionBuilderConfig.admin_url+"post.php?post="+i+"&action=edit",window.open(n,"_blank").focus())})}else A.select2();if(w.length&&w.each(function(){var e=jQuery(this),i=jQuery(this).data("conditions"),t=jQuery(this).attr("id"),n="object"==typeof fusionAllElements[ee.model.get("element_type")].params[t]?fusionAllElements[ee.model.get("element_type")].params[t].default:"",o=null;if(!1!==(i=!!i&&JSON.parse(_.unescape(i)))){if("string"!=typeof i.option||"object"!=typeof i.map)return;"undefined"!==te[i.option]?o=te[i.option]:"object"==typeof fusionAllElements[ee.model.get("element_type")].params[t]&&(o=fusionAllElements[ee.model.get("element_type")].params[t].default),null!==o&&("object"==typeof i.map[o]?(e.find("option").prop("disabled",!0),_.each(i.map[o],function(i){e.find('option[value="'+i+'"]').prop("disabled",!1)})):e.find("option").prop("disabled",!1),ee.$el.find("#"+i.option).on("change",function(){var t=jQuery(this).val();"object"==typeof i.map[t]?(e.find("option").prop("disabled",!0),_.each(i.map[t],function(i){e.find('option[value="'+i+'"]').prop("disabled",!1)})):e.find("option").prop("disabled",!1),e.find("option:selected").prop("disabled")&&e.val(n).trigger("change"),e.select2()}))}}),Y.length&&Y.each(function(){var e,i,t,n=jQuery(this),o=n.find(".width-value").val(),a=n.find(".custom-width-range-slider");t=function(e){var i;return e.includes("_")?(i=e.split("_"),""===e?0:(parseFloat(i[0])/parseFloat(i[1])*100).toFixed(2)):0},i={start:[o],step:.01,direction:a.data("direction"),range:{min:0,max:100},format:wNumb({decimals:2})},e=noUiSlider.create(a[0],i),!o||o.includes("_")||"auto"===o?(n.find(".ui-input, .width-custom").hide(),n.find('.ui-button[data-value="'+o+'"]').addClass("ui-state-active"),e.set(t(o)),n.find(".ui-input input").val(t(o))):n.find(".ui-buttons, .width-default").hide(),e.on("slide",function(e,i){n.find(".ui-button").removeClass("ui-state-active"),n.find(".custom-width-input").val(e[i]),n.find(".width-value").val(e[i])}),n.on("click",".column-width-toggle",function(){n.find(".ui-input, .ui-buttons, a .label").toggle()}),n.on("click",".ui-button",function(){var i=jQuery(this),o=i.data("value");e.set(t(o)),n.find(".ui-input input").val(t(o)),n.find(".ui-button").removeClass("ui-state-active"),i.addClass("ui-state-active"),n.find(".width-value").val(i.data("value"))}),n.on("change",".ui-input input",function(){var i=jQuery(this).val();e.set(i),n.find(".ui-button").removeClass("ui-state-active"),n.find(".width-value").val(i)})}),X.find(".fusion-builder-option.typography").length&&(void 0===window.awbTypographySelect||void 0===window.awbTypographySelect.webfonts?jQuery.when(window.awbTypographySelect.getWebFonts()).done(function(){X.find(".fusion-builder-option.typography").each(function(){re[jQuery(this).attr("data-option-id")]=new AwbTypography(jQuery(this)[0],ee)})}):X.find(".fusion-builder-option.typography").each(function(){re[jQuery(this).attr("data-option-id")]=new AwbTypography(jQuery(this)[0],ee)})),s.length&&FusionPageBuilderApp.FusionBuilderActivateUpload(s),r.length&&r.each(function(){var e=jQuery(this);c=e.find(".fusion-iconpicker-input").val(),f=e.find(".fusion-iconpicker-input").attr("id"),p=e.find(".icon_select_container"),m=e.find(".fusion-icon-search"),FusionPageBuilderApp.fusion_builder_iconpicker(c,f,p,m)}),u.length&&u.each(function(){M=fusionBuilderText.select_options_or_leave_blank_for_all,-1!==jQuery(this).attr("id").indexOf("cat_slug")||-1!==jQuery(this).attr("id").indexOf("category")?M=fusionBuilderText.select_categories_or_leave_blank_for_all:-1!==jQuery(this).attr("id").indexOf("exclude_cats")?M=fusionBuilderText.select_categories_or_leave_blank_for_none:-1!==jQuery(this).attr("id").indexOf("social_share_links")&&(M=fusionBuilderText.select_or_leave_blank_for_global),jQuery(this).select2({placeholder:M})}),l.length&&((B=X.find(".fusion-form-checkbox-button-set.hide_on_mobile")).length&&("no"!==(P=B.find(".button-set-value").val())&&""!==P||B.find("a").addClass("ui-state-active"),"yes"===P&&B.find('a:not([data-value="small-visibility"])').addClass("ui-state-active")),l.find("a").on("click",function(e){e.preventDefault(),h=jQuery(this).parents(".fusion-form-checkbox-button-set"),jQuery(this).toggleClass("ui-state-active"),h.find(".button-set-value").val(h.find(".ui-state-active").map(function(e,i){return jQuery(i).data("value")}).get()).trigger("change")})),d.length&&(d.each(function(){if(jQuery(this).closest(".fusion-builder-option.subgroup").length){4<jQuery(this).find(".buttonset-item").length?jQuery(this).addClass("backend-icons-only"):jQuery(this).removeClass("backend-icons-only")}}),d.find("a").on("click",function(e){e.preventDefault(),b=jQuery(this).parents(".fusion-form-radio-button-set"),v=b.closest(".fusion-builder-option.subgroup"),q=v.attr("data-option-id"),b.find(".ui-state-active").removeClass("ui-state-active"),jQuery(this).addClass("ui-state-active"),b.find(".button-set-value").val(b.find(".ui-state-active").data("value")).trigger("change"),v.length&&((y=v.parent()).find('.fusion-subgroup-content[data-group="'+q+'"]').removeClass("active"),y.find(".fusion-subgroup-"+b.find(".ui-state-active").data("value")+'[data-group="'+q+'"]').addClass("active"))})),W.length&&FusionPageBuilderApp.fusion_builder_sortable(W),H.length&&FusionPageBuilderApp.fusion_builder_sortable_text(H),R.length&&FusionPageBuilderApp.fusion_builder_form_options(R),U.length&&FusionPageBuilderApp.fusion_builder_logics(U),J.length&&FusionPageBuilderApp.fusion_builder_connected_sortable(J),Z.length){const e=this.model;Z.each(function(){var i=jQuery(this).find(".point"),t=jQuery(this).find("input.fusion-builder-focus-point-field"),n=jQuery(this).find(".preview"),o=n.find(".image"),a=n.find(".no-image-holder"),s=o.data("image"),r=X.find(`[data-option-id="${o.data("image")}"]`).find(".fusion-builder-upload-preview img"),u=e.attributes.params[s],l=e.attributes.params.dynamic_params;l&&(l=FusionPageBuilderApp.base64Decode(l)),l&&""!==l[s]&&(u=!1),u?(a.hide(),o.show(),o.append(r.clone())):(o.hide(),a.show()),FusionPageBuilderEvents.on("awb-image-upload-url-"+o.data("image"),function(e){e?(r='<img src="'+e+'" alt="">',o.find("img").remove(),o.append(r),o.show(),a.hide()):(o.find("img").remove(),o.hide(),a.show())}),i.draggable({containment:"parent",scroll:!1,snap:".position-point",snapMode:"inner",snapTolerance:10,drag:function(e,i){var n=parseInt(100*parseFloat(jQuery(this).css("top"))/parseFloat(jQuery(this).parent().css("height"))),o=parseInt(100*parseFloat(jQuery(this).css("left"))/parseFloat(jQuery(this).parent().css("width"))),a=jQuery(this).offset();e.clientY,a.top,jQuery(this).outerHeight();t.val(`${o}% ${n}%`).trigger("change")},stop:function(e,i){var n=parseInt(100*parseFloat(jQuery(this).css("top"))/parseFloat(jQuery(this).parent().css("height"))),o=parseInt(100*parseFloat(jQuery(this).css("left"))/parseFloat(jQuery(this).parent().css("width"))),a=jQuery(this).offset();e.clientY,a.top,jQuery(this).outerHeight();t.val(`${o}% ${n}%`).trigger("change")}}).css("position","absolute"),X.find(".position-point").on("click",function(e){var n="50%",o="50%";e.preventDefault();const a=jQuery(this);a.hasClass("top-left")&&(n=0,o=0),a.hasClass("top-center")&&(n=0,o="50%"),a.hasClass("top-right")&&(n=0,o="100%"),a.hasClass("center-left")&&(n="50%",o=0),a.hasClass("center-center")&&(n="50%",o="50%"),a.hasClass("center-right")&&(n="50%",o="100%"),a.hasClass("bottom-left")&&(n="100%",o=0),a.hasClass("bottom-center")&&(n="100%",o="50%"),a.hasClass("bottom-right")&&(n="100%",o="100%"),i.css({top:n,left:o}),t.val(`${o} ${n}`).trigger("change")})})}this.model.get("element_type").includes("fusion_form_")&&(setTimeout(function(){var e,i,t=X.find('input[name="label"]')[0];t&&(e=t.value.length,document.selection?(t.focus(),(i=document.selection.createRange()).moveStart("character",-e),i.moveStart("character",e),i.moveEnd("character",0),i.select()):(t.selectionStart||"0"==t.selectionStart)&&(t.selectionStart=e,t.selectionEnd=e,t.focus()))},200),X.on("change",'[name="label"]',function(e){var i=e.target&&e.target.value||"",t=jQuery(this).parents().siblings('[data-option-id="name"]').find("input");""===t.val()&&i&&t.val(ee.fusionSanitize(i))}),X.on("keydown",'[name="name"], [name$="field_name"]',function(e){var i=e.which,t={109:"45",173:"45",186:"59",189:"45"};if(t.hasOwnProperty(i)&&(i=t[i]),!(65<=i&&90>=i||!e.shiftKey&&48<=i&&57>=i||45==i||e.shiftKey&&59==i||8==i||37<=i&&40>=i))return e.preventDefault()})),F.length&&(C=0,Number.prototype.countDecimals=function(){return Math.floor(this.valueOf())===this.valueOf()?0:this.toString().split(".")[1].length||0},F.each(function(){var e=jQuery(this).data("id"),i=jQuery(this).prev(".fusion-slider-input"),t=jQuery(this).data("min"),n=jQuery(this).data("max"),o=jQuery(this).data("step"),a=jQuery(this).data("direction"),s=i.val(),r=o.countDecimals(),u=!!jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").length&&jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default"),l=!!u&&jQuery(this).parent().find(".fusion-hidden-value"),d=!!u&&jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").data("default");void 0!==N&&void 0!==N[e]&&u&&(jQuery(this).parents(".fusion-builder-option").find(".fusion-range-default").data("default",N[e]),d=N[e],l&&""!==l.val()||(s=d)),function(e,i,t,n,o,a,s,r,u,l,d,c){var f=noUiSlider.create(F[e],{start:[s],step:a,direction:c,range:{min:n,max:o},format:wNumb({decimals:r})}),p=!1;u&&""===l.val()&&u.parent().addClass("checked"),u&&u.on("click",function(i){i.preventDefault(),F[e].noUiSlider.set(d),l.val(""),jQuery(this).parent().addClass("checked")}),f.on("update",function(e,t){u&&p&&(u.parent().removeClass("checked"),l.val(e[t])),!0===p&&jQuery(this.target).closest(".fusion-slider-container").prev().val(e[t]).trigger("change"),X.find("#"+i).trigger("change"),p=!0}),t.on("blur",function(i){this.value!==F[e].noUiSlider.get()&&(n<=this.value&&o>=this.value?F[e].noUiSlider.set(this.value):n>this.value?F[e].noUiSlider.set(n):o<this.value&&F[e].noUiSlider.set(o))})}(C,e,i,t,n,o,s,r,u,l,d,a),C++})),void 0!==this.model.get&&"fusion_woo_shortcodes"===this.model.get("element_type")&&!0===FusionPageBuilderApp.shortcodeGenerator&&X.find("#element_content").attr("id","generator_element_content"),n.length&&(o=n.closest(".fusion-builder-option"),void 0!==this.model.get("multi")&&"multi_element_parent"===this.model.get("multi")?(g=FusionPageBuilderViewManager.generateCid(),this.view_cid=g,o.hide(),n.attr("id","fusion_builder_content_main"),t=new FusionPageBuilder.MultiElementSortablesView({model:this,el:this.$el.find(".fusion-builder-option-advanced-module-settings"),attributes:{cid:g,parentCid:this.model.get("cid")}}),FusionPageBuilderViewManager.addView(g,t),o.before(t.render()),""!==n.html()&&t.generateMultiElementChildSortables(n.html(),X.find(".fusion-builder-option-advanced-module-settings").data("element_type"),ae,V)):(ie=n.html(),!0===FusionPageBuilderApp.shortcodeGenerator?(!0===FusionPageBuilderApp.shortcodeGeneratorMultiElementChild?n.attr("id","generator_multi_child_content"):n.attr("id","generator_element_content"),x=n.attr("id"),setTimeout(function(){n.wp_editor(ie,x),jQuery("#"+x).data("placeholder")&&window.tinyMCE.get(x).on("focus",function(){I=window.tinyMCE.get(x).getContent(),(I=jQuery("<div/>").html(I).text())===jQuery("#"+x).data("placeholder")&&window.tinyMCE.get(x).setContent("")})},100)):(x=n.attr("id"),setTimeout(function(){void 0!==j.get("allow_generator")&&!0===j.get("allow_generator")&&(ne=!0),n.wp_editor(ie,x,ne),jQuery("#"+x).data("placeholder")&&window.tinyMCE.get(x).on("focus",function(){I=window.tinyMCE.get(x).getContent(),(I=jQuery("<div/>").html(I).text())===jQuery("#"+x).data("placeholder")&&window.tinyMCE.get(x).setContent("")})},100)))),G.length&&G.each(function(){oe.initRepeater(jQuery(this))}),X.find(".uploadattachment .fusion-builder-upload-button").on("click",function(){alert(fusionBuilderText.to_add_images)}),this.initAjaxSelects(),FusionPageBuilderApp.rangeOptionPreview(X)},initAjaxSelects:function(){"undefined"==typeof ajaxurl&&(ajaxurl=fusionBuilderConfig.ajaxurl),this.$el.find(".fusion-ajax-select").each(function(){var e,i,t,n,o,a;e=jQuery(this),i=e.data("ajax"),a=e.data("max-input"),t=e.siblings(".params").val(),n=(n=e.siblings(".initial-values").val())?JSON.parse(_.unescape(n)):[],t=t?JSON.parse(_.unescape(t)):[],o=function(){var n=e.select2({width:"100%",delay:250,minimumInputLength:3,maximumSelectionLength:a,ajax:{url:ajaxurl,dataType:"json",data:function(e){return{action:i,search:e.term,params:t,fusion_po_nonce:jQuery("#fusion-page-options-nonce").val()}}}});void 0!==n.data("select2").dropdown&&(void 0!==n.data("select2").dropdown.$dropdown?n.data("select2").dropdown.$dropdown.addClass("avada-select2"):void 0!==n.data("select2").dropdown.selector&&jQuery(n.data("select2").dropdown.selector).addClass("avada-select2")),n.data("select2").on("results:message",function(){this.dropdown._resizeDropdown(),this.dropdown._positionDropdown()})},n?(e.addClass("loading"),jQuery.post(ajaxurl,{action:i,labels:n,params:t,fusion_po_nonce:jQuery("#fusion-page-options-nonce").val()},function(i){i=JSON.parse(i),n=i.labels||[],_.each(n,function(i){e.append('<option value="'+i.id+'" selected="selected">'+i.text+"</option>")}),e.removeClass("loading"),o()})):o()})},beforeRemove:function(){},removeElement:function(){this.beforeRemove(),this.remove()},initRepeater:function(e){var i=this,t=e.data("option-id"),n=fusionAllElements[this.model.get("element_type")].params[t],o=void 0!==n?n.fields:{},a=this.model.get("params"),s=void 0!==a[t]?a[t]:"",r=e.find(".repeater-rows"),u=void 0!==n&&n.row_title,l=!1;if("string"==typeof s&&""!==s)try{FusionPageBuilderApp.base64Encode(FusionPageBuilderApp.base64Decode(s))===s&&(s=FusionPageBuilderApp.base64Decode(s),s=_.unescape(s),s=JSON.parse(s),l=!0)}catch(e){}else i.createRepeaterRow(o,{},r,u);"object"==typeof s&&l&&_.each(s,function(e,t){i.createRepeaterRow(o,s[t],r,u)}),e.on("click",".repeater-row-add",function(e){e.preventDefault(),i.createRepeaterRow(o,{},r,u)}),e.on("click",".repeater-row-remove",function(e){e.preventDefault(),jQuery(this).parents(".repeater-row").first().remove()}),e.on("click",".repeater-title",function(){jQuery(this).parent().find(".repeater-fields").slideToggle(300),jQuery(this).find(".repeater-toggle-icon").hasClass("fusiona-plus2")?jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-plus2").addClass("fusiona-minus"):jQuery(this).find(".repeater-toggle-icon").removeClass("fusiona-minus").addClass("fusiona-plus2")}),e.sortable({handle:".repeater-title",items:".repeater-row",cursor:"move",cancel:".repeater-row-remove",update:function(){}})},createRepeaterRow:function(e,i,t,n){var o,a="",s=FusionPageBuilder.template(jQuery("#fusion-app-repeater-fields").html()),r={};a+='<div class="repeater-row">',a+='<div class="repeater-title">',a+='<span class="repeater-toggle-icon fusiona-plus2"></span>',a+="<h3>"+(n=void 0!==n&&n?n:"Repeater Row")+"</h3>",a+='<span class="repeater-row-remove fusiona-plus2"></span>',a+="</div>",a+='<ul class="repeater-fields">',_.each(e,function(e){o=i[e.param_name],r[e.param_name]=e,a+=jQuery(s({field:e,value:o})).html()}),a+="</ul>",a+="</div>",this.optionInit(t.append(a).children("div:last-child")),void 0!==this.model&&void 0!==this.model.get&&FusionPageBuilderApp.checkOptionDependency(fusionAllElements[this.model.get("element_type")],t.children("div:last-child"),!1,r,this.$el)},renderAttachments:function(e,i){var t,n,o,a;0<e.length&&jQuery.each(e,function(e,s){""!==s&&"NaN"!==s&&(n=wp.media.attachment(s),o=n.get("sizes"),a=void 0!==o[200]?o[200].url:void 0!==o.thumbnail?o.thumbnail.url:n.get("url"),t='<div class="fusion-multi-image" data-image-id="'+n.get("id")+'">',t+='<img src="'+a+'"/>',t+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',t+="</div>",i.append(t))})},fusionSanitize:function(e){var i={"":"A","":"A","":"A","":"A","":"A","":"A","":"AE","":"C","":"E","":"E","":"E","":"E","":"I","":"I","":"I","":"I","":"D","":"N","":"O","":"O","":"O","":"O","":"O","":"O","":"U","":"U","":"U","":"U","":"Y","":"s","":"a","":"a","":"a","":"a","":"a","":"a","":"ae","":"c","":"e","":"e","":"e","":"e","":"i","":"i","":"i","":"i","":"n","":"o","":"o","":"o","":"o","":"o","":"o","":"u","":"u","":"u","":"u","":"y","":"y","":"A","":"a","":"A","":"a","":"A","":"a","":"C","":"c","":"C","":"c","":"C","":"c","":"C","":"c","":"D","":"d","":"D","":"d","":"E","":"e","":"E","":"e","":"E","":"e","":"E","":"e","":"E","":"e","":"G","":"g","":"G","":"g","":"G","":"g","":"G","":"g","":"H","":"h","":"H","":"h","":"I","":"i","":"I","":"i","":"I","":"i","":"I","":"i","":"I","":"i","":"IJ","":"ij","":"J","":"j","":"K","":"k","":"L","":"l","":"L","":"l","":"L","":"l","":"L","":"l","":"l","":"l","":"N","":"n","":"N","":"n","":"N","":"n","":"n","":"O","":"o","":"O","":"o","":"O","":"o","":"OE","":"oe","":"R","":"r","":"R","":"r","":"R","":"r","":"S","":"s","":"S","":"s","":"S","":"s","":"S","":"s","":"T","":"t","":"T","":"t","":"T","":"t","":"U","":"u","":"U","":"u","":"U","":"u","":"U","":"u","":"U","":"u","":"U","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"z","":"Z","":"z","":"Z","":"z","":"s","":"f","":"O","":"o","":"U","":"u","":"A","":"a","":"I","":"i","":"O","":"o","":"U","":"u","":"U","":"u","":"U","":"u","":"U","":"u","":"U","":"u","":"A","":"a","":"AE","":"ae","":"O","":"o","":"a","":"A","":"v","":"V","":"g","":"G","":"d","":"D","":"e","":"E","":"z","":"Z","":"i","":"I","":"th","":"TH","":"i","":"I","":"k","":"K","":"l","":"L","":"m","":"M","":"n","":"N","":"ks","":"KS","":"o","":"O","":"p","":"P","":"r","":"R","":"s","":"S","":"s","":"t","":"T","":"y","":"Y","":"f","":"F","":"x","":"X","":"ps","":"PS","":"o","":"O"," ":"_","'":"","?":"","/":"","\\":"",".":"",",":"","`":"",">":"","<":"",'"':"","[":"","]":"","|":"","{":"","}":"","(":"",")":""};return e.replace(/\W/g,function(e){return void 0!==i[e]?i[e]:e}).toLowerCase()}}),_.extend(FusionPageBuilder.ElementSettingsView.prototype,FusionPageBuilder.options.fusionDynamicData)})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.MultiElementSettingsView=FusionPageBuilder.ElementSettingsView.extend({events:function(){return _.extend({},FusionPageBuilder.ElementSettingsView.prototype.events,{"click .insert-slider-video":"addSliderVideo"})},addSliderVideo:function(i){var t,n,o,a;i&&i.preventDefault(),FusionPageBuilderApp.manualGenerator=FusionPageBuilderApp.shortcodeGenerator,FusionPageBuilderApp.manualEditor=FusionPageBuilderApp.shortcodeGeneratorEditorID,FusionPageBuilderApp.manuallyAdded=!0,FusionPageBuilderApp.shortcodeGenerator=!0,FusionPageBuilderApp.shortcodeGeneratorEditorID="video",o=e(i.currentTarget).data("type"),t=fusionAllElements[o].params,n={},_.each(t,function(e){a=_.isObject(e.value)?e.default:e.value,n[e.param_name]=a}),this.collection.add([{type:"generated_element",added:"manually",element_type:o,params:n}])}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){var i,t,n,o,a,s,r;function u(e){if(s)return e();a?o.success(e):(a=!0,o=jQuery.ajax({url:r.ajaxurl,type:"post",dataType:"json",data:{action:"fusion_get_widget_form"}}).done(function(i){return s=!0,a=!1,n=i.data,_.each(n,function(e,i){void 0===fusionAllElements.fusion_widget.params.type.value[i]&&jQuery.map(fusionAllElements.fusion_widget.params.type.value,function(t,o){t===e.name&&(e.title=o,n[o]=e,n[i].delete)})}),e&&e()}))}i=[],e(document).ready(function(){(r="undefined"!=typeof FusionApp?fusionAppConfig:fusionBuilderConfig).widget_element_enabled&&u(),FusionPageBuilder.BaseWidgetSettingsView=FusionPageBuilder.ElementSettingsView.extend({invalidWidgets:["Fusion_Widget_Social_Links"],createWidgetFieldName:function(e,i){var t=e.toLowerCase().replace(/\\/g,"_")+"__";i=i.toLowerCase();try{t+=i.match(/\[(.*?)\]/g).slice(-1)[0].replace(/\[|(\])/g,"")}catch(e){}return t},registerWidget:function(t,n){var o,a,s,r,u,l;l=this,s={},o=e("<form></form>").html(t.form),a=["fieldset","input","select","textarea"].join(","),r=function(e,i){var t={};return _.each(i,function(i){t[i]=e[i]}),t},o.find(a).not('[type="button"]').each(function(){var e,i;switch(e=r(this,["id","className","name","tagName","type","value","placeholder","options","checked"]),i=l.createWidgetFieldName(n,e.name),e.options=_.map(e.options,function(e){return r(e,["value","text","selected"])}),e.tagName){case"INPUT":["text","number"].includes(e.type)?e.type="textfield":"checkbox"===e.type&&(e.type="radio_button_set",e.value={on:"On",off:"Off"},e.default=e.checked?"on":"off");break;case"SELECT":e.type="select",e.value=_.reduce(e.options,function(i,t){return t.selected&&(e.default=t.value),i[t.value]=t.text,i},{});break;case"TEXTAREA":e.type="textarea"}e.id&&(e.id="widget-menu-widget--menu_Link_color"===e.id?e.id.toLowerCase():e.id,e.heading=o.find('label[for="'+e.id+'"]').text()||e.placeholder),e.param_name=i,e.callback={},e.callback.function="fusion_get_widget_markup",e.callback.ajax=!0,"hidden"===e.type&&(delete e.dependency,e.hidden=!0),s[i]=e}),u=_.find(s,function(e){return!e.heading||!e.name}),i[n]={className:n,fields:s,data:t,isInvalid:u||this.invalidWidgets.includes(n),isCoreWidget:["WP_Widget_Text","WP_Widget_Media_Audio","WP_Widget_Media_Image","WP_Widget_Media_Video","WP_Widget_Media_Gallery","WP_Widget_Custom_HTML"].includes(n)}},registerWidgets:function(){var e=this;u(function(){e.widgetData=n,i.length||_.each(e.widgetData,e.registerWidget.bind(e)),e.setWidgetFields(),t&&("WP_Widget_Custom_HTML"===t.className?e.model.attributes.params.wp_widget_custom_html__content=_.unescape(e.model.attributes.params.wp_widget_custom_html__content):"WP_Widget_Text"===t.className&&(e.model.attributes.params.wp_widget_text__text=_.unescape(e.model.attributes.params.wp_widget_text__text)))})},clean:function(){this.destroyWidgetOptions(),this.deleteWpModels(),this.cleanForm()},cleanForm:function(){this.$el.find(".fusion-widget-settings-form").remove()},insertForm:function(){var e,i,n,o,a,s,r,u=this;e=this.$el.find("#general .fusion_widget .fusion-builder-option:first "),o=t.data,r=t.className,n={coreWidget:t.isCoreWidget,attributes:{id:o.id+"-"+this.cid,base:o.id,form:o.form,type:r,class:o.classname},widgetData:this.widgetData},this.appendedForm=this.formTemplate(n),e.after(this.appendedForm),jQuery(e.next()).find("label").each(function(){"INPUT"===jQuery(this).prev().prop("tagName")&&jQuery(this).prev().before(jQuery(this)),jQuery(this).children().insertAfter(jQuery(this))}),n.coreWidget?(s=this.$el.find(".widget-inside").parent(),this.setFormValues(r),i=new jQuery.Event("widget-added"),"WP_Widget_Text"===r?wp.textWidgets.handleWidgetAdded(i,s):"WP_Widget_Custom_HTML"===r?wp.customHtmlWidgets.handleWidgetAdded(i,s):wp.mediaWidgets.handleWidgetAdded(i,s),this.$el.find(".widget-inside").css("display","block"),this.$el.find(".wp-editor-area").length&&setTimeout(function(){wp.textWidgets.widgetControls["text-"+u.cid].initializeEditor()},200),this.$el.find(".custom-html-widget-fields .code").length&&(a=this.$el.find(".custom-html-widget-fields .code"),u.codeBlock=a.next(".CodeMirror").get(0).CodeMirror,u.codeBlock||(u.codeBlock=CodeMirror.fromTextArea(a[0],{lineNumbers:!0,lineWrapping:!0,autofocus:!0,mode:"htmlmixed"})),setTimeout(function(){u.codeBlock.refresh(),u.codeBlock.focus()},100))):(s=this.$el.find(".fusion-widget-settings-form"),this.setFormValues(r),setTimeout(function(){s.find(".widget-inside").css("display","block")},100))},setFormValues:function(e){var i=this,t=e.toLowerCase()+"__";_.each(this.model.attributes.params,function(e,n){var o,a;"type"!==n&&-1!==n.indexOf(t)&&(a='[name$="['+n.replace(t,"")+']"]',o=i.$el.find(a)),o&&o.length&&(o.is(":checkbox")?1===parseInt(e)||!0===e||"on"===e||"enabled"===e?o.prop("checked",!0):o.prop("checked",!1):o.val(e))})},deleteWpModels:function(){void 0!==wp.mediaWidgets.widgetControls&&void 0!==wp.mediaWidgets.modelCollection&&(wp.mediaWidgets.modelCollection.reset(),wp.mediaWidgets.widgetControls={}),void 0!==wp.textWidgets.widgetControls&&(wp.textWidgets.widgetControls={}),void 0!==wp.customHtmlWidgets.widgetControls&&(wp.customHtmlWidgets.widgetControls={})},destroyWidgetOptions:function(){this.$el.find(".wp-editor-area").each(function(){var e=jQuery(this).attr("id");void 0!==window.tinyMCE&&(window.tinyMCE.execCommand("mceRemoveEditor",!1,e),void 0!==window.tinyMCE.get(e)&&window.tinyMCE.remove("#"+e))})},cleanWidget:function(){var e=this;t&&(_.each(t.fields,function(i,t){delete fusionAllElements.fusion_widget.params[t],delete e.model.attributes.params[t]}),t=null)},getWidget:function(){return t},setWidget:function(){var e=this.model.attributes.params.type;e&&i[e]&&(t=i[e])},updateWidget:function(){var e=this;!t||t.isCoreWidget||t.isInvalid||(fusionAllElements.fusion_widget.params=_.extend({type:fusionAllElements.fusion_widget.params.type},t.fields,fusionAllElements.fusion_widget.params),_.each(t.fields,function(i,t){void 0===e.model.attributes.params[t]&&("object"==typeof i.value&&i.value[i.default]?e.model.attributes.params[t]=i.default:"object"!=typeof i.value&&(i.default||i.value)&&(e.model.attributes.params[t]=i.default||i.value))}))},setWidgetFields:function(){t&&t.className===this.model.attributes.params.type||(this.cleanWidget(),this.setWidget(),this.updateWidget())}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.BulkAddView=window.wp.Backbone.View.extend({className:FusionPageBuilder.ElementSettingsView.prototype.className+" fusion-builder-bulk-add-dialog",template:FusionPageBuilder.template(e("#fusion-builder-bulk-add-template").html()),events:{"click .predefined-choice":"predefinedChoices"},getChoices:function(){var e=this.$el.find("textarea").val(),i=[];return e&&_.each(e.split(/\n/),function(e){var t=e.trim();t&&i.push(t)}),i},predefinedChoices:function(e){var i,t=jQuery(e.target).data("value");isNaN(t)||(i=(i=this.options.choices[t].values).join("\n"),this.$el.find("textarea").val(i))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.MultiElementSortablesView=window.wp.Backbone.View.extend({initialize:function(){!0===FusionPageBuilderApp.shortcodeGenerator&&(FusionPageBuilderApp.shortcodeGeneratorMultiElement=!0),this.listenTo(FusionPageBuilderEvents,"fusion-multi-element-edited",this.generateContent),this.listenTo(FusionPageBuilderEvents,"fusion-multi-remove-sortables-view",this.removeView),this.element_type=this.$el.data("element_type"),this.child_views=[],this.fetchIds=[],this.childIds=[],this.updateGallery=!1,this.$el.attr("data-cid",this.attributes.cid),this.$sortable_options=this.$el.find(".fusion-builder-sortable-options"),this.$sortable_options.sortable({axis:"y",cancel:".fusion-builder-multi-setting-remove, .fusion-builder-multi-setting-options, .fusion-builder-multi-setting-clone",helper:"clone",update:function(){FusionPageBuilderEvents.trigger("fusion-multi-element-edited")}}),this.$add_sortable_item=this.$el.find(".fusion-builder-add-multi-child").addClass("fusion-builder-add-sortable-initial")},events:{"click .fusion-builder-add-multi-child":"addChildElement","click .fusion-builder-add-predefined-multi-child":"addPredefinedChildElement","click .fusion-builder-add-multi-gallery-images":"addChildrenToGalleryAndImageCarouselElements"},render:function(){return this},addChildElement:function(e,i){var t,n,o,a={};e&&e.preventDefault(),t=i||fusionAllElements[this.element_type].params,o=void 0!==fusionAllElements[this.element_type].allow_generator?fusionAllElements[this.element_type].allow_generator:"",_.each(t,function(e){n=_.isObject(e.value)?e.default:e.value,a[e.param_name]=n}),this.model.collection.add([{type:"element",element_type:this.element_type,cid:FusionPageBuilderViewManager.generateCid(),view:this,created:"manually",multi:"multi_element_child",child_element:"true",parent:this.attributes.cid,params:a,allow_generator:o}]),this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")},addPredefinedChildElement:function(e){var i,t=this;e.preventDefault(),jQuery(".fusion-builder-settings-bulk-dialog").length||(i=new FusionPageBuilder.BulkAddView({choices:fusionBuilderConfig.predefined_choices}),jQuery(i.render().el).dialog({title:fusionBuilderText.bulk_add+" / "+fusionBuilderText.bulk_add_predefined,dialogClass:"fusion-builder-settings-bulk-dialog",resizable:!1,width:500,draggable:!1,buttons:[{text:fusionBuilderText.cancel,click:function(){jQuery(this).dialog("close")}},{text:fusionBuilderText.bulk_add_insert_choices,click:function(){var n=i.getChoices();e.preventDefault(),_.each(n,function(e){var i={};-1!==e.indexOf("||")?_.each(e.split("||"),function(e){var t=e.split("|");i[t[0]]={},i[t[0]].param_name=t[0].trim(),i[t[0]].value=t[1].trim()}):i={element_content:{param_name:"element_content",value:e}},t.addChildElement(null,i),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview")}),jQuery(this).dialog("close")},class:"ui-button-blue"}],open:function(){jQuery(".fusion-builder-modal-settings-container").css("z-index",9998)},beforeClose:function(){jQuery(".fusion-builder-modal-settings-container").css("z-index",99999),jQuery(this).remove()}}))},addChildrenToGalleryAndImageCarouselElements:function(e){jQuery(e.currentTarget).closest(".fusion-builder-main-settings").find(".fusion-multiple-upload-image input").trigger("click")},generateContent:function(){var i="";this.$sortable_options.find("li").each(function(){var t=e(this);i+=FusionPageBuilderApp.generateElementShortcode(t,!1)}),this.$el.parents().find("#fusion_builder_content_main").html(i),this.$sortable_options.find("li").length?this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"):this.$add_sortable_item.addClass("fusion-builder-add-sortable-initial")},updateGalleryContent:function(){var i="",t=this,n=FusionPageBuilderApp.collection.find(function(e){return e.get("cid")===t.attributes.parentCid});this.$sortable_options.find("li").each(function(){var t=e(this);i+=FusionPageBuilderApp.generateElementShortcode(t,!1)}),n.attributes.params.element_content=i,this.$el.parents().find("#fusion_builder_content_main").html(i),this.$sortable_options.find("li").length?this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"):this.$add_sortable_item.addClass("fusion-builder-add-sortable-initial"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview"),FusionPageBuilderEvents.trigger("fusion-element-added"),this.fetchIds=[],this.childIds=[]},removeView:function(e){e&&e.preventDefault(),this.remove()},generateMultiElementChildSortables:function(e,i,t,n){var o=this,a=jQuery.map(fusionMultiElements,function(e,i){return e}).join("|"),s=window.wp.shortcode.regexp(a),r=FusionPageBuilderApp.regExpShortcode(a),u=e.match(s);this.updateGallery=!1,""!==e&&this.$add_sortable_item.removeClass("fusion-builder-add-sortable-initial"),_.each(u,function(e){var a,s,u,l,d,c,f=e.match(r),p=f[2],m=""!==f[3]?window.wp.shortcode.attrs(f[3]):"",g=f[5],h="",b=(FusionPageBuilderViewManager.generateCid(),{params:{}}),v=void 0!==fusionAllElements[p].allow_generator?fusionAllElements[p].allow_generator:"";if(void 0!==m.named&&void 0!==m.named.title&&m.named.title.length?h=m.named.title:void 0!==m.named&&void 0!==m.named.title_front&&m.named.title_front.length?h=m.named.title_front:void 0!==m.named&&void 0!==m.named.name&&m.named.name.length?(h=m.named.name,void 0!==m.named.company&&m.named.company.length&&(h+=", "+m.named.company)):void 0!==m.named&&void 0!==m.named.image&&m.named.image.length&&"fusion_testimonial"!==p?-1!==(h=m.named.image).indexOf("/")&&-1===h.indexOf("[")&&(h=(h=h.split("/")).slice(-1)[0]):void 0!==m.named&&"image"===m.named.type&&void 0!==g&&g.length?-1!==(h=g).indexOf("/")&&-1===h.indexOf("[")&&(h=(h=h.split("/")).slice(-1)[0]):void 0!==m.named&&void 0!==m.named.video&&m.named.video.length?h=m.named.video:void 0!==m.named&&void 0!==g&&g.length&&(h=g),h=jQuery("<div/>").html(h).text(),h=jQuery("<div/>").html(h).text(),a={type:"element",element_type:i,element_name:h,cid:FusionPageBuilderViewManager.generateCid(),view:o,created:"auto",multi:"multi_element_child",child_element:"true",allow_generator:v,params:{},parent:o.attributes.cid},_.isObject(m.named)){for(s in m.named)u=s,("fusion_builder_column"===p&&"type"===u||"fusion_builder_column_inner"===p&&"type"===u)&&(b[u="layout"]=m.named[s]),b.params[u]=m.named[s];a=_.extend(a,b)}a.params.element_content=g,void 0!==fusionAllElements[p].option_dependency&&(l=fusionAllElements[p].option_dependency,d=b.params[l],c=b.params.element_content,b.params[d]=c),!0===t&&"fusion_content_box"===i&&(a.params.iconcolor="",a.params.backgroundcolor="",a.params.circlecolor="",a.params.circlebordercolor="",a.params.circlebordersize="",a.params.outercirclebordercolor="",a.params.outercirclebordersize="",a.params.animation_type=n.animation_type,a.params.animation_direction=n.animation_direction,a.params.animation_speed=n.animation_speed,a.params.link_target=n.link_target),"fusion_gallery"===o.model.attributes["data-element_type"]&&(void 0!==a.params.image&&""!==a.params.image||""!==a.params.image_id&&"NaN"!==a.params.image_id&&void 0!==a.params.image_id&&(void 0===wp.media.attachment(a.params.image_id).get("url")?(o.fetchIds.push(a.params.image_id),o.childIds.push(a.cid),o.updateGallery=!0):(a.params.image=wp.media.attachment(a.params.image_id).get("url"),o.updateGallery=!0))),o.model.collection.add([a])}),setTimeout(function(){FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview")},200),"fusion_gallery"===o.model.attributes["data-element_type"]&&o.updateGallery&&(void 0!==o.fetchIds&&0<o.fetchIds.length?wp.media.query({post__in:o.fetchIds,posts_per_page:o.fetchIds.length}).more().then(function(){_.each(o.childIds,function(e){var i=FusionPageBuilderApp.collection.find(function(i){return i.get("cid")===e});void 0!==wp.media.attachment(i.attributes.params.image_id).get("url")&&(i.attributes.params.image=wp.media.attachment(i.attributes.params.image_id).get("url"))}),setTimeout(function(){o.updateGalleryContent()},200)}):setTimeout(function(){o.updateGalleryContent()},200))}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.MultiElementSortableChild=window.wp.Backbone.View.extend({tagName:"li",className:"fusion-builder-data-cid",initialize:function(){this.template=FusionPageBuilder.template(e("#fusion-builder-multi-child-sortable").html()),this.listenTo(FusionPageBuilderEvents,"fusion-multi-child-update-preview",this.updatePreview)},events:{"click .fusion-builder-multi-setting-options":"showSettings","click .fusion-builder-multi-setting-remove":"removeView","click .fusion-builder-multi-setting-clone":"cloneElement"},render:function(){return this.$el.html(this.template({atts:this.model.attributes})),this},cloneElement:function(i){var t,n=this.$el.find(".multi-element-child-name").html();i&&i.preventDefault(),(t=e.extend(!0,{},this.model.attributes)).created="manually",t.cid=FusionPageBuilderViewManager.generateCid(),t.cloned=!0,t.targetElement=this.$el,t.titleLabel=n,FusionPageBuilderApp.collection.add(t),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")},showSettings:function(i){var t,n,o={};i&&i.preventDefault(),FusionPageBuilderApp.MultiElementChildSettings=!0,!0===FusionPageBuilderApp.shortcodeGenerator&&(FusionPageBuilderApp.shortcodeGeneratorMultiElementChild=!0),jQuery(document).find(".fusion-builder-option.range .fusion-hidden-value, .wp-color-picker, .has-child-dependency input, .has-child-dependency select, .has-child-dependency textarea, .has-child-dependency #fusion_builder_content_main, .has-child-dependency #fusion_builder_content_main_child").not(":input[type=button], .fusion-icon-search, .category-search-field, .fusion-builder-table input, .fusion-builder-table textarea, .single-builder-dimension .fusion-builder-dimension input, .fusion-hide-from-atts").each(function(){jQuery(this).val().length&&(o[jQuery(this).attr("id")]=jQuery(this).val())}),this.model.set({parent_values:o}),n={model:this.model,collection:this.collection,attributes:{"data-modal_view":"multi_element_child_settings"}},t=new FusionPageBuilder.ModalView(n),e(".fusion_builder_modal_multi_element_settings_container").last().after(t.render().el)},updatePreview:function(){var e,i,t,n,o=this.model.attributes,a=this.model;void 0!==o&&(e="",void 0!==o.params.title&&o.params.title.length?e=o.params.title:"fusion_flip_box"===a.get("element_type")&&void 0!==o.params.title_front&&o.params.title_front.length?e=o.params.title_front:"fusion_testimonial"===a.get("element_type")&&void 0!==o.params.name&&o.params.name.length?(e=o.params.name,void 0!==o.params.company&&o.params.company.length&&(e+=", "+o.params.company)):void 0!==o.params.image&&o.params.image.length&&"fusion_testimonial"!==a.get("element_type")?(e=o.params.image,i=e,-1!==e.indexOf("/")&&-1===e.indexOf("[")&&(e=(e=e.split("/")).slice(-1)[0]),_.isEmpty(e)&&(e=fusionBuilderText.image)):void 0!==o.params.video&&o.params.video.length?e=o.params.video:void 0!==o.params.element_content&&o.params.element_content.length&&(e=o.params.element_content),e=jQuery("<div/>").html(e).text(),(e=jQuery("<div/>").html(e).text())&&(e='<span class="fusion-child-name-label">'+e+"</span>",_.isEmpty(i)?jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e):(0===(t=i.substr(i.lastIndexOf("."))).indexOf(".")&&(i=(i=i.replace(/-\d+x\d+\./,".")).replace(t,"-66x66"+t)),(n=new Image).src=i,n.onload=function(){e='<img class="fusion-child-element-image" src="'+i+'" >'+e,jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e)},n.onerror=function(){e='<span class="fusion-image-placeholder fusiona fusiona-image"></span>'+e,jQuery("li[data-cid="+a.get("cid")+"] .multi-element-child-name").html(e)})))},removeView:function(e){e&&e.preventDefault(),this.remove(),this.model.destroy(),FusionPageBuilderEvents.trigger("fusion-multi-element-edited")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};!function(e){e(document).ready(function(){FusionPageBuilder.ColumnLibraryView=FusionPageBuilder.BaseLibraryView.extend({className:"fusion_builder_modal_settings",template:FusionPageBuilder.template(e("#fusion-builder-column-library-template").html()),events:{"click .fusion-builder-column-layouts li":"addColumns","click .fusion_builder_custom_columns_load":"addCustomColumn","click .fusion_builder_custom_sections_load":"addCustomSection","click .fusion-special-item":"addSpecialItem","click .awb-import-options-toggle":"toggleImportOptions","click #fusion-builder-sections-studio .awb-import-studio-item":"loadStudioContainer","click #fusion-builder-columns-studio .awb-import-studio-item":"loadStudioColumn"},render:function(){var e=this;return this.$el.html(this.template(this.model.toJSON())),FusionPageBuilderApp.showSavedElements("columns",this.$el.find("#custom-columns")),"container"===FusionPageBuilderApp.activeModal?(FusionPageBuilderApp.showSavedElements("sections",this.$el.find("#custom-sections")),this.loadStudio("sections")):this.loadStudio("columns"),setTimeout(function(){e.$el.find(".fusion-elements-filter").focus()},50),this},loadStudioColumn:function(e){var i,t=this,n=jQuery(e.currentTarget).closest(".fusion-page-layout"),o=FusionPageBuilderApp.studio.getImportOptions(e);e&&e.preventDefault(),FusionPageBuilderApp.activeModal="column",!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,i=n.data("layout-id"),jQuery.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"JSON",data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:!1,fusion_layout_id:i,overWriteType:o.overWriteType,shouldInvert:o.shouldInvert,imagesImport:o.imagesImport,fusion_studio:!0,category:"columns",post_id:fusionBuilderConfig.post_id},beforeSend:function(){jQuery("#fusion-builder-columns-studio").find(".fusion-loader").show(),jQuery("#fusion-builder-columns-studio").find(".studio-wrapper").addClass("loading"),jQuery(".fusion-loader .awb-studio-import-status").html(fusionBuilderText.studio_importing_content)},success:function(i){var n,a=[],s=jQuery.Deferred(),r=s;if(s.resolve(),t.mediaImportKeys=[],"object"==typeof i.avada_media&&Object.keys(i.avada_media).forEach(function(e){"object"!=typeof i.avada_media[e]||Array.isArray(i.avada_media[e])||t.mediaImportKeys.push(e)}),0<t.mediaImportKeys.length){for(FusionPageBuilderApp.studio.setImportData(i),n=0;n<t.mediaImportKeys.length;n++)!function(e){r=r.then(function(){return t.importStudioMedia(FusionPageBuilderApp.studio.getImportData(),t.mediaImportKeys[e],o)}),a.push(r)}(n);jQuery.when.apply(null,a).then(function(){FusionPageBuilderApp.shortcodesToBuilder(FusionPageBuilderApp.studio.getImportData().post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,FusionPageBuilderEvents.trigger("fusion-studio-content-imported",FusionPageBuilderApp.studio.getImportData()),t.studioColumnImportComplete(e),FusionPageBuilderApp.studio.resetImportData()},function(){jQuery(".fusion-loader .awb-studio-import-status").html(fusionBuilderText.studio_importing_content_failed),t.studioColumnImportComplete(e),FusionPageBuilderApp.studio.resetImportData()})}else FusionPageBuilderApp.shortcodesToBuilder(i.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,FusionPageBuilderEvents.trigger("fusion-studio-content-imported",i),t.studioColumnImportComplete(e)}}))},studioColumnImportComplete:function(e){var i=jQuery(e.currentTarget).closest(".fusion-page-layout").find(".fusion_module_title").text();jQuery("#fusion-builder-columns-studio").find(".fusion-loader").hide(),jQuery("#fusion-builder-columns-studio").find(".studio-wrapper").removeClass("loading"),FusionPageBuilderApp.loaded=!0,fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_studio_column+i,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned"),this.model.unset("added")},loadStudioContainer:function(e){var i,t,n=this,o=this.model.get("parent"),a=FusionPageBuilderViewManager.getView(o),s=jQuery(e.currentTarget).closest(".fusion-page-layout"),r=FusionPageBuilderApp.studio.getImportOptions(e);t=a.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=t.find(".fusion-builder-data-cid").data("cid"),e&&e.preventDefault(),void 0!==a&&a.removeContainer(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,i=s.data("layout-id"),jQuery.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"JSON",data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:!1,fusion_layout_id:i,overWriteType:r.overWriteType,shouldInvert:r.shouldInvert,imagesImport:r.imagesImport,fusion_studio:!0,category:"sections",post_id:fusionBuilderConfig.post_id},beforeSend:function(){jQuery("#fusion-builder-sections-studio").find(".fusion-loader").show(),jQuery("#fusion-builder-sections-studio").find(".studio-wrapper").addClass("loading"),jQuery(".fusion-loader .awb-studio-import-status").html(fusionBuilderText.studio_importing_content)},success:function(i){var t,o=[],a=jQuery.Deferred(),s=a;if(a.resolve(),n.mediaImportKeys=[],"object"==typeof i.avada_media&&Object.keys(i.avada_media).forEach(function(e){"object"!=typeof i.avada_media[e]||Array.isArray(i.avada_media[e])||n.mediaImportKeys.push(e)}),0<n.mediaImportKeys.length){for(FusionPageBuilderApp.studio.setImportData(i),t=0;t<n.mediaImportKeys.length;t++)!function(e){s=s.then(function(){return n.importStudioMedia(FusionPageBuilderApp.studio.getImportData(),n.mediaImportKeys[e],r)}),o.push(s)}(t);jQuery.when.apply(null,o).then(function(){FusionPageBuilderApp.shortcodesToBuilder(FusionPageBuilderApp.studio.getImportData().post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,FusionPageBuilderEvents.trigger("fusion-studio-content-imported",FusionPageBuilderApp.studio.getImportData()),n.studioContainerImportComplete(e),FusionPageBuilderApp.studio.resetImportData()},function(){jQuery(".fusion-loader .awb-studio-import-status").html(fusionBuilderText.studio_importing_content_failed),n.studioContainerImportComplete(e),FusionPageBuilderApp.studio.resetImportData()})}else FusionPageBuilderApp.shortcodesToBuilder(i.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,FusionPageBuilderEvents.trigger("fusion-studio-content-imported",i),n.studioContainerImportComplete(e)}}))},studioContainerImportComplete:function(e){var i=jQuery(e.currentTarget).closest(".fusion-page-layout").find(".fusion_module_title").text();jQuery("#fusion-builder-sections-studio").find(".fusion-loader").hide(),jQuery("#fusion-builder-sections-studio").find(".studio-wrapper").removeClass("loading"),FusionPageBuilderApp.loaded=!0,fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_studio_section+i,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned"),this.model.unset("added")},addCustomColumn:function(i){var t,n,o,a;i&&i.preventDefault(),FusionPageBuilderApp.activeModal="column",!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,t=this.model,n=e(i.currentTarget).data("layout_id"),a=e(i.currentTarget).find(".fusion_module_title").text(),o=e(i.currentTarget).closest("li").hasClass("fusion-global"),e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:o,fusion_layout_id:n}}).done(function(t){var n=JSON.parse(t);FusionPageBuilderApp.shortcodesToBuilder(n.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide(),setTimeout(FusionPageBuilderApp.checkGlobalParents,500,FusionPageBuilderApp.parentRowId)}).always(function(){t.unset("added"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_column+a,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}))},addColumns:function(i){var t,n,o,a,s;i&&i.preventDefault(),FusionPageBuilderApp.activeModal="column",t=this,n=(e(i.target).is("li")?e(i.target):e(i.target).closest("li")).data("layout").split(","),_.size(n),o=this.options.view,a=fusionAllElements.fusion_builder_column.params,_.each(n,function(e,i){var n,r={};_.each(a,function(e){s=_.isObject(e.value)?e.default:e.value,r[e.param_name]=s}),n={type:"fusion_builder_column",element_type:"fusion_builder_column",cid:FusionPageBuilderViewManager.generateCid(),parent:t.model.get("cid"),layout:e,view:o,params:r},t.collection.add([n])}),this.model.unset("added"),FusionPageBuilderEvents.trigger("fusion-columns-added"),i&&(fusionHistoryManager.turnOnTracking(),!0===FusionPageBuilderApp.newContainerAdded?(window.fusionHistoryState=fusionBuilderText.added_section,FusionPageBuilderApp.newContainerAdded=!1):window.fusionHistoryState=fusionBuilderText.added_columns,FusionPageBuilderEvents.trigger("fusion-element-added"))},addCustomSection:function(i){var t,n,o,a,s=this.model,r=this.model.get("parent"),u=FusionPageBuilderViewManager.getView(r);a=u.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=a.find(".fusion-builder-data-cid").data("cid"),i&&i.preventDefault(),void 0!==u&&u.removeContainer(),!0!==FusionPageBuilderApp.layoutIsLoading&&(FusionPageBuilderApp.layoutIsLoading=!0,t=e(i.currentTarget).data("layout_id"),o=e(i.currentTarget).find(".fusion_module_title").text(),n=e(i.currentTarget).closest("li").hasClass("fusion-global"),e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","0"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").show(),e.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_is_global:n,fusion_layout_id:t}}).done(function(t){var n=JSON.parse(t);FusionPageBuilderApp.shortcodesToBuilder(n.post_content,FusionPageBuilderApp.parentRowId),FusionPageBuilderApp.layoutIsLoading=!1,e(i.currentTarget).parent(".fusion-builder-all-modules").css("opacity","1"),e(i.currentTarget).parent(".fusion-builder-all-modules").prev("#fusion-loader").hide()}).always(function(){s.unset("added"),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_custom_section+o,FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}))},addSpecialItem:function(e){var i,t,n=this.model.get("parent"),o=FusionPageBuilderViewManager.getView(n);e&&e.preventDefault(),i=o.$el.prev(".fusion_builder_container"),FusionPageBuilderApp.targetContainerCID=i.find(".fusion-builder-data-cid").data("cid"),t=FusionPageBuilderViewManager.generateCid(),this.collection.add([{type:jQuery(e.currentTarget).data("type"),added:"manually",module_type:jQuery(e.currentTarget).data("type"),cid:t,params:{},view:o,appendAfter:i,created:"auto"}]),void 0!==o&&(FusionPageBuilderApp.targetContainerCID="",o.removeContainer()),fusionHistoryManager.turnOnTracking(),window.fusionHistoryState=fusionBuilderText.added_special_item+jQuery(e.currentTarget).find(".fusion_module_title").text(),FusionPageBuilderEvents.trigger("fusion-columns-added"),FusionPageBuilderEvents.trigger("fusion-element-cloned")}})})}(jQuery);FusionPageBuilder=FusionPageBuilder||{};jQuery,jQuery(document).ready(function(){FusionPageBuilder.DynamicSelection=window.wp.Backbone.View.extend({template:FusionPageBuilder.template(jQuery("#fusion-builder-dynamic-selection").html()),className:"fusion-builder-dynamic-selection option-field",events:{},render:function(){var e,i=this.model.get("option");return i.length&&i.attr("data-dynamic-selection",!0),e={params:FusionPageBuilderApp.dynamicValues.getOrderedParams(),option:i.attr("data-option-type")},this.$el.html(this.template(e)),this.initSelect(),this},initSelect:function(){var e=this,i=this.model.get("parent"),t=this.model.get("option"),n=this.model.get("param"),o=this.$el.find(".fusion-select-field");o.hasClass("fusion-select-inited")||(o.find("optgroup").each(function(){0===jQuery(this).find("option").length&&jQuery(this).remove()}),o.select2({placeholder:fusionBuilderText.select_dynamic_content}),o.on("change.select2",function(a){o.select2("close"),i.dynamicParams.addParam(n,jQuery(a.target).val()),i.initEditDynamic(t.find(".fusion-dynamic-content"),!0),e.removeView()}))},removeView:function(){var e=this.model.get("option"),i=this.model.get("parent");this.$el.remove(),i&&(i.dynamicSelection=!1),e.length&&e.attr("data-dynamic-selection",!1),this.model.destroy(),this.remove()}})}),(FusionPageBuilder=FusionPageBuilder||{}).options=FusionPageBuilder.options||{},FusionPageBuilder.options.fusionDynamicData={optionDynamicData:function(e){var i=this;(e=e||this.$el).find('[data-dynamic="true"] .fusion-dynamic-content').each(function(){i.initEditDynamic(jQuery(this))})},initEditDynamic:function(e,i){var t=this.dynamicParams.getAll(),n=this,o=FusionPageBuilder.template(jQuery("#fusion-app-repeater-fields").html()),a=e.closest(".fusion-builder-option").attr("data-option-id"),s=FusionPageBuilderApp.dynamicValues.getOptions(),r="object"==typeof t&&"object"==typeof t[a]?t[a]:{data:void 0},u=!(!r||"object"!=typeof s[r.data])&&s[r.data],l=!!u&&u.fields,d=u&&"string"==typeof u.label?u.label:r.data,c="",f=e.find(".dynamic-param-fields"),p=jQuery.extend(!0,{},fusionDynamicData.commonDynamicFields),m="object"==typeof u.exclude&&_.values(u.exclude);"object"==typeof t[a]&&(m&&"object"==typeof p&&_.each(p,function(e,i){-1!==_.indexOf(m,i)&&delete p[i]}),"object"!=typeof p||_.isEmpty(p)||(l="object"==typeof l?_.extend(l,p):p),f.empty(),l&&(_.each(l,function(e,i){var t=r[i];c+=jQuery(o({field:e,value:t})).html()}),f.append(c)),u&&(e.find(".dynamic-title h3").text(d),e.find(".dynamic-wrapper").attr("data-id",r.data)),e.off("click"),e.on("click",".dynamic-title",function(){jQuery(this).parent().find(".dynamic-param-fields").slideToggle(300),jQuery(this).find(".dynamic-toggle-icon").hasClass("fusiona-pen")?jQuery(this).find(".dynamic-toggle-icon").removeClass("fusiona-pen").addClass("fusiona-minus"):jQuery(this).find(".dynamic-toggle-icon").removeClass("fusiona-minus").addClass("fusiona-pen")}),e.on("click",".dynamic-remove.fusiona-trash-o",function(i){i.preventDefault(),n.removeDynamicData(e)}),"function"==typeof this.optionInit&&this.optionInit(e),void 0!==i&&i&&(e.find(".dynamic-param-fields").show(),e.find(".dynamic-toggle-icon").removeClass("fusiona-pen").addClass("fusiona-minus")))},removeDynamicData:function(e){var i=e.closest(".fusion-builder-option").attr("data-option-id");void 0!==this.dynamicParams&&this.dynamicParams.removeParam(i)},setDynamicParamValue:function(e,i,t){var n=e.parent().closest(".fusion-builder-option").attr("data-option-id");void 0!==this.dynamicParams&&this.dynamicParams.updateParam(n,i,t)}};FusionPageBuilder=FusionPageBuilder||{};var FusionPageBuilderEvents=_.extend({},Backbone.Events);function openShortcodeGenerator(e){var i,t="#"+e.parent().parent().find(".wp-editor-area").attr("id");window.cursorPosition=0,window.editorArea=t,FusionPageBuilderApp.shortcodeGenerator=!0,FusionPageBuilderApp.isTinyMceActive()?window.SCmoduleContentEditorMode="tinymce":window.SCmoduleContentEditorMode="html","tinymce"!==window.SCmoduleContentEditorMode&&(window.cursorPosition=jQuery(t).getCursorPosition()),i=new FusionPageBuilder.ModalView({model:this.model,collection:FusionPageBuilderElements,attributes:{"data-modal_view":"all_elements_generator"},view:this}),jQuery("body").append(i.render().el)}!function(e){var i,t;e.fn.outerHTML=function(){return this.length?this[0].outerHTML||(e=this[0],(t=document.createElement("div")).appendChild(e.cloneNode(!0)),i=t.innerHTML,t=null,i):this;var e,i,t},window.fusionBuilderGetContent=function(i,t,n){var o;if(void 0===t&&(t=!1),void 0===n&&(n=!1),n||void 0===window.tinyMCE||!window.tinyMCE.get(i)||window.tinyMCE.get(i).isHidden()?e("#"+i).length&&(o=e("#"+i).val().replace(/\r?\n/g,"\r\n")):o=window.tinyMCE.get(i).getContent(),t&&void 0!==window.tinyMCE&&void 0!==o&&(o=(o=o.replace(/<p>\[/g,"[")).replace(/\]<\/p>/g,"]")),void 0!==o)return o.trim()},t=0,i=function(e,i){clearTimeout(t),t=setTimeout(e,i)},e(window).on("load",function(){e("#fusion_toggle_builder").data("enabled")&&e("#fusion_toggle_builder").trigger("click")}),e("#publishing-action #publish").on("click",function(){FusionPageBuilderApp.saveGlobal=!1}),e(window).on("beforeunload",function(){var i="undefined"!=typeof tinymce&&tinymce.get("content");if((i&&!i.isHidden()&&i.isDirty()||wp.autosave&&wp.autosave.server.postChanged())&&!0===FusionPageBuilderApp.saveGlobal&&!e("#publish").hasClass("disable"))return FusionPageBuilderApp.saveGlobal=!1,""}),e(document).ready(function(){var t,n,o,a,s;function r(){var e=document.getElementById("fusion_builder_controls"),i=jQuery("#wpadminbar").length?jQuery("#wpadminbar").height():0;fusionBuilderStickyHeader(e,i)}function u(){FusionPageBuilderElements.reset(),FusionPageBuilderViewManager.set("elementCount",0),FusionPageBuilderViewManager.set("views",{}),e("#fusion_builder_container").html(""),FusionPageBuilderApp.shortcodeGenerator=!1}function l(){var i=fusionBuilderConfig.fontawesomeicons,t='<div class="fusion-icons-rendered" style="position:relative; height:0px; overflow:hidden;">',n={fas:"",fab:"",far:"",fal:""},o={fas:"Solid",far:"Regular",fal:"Light",fab:"Brands"},a='<div class="fusion-icon-picker-nav-rendered" style="height:0px; overflow:hidden;">',s="undefined"!=typeof fusionIconSearch&&Array.isArray(fusionIconSearch);_.each(i,function(e,i){_.each(e[1],function(t){-1!==fusionBuilderConfig.fontawesomesubsets.indexOf(t)&&(n[t]+='<span class="icon_preview '+i+'" title="'+i+" - "+o[t]+'"><i class="'+e[0]+" "+t+'" data-name="'+e[0].substr(3)+'" aria-hidden="true"></i></span>')})}),_.each(o,function(e,i){-1!==fusionBuilderConfig.fontawesomesubsets.indexOf(i)&&(a+='<a href="#fusion-'+i+'">'+e+"</a>",t+='<div id="fusion-'+i+'" class="fusion-icon-set">'+n[i]+"</div>")}),i=fusionBuilderConfig.customIcons,_.each(i,function(e,i){a+='<a href="#'+i+'">'+e.name+"</a>",t+='<div id="'+i+'" class="fusion-icon-set fusion-custom-icon-set">',_.each(e.icons,function(i){s&&fusionIconSearch.push({name:i}),t+='<span class="icon_preview '+i+'" title="'+e.css_prefix+i+'"><i class="'+e.css_prefix+i+'" data-name="'+i+'" aria-hidden="true"></i></span>'}),t+="</div>"}),a+="</div>",t+="</div>",e("body").append(t+a)}e(document).click(function(i){e(i.target).parents(".column-sizes").length||e(i.target).hasClass("fusion-builder-resize-column")||e(".column-sizes").hide()}),FusionPageBuilder.AppView=window.wp.Backbone.View.extend({mediaImportKeys:[],el:e("#fusion_builder_main_container"),template:FusionPageBuilder.template(e("#fusion-builder-app-template").html()),events:{"click .fusion-builder-layout-button-save":"saveLayout","click .fusion-builder-layout-button-load":"loadLayout","click .fusion-builder-layout-button-delete":"deleteLayout","click .fusion-builder-layout-buttons-clear":"clearLayout","click .fusion-builder-demo-button-load":"loadDemoPage","click .fusion-builder-layout-custom-css":"customCSS","click .fusion-builder-template-buttons-save":"saveTemplateDialog","click #fusion-builder-layouts .fusion-builder-modal-close":"hideLibrary","click .fusion-builder-library-dialog":"openLibrary","mouseenter .fusion-builder-layout-buttons-history":"showHistoryDialog","mouseleave .fusion-builder-layout-buttons-history":"hideHistoryDialog","click .fusion-builder-element-button-save":"saveElement","click #fusion-load-template-dialog":"loadPreBuiltPage","click #fusion-load-studio-dialog":"loadSutdioPage","click .fusion-builder-layout-buttons-toggle-containers":"toggleAllContainers","click .fusion-builder-global-tooltip":"unglobalize","click .fusion-builder-publish-tooltip":"publish","click .awb-import-options-toggle":"toggleImportOptions","click .awb-import-studio-item":"loadStudioLayout",contextmenu:"contextMenu"},initialize:function(){this.builderActive=!1,this.pauseBuilder=!1,this.ajaxurl=fusionBuilderConfig.ajaxurl,this.fusion_load_nonce=fusionBuilderConfig.fusion_load_nonce,this.fusion_builder_plugin_dir=fusionBuilderConfig.fusion_builder_plugin_dir,this.layoutIsLoading=!1,this.layoutIsSaving=!1,this.saveGlobal=!1,this.layoutIsDeleting=!1,this.parentRowId="",this.parentColumnId="",this.targetContainerCID="",this.activeModal="",this.innerColumn="",this.blankPage="",this.newLayoutLoaded=!1,this.newContainerAdded=!1,this.fullWidth=fusionBuilderConfig.full_width,this.allContent="",this.shortcodeGenerator="",this.shortcodeGeneratorMultiElement="",this.shortcodeGeneratorMultiElementChild="",this.allowShortcodeGenerator="",this.shortcodeGeneratorActiveEditor="",this.shortcodeGeneratorEditorID="",this.manuallyAdded=!1,this.manualGenerator=!1,this.manualEditor="",this.fromExcerpt=!1,this.disable_encoding=fusionBuilderConfig.disable_encoding,this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.codeEditor="",this.MultiElementChildSettings=!1,this.listenTo(this.collection,"add",this.addBuilderElement),this.listenTo(FusionPageBuilderEvents,"fusion-element-added",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-removed",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-cloned",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-edited",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-sorted",this.builderToShortcodes),this.listenTo(FusionPageBuilderEvents,"fusion-element-added",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-cloned",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-edited",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-element-sorted",this.syncGlobalLayouts),this.listenTo(FusionPageBuilderEvents,"fusion-show-loader",this.showLoader),this.listenTo(FusionPageBuilderEvents,"fusion-hide-loader",this.hideLoader),this.listenTo(FusionPageBuilderEvents,"fusion-hide-library",this.hideLibrary),this.listenTo(FusionPageBuilderEvents,"fusion-save-layout",this.saveLayout),this.listenTo(FusionPageBuilderEvents,"fusion-save-history-state",this.saveHistoryState),this.toggledContainers=!0,this.render(),jQuery("body").hasClass("gutenberg-editor-page")||(e("#fusion_toggle_builder").hasClass("fusion_builder_is_active")&&this.initialBuilderLayout(!0),fusionHistoryManager.turnOnTracking(),fusionHistoryManager.captureEditor(),fusionHistoryManager.turnOffTracking()),this.contextMenuView=!1,this.clipboard={},this.dynamicValues=new FusionPageBuilder.DynamicValues,"object"==typeof fusionDynamicData&&this.dynamicValues.addData(null,fusionDynamicData.dynamicOptions),this.studio=new FusionPageBuilder.Studio,this.website=new FusionPageBuilder.Website,this.simplifiedMap=[],this.mediaMap={images:{},menus:{},forms:{},post_cards:{},videos:{},icons:{},off_canvases:{}},jQuery("#pyre_fusion_form").length&&this.createSettingsToParams()},render:function(){return this.$el.html(this.template()),this.sortableContainers(),this},createSettingsToParams:function(){var e=this;_.each(fusionAllElements,function(i,t){_.isUndefined(i.settings_to_params)||_.each(i.settings_to_params,function(i,n){i=_.isObject(i)&&!_.isUndefined(i.param)?i.param:i,jQuery('[name="_fusion['+n+']"]').length&&jQuery('[name="_fusion['+n+']"]').on("change fusion-changed",function(){var n=jQuery(this).val()&&""!==jQuery(this).val()?jQuery(this).val():jQuery(this).closest(".pyre_metabox_field").find("[data-default]").attr("data-default");e.defaultChanged(t,i,n)})})})},defaultChanged:function(e,i,t){var n=fusionAllElements[e].params[i].default;"object"==typeof fusionAllElements[e]&&(fusionAllElements[e].params[i].default=t,"string"==typeof fusionAllElements[e].params[i].description&&(fusionAllElements[e].params[i].description=fusionAllElements[e].params[i].description.replace(">"+n,">"+t)))},unglobalize:function(e){var i=jQuery(e.currentTarget).data("cid"),t=FusionPageBuilderViewManager.getView(i),n=t.model.get("params"),o=t.model.get("element_type");if(!1===confirm(fusionBuilderText.are_you_sure_you_want_to_remove_global))return!1;delete n.fusion_global,t.model.set("params",n),t.$el.removeClass("fusion-global-element fusion-global-container fusion-global-column"),jQuery(e.currentTarget).remove(),t.$el.removeAttr("fusion-global-layout"),"fusion_builder_container"===o&&t.$el.find(".fusion-builder-container-content > .fusion-builder-section-content").removeAttr("fusion-global-layout"),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.removed_global,FusionPageBuilderEvents.trigger("fusion-element-edited")},publish:function(e){var i=jQuery(e.currentTarget).data("cid"),t=FusionPageBuilderViewManager.getView(i),n=t.model.get("params");if(!1===confirm(fusionBuilderText.are_you_sure_you_want_to_publish))return!1;n.status="published",t.model.set("params",n),t.updateStatusIcons(),fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.container_published,FusionPageBuilderEvents.trigger("fusion-element-edited")},isTinyMceActive:function(){return"undefined"!=typeof tinyMCE&&tinyMCE.activeEditor&&!tinyMCE.activeEditor.isHidden()},base64Encode:function(e){var i,t,n,o,a,s,r=this._keyStr,u=0,l=0,d="",c=[];if(!e)return e;e=unescape(encodeURIComponent(e));do{i=(a=e.charCodeAt(u++)<<16|e.charCodeAt(u++)<<8|e.charCodeAt(u++))>>18&63,t=a>>12&63,n=a>>6&63,o=63&a,c[l++]=r.charAt(i)+r.charAt(t)+r.charAt(n)+r.charAt(o)}while(u<e.length);return d=c.join(""),((s=e.length%3)?d.slice(0,s-3):d)+"===".slice(s||3)},base64Decode:function(e){var i,t,n,o,a,s,r="",u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<e.length;)i=this._keyStr.indexOf(e.charAt(u++))<<2|(o=this._keyStr.indexOf(e.charAt(u++)))>>4,t=(15&o)<<4|(a=this._keyStr.indexOf(e.charAt(u++)))>>2,n=(3&a)<<6|(s=this._keyStr.indexOf(e.charAt(u++))),r+=String.fromCharCode(i),64!==a&&(r+=String.fromCharCode(t)),64!==s&&(r+=String.fromCharCode(n));return r=this.utf8Decode(r)},utf8Decode:function(e){for(var i,t="",n=0,o=0,a=0;n<e.length;)128>(o=e.charCodeAt(n))?(t+=String.fromCharCode(o),n++):191<o&&224>o?(a=e.charCodeAt(n+1),t+=String.fromCharCode((31&o)<<6|63&a),n+=2):(a=e.charCodeAt(n+1),i=e.charCodeAt(n+2),t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&i),n+=3);return t},fusionBuilderMCEremoveEditor:function(e){void 0!==window.tinyMCE&&(window.tinyMCE.execCommand("mceRemoveEditor",!1,e),void 0!==window.tinyMCE.get(e)&&window.tinyMCE.remove("#"+e))},fusion_builder_sortable:function(e){e.find(".fusion-sortable-options").each(function(){jQuery(this).sortable(),jQuery(this).on("sortupdate",function(e){var i=jQuery(e.target),t="";i.children(".fusion-sortable-option").each(function(){t+=jQuery(this).data("value")+","}),t=t.slice(0,-1),i.siblings(".sort-order").val(t).trigger("change")})})},fusion_builder_connected_sortable:function(e){e.find(".fusion-connected-sortable").sortable({connectWith:".fusion-connected-sortable",stop:function(){var i=e.find(".fusion-connected-sortable-enabled"),t=e.find(".fusion-builder-option-container"),n="";i.children(".fusion-connected-sortable-option").each(function(){n+=jQuery(this).data("value")+","}),t.find(".fusion-connected-sortable").each(function(){jQuery(this).find("li").length?jQuery(this).removeClass("empty"):jQuery(this).addClass("empty")}),n=n.slice(0,-1),t.find(".sort-order").val(n).trigger("change")}}).disableSelection()},fusion_builder_sortable_text:function(e){e.find(".fusion-sortable-text-options").each(function(){var e=jQuery(this);e.sortable({handle:".fusion-sortable-move"}),e.on("sortupdate",function(e){var i=jQuery(e.target),t="";i.children(".fusion-sortable-option").each(function(){t+=jQuery(this).find("input").val()+"|"}),t=t.slice(0,-1),i.siblings(".sort-order").val(t).trigger("change")}),e.on("click",".fusion-sortable-remove",function(i){i.preventDefault(),jQuery(i.target).closest(".fusion-sortable-option").remove(),e.trigger("sortupdate")}),e.on("change keyup","input",function(){e.trigger("sortupdate")}),e.prev(".fusion-builder-add-sortable-child").on("click",function(i){var t=e.next(".fusion-placeholder-example").clone(!0);i.preventDefault(),t.removeClass("fusion-placeholder-example").removeAttr("style").appendTo(e),setTimeout(function(){e.find(".fusion-sortable-option:last-child input").focus()},100),e.trigger("sortupdate")})})},fusion_builder_form_options:function(e){var i,t=e.find("#form-options-settings"),n=e.find(".options-grid"),o=e.find(".fusion-builder-add-sortable-child"),a=n.find(".fusion-form-options"),s=jQuery('<li class="fusion-form-option">'+e.find(".fusion-form-option-template").html()+"</li>"),r=n.find(".option-values"),u=e.find(".bulk-add-modal"),l="yes"===n.data("multiple");i=function(){var e=[];a.children("li").each(function(){var i=[],t=jQuery(this).find(".fusiona-check_circle").length;i.push(t?1:0),jQuery(this).find("input").each(function(){i.push(this.value)}),e.push(i)}),r.val(FusionPageBuilderApp.base64Encode(JSON.stringify(e)))},a.sortable({handle:".fusion-sortable-move"}),a.on("sortupdate",function(){i()}),a.on("change keyup","input",function(e){e.preventDefault(),i()}),t.on("click",function(e){n.toggleClass("show-values")}),a.on("click",".fusion-sortable-remove",function(e){e.preventDefault(),jQuery(e.target).closest(".fusion-form-option").remove(),i()}),a.on("click",".fusion-sortable-check",function(e){var t=jQuery(this).find(".fusiona-check_circle_outline"),n=t.hasClass("fusiona-check_circle");e.preventDefault(),l||a.find(".fusion-sortable-check .fusiona-check_circle").removeClass("fusiona-check_circle"),n?t.removeClass("fusiona-check_circle"):t.addClass("fusiona-check_circle"),i()}),o.on("click",function(e){var i=s.clone(!0);e.preventDefault(),a.append(i),setTimeout(function(){i.find(".form-option-label input").focus()},100)}),u.on("click",function(e){var o;e.preventDefault(),jQuery(".fusion-builder-settings-bulk-dialog").length||(o=new FusionPageBuilder.BulkAddView({choices:fusionBuilderConfig.predefined_choices}),jQuery(o.render().el).dialog({title:"Bulk Add / Predefined Choices",dialogClass:"fusion-builder-settings-bulk-dialog",resizable:!1,width:500,draggable:!1,buttons:[{text:"Cancel",click:function(){jQuery(this).dialog("close")}},{text:"Insert Choices",click:function(){var r,u=o.getChoices();e.preventDefault(),_.each(u,function(e){r=s.clone(!0),e.includes("|")?(e=e.split("|"),r.find("input.label").val(e[0]),r.find("input.value").val(e[1]),t.prop("checked",!0),n.addClass("show-values")):r.find("input.label").val(e),a.append(r)}),i(),jQuery(this).dialog("close")},class:"ui-button-blue"}],open:function(){jQuery(".fusion-builder-modal-settings-container").css("z-index",9998)},beforeClose:function(){jQuery(".fusion-builder-modal-settings-container").css("z-index",99999),jQuery(this).remove()}}))})},fusion_builder_logics:function(e){var i,t=e.find(".options-grid"),n=e.find(".fusion-builder-add-sortable-child"),o=t.find(".fusion-logics"),a=jQuery('<li class="fusion-logic">'+e.find(".fusion-logic-template").html()+"</li>"),s=t.find(".logic-values");i=function(){var e=[];o.children("li").each(function(){var i={},t=jQuery(this).find(".fusion-sortable-operator");jQuery(this);i.operator=t.hasClass("and")?"and":"or",i.comparison=jQuery(this).find(".logic-comparison-selection").val(),i.field=jQuery(this).find("select.fusion-logic-choices").val(),i.value=jQuery(this).find(".fusion-logic-option").val(),jQuery(this).find(".logic-additionals").length&&(i.additionals=jQuery(this).find(".fusion-logic-additionals-field").val()),e.push(i)}),s.val(FusionPageBuilderApp.base64Encode(JSON.stringify(e))).trigger("change")},o.sortable({items:".fusion-logic",tolerance:"pointer",cursor:"move",connectWith:".fusion-logics",handle:".fusion-logic-controller-head",axis:"y"}),o.on("sortupdate",function(){i()}),o.on("change keyup","input",function(e){e.preventDefault(),i()}),o.on("change","select.fusion-logic-option",function(e){e.preventDefault(),i()}),o.on("change","select.fusion-logic-choices",function(e){var t,n=o.closest(".fusion-builder-option-logics").find(".fusion-logics-all-choices").text(),a=jQuery(this).val(),s=jQuery(this).closest("select").find("option:selected").text(),r=jQuery(this).closest(".fusion-logic"),u="",l="";e.preventDefault();try{n=JSON.parse(n)}catch(e){n=[]}if(r.find("h4.logic-title").text(s),"object"==typeof(t=n.find(({id:e})=>e===a))){switch("object"==typeof t.comparisons&&jQuery.each(t.comparisons,function(e,i){u+='<option value="'+e+'" '+("equal"===e?"active":"")+">"+i+"</select>"}),r.find(".logic-comparison-selection").empty().append(u),t.type){case"select":"object"==typeof t.options&&(l+='<div class="select_arrow"></div>',l+='<select class="fusion-dont-update fusion-logic-option fusion-hide-from-atts fusion-select-field">',jQuery.each(t.options,function(e,i){l+='<option value="'+e+'">'+i+"</option>"}),l+="</select>"),r.find(".logic-value-field").html(l),r.find(".logic-value .fusion-select-field").select2();break;case"text":l='<input type="text" value="" placeholder="'+fusionBuilderText.condition_value+'" class="fusion-hide-from-atts fusion-logic-option" />',r.find(".logic-value-field").html(l)}if(r.find(".logic-additionals").remove(),void 0!==t.additionals)switch(t.additionals.type){case"select":"object"==typeof t.additionals.options&&(l='<div class="logic-additionals">',l+='<div class="select_arrow"></div>',l+='<select class="fusion-dont-update fusion-logic-additionals-field fusion-hide-from-atts fusion-select-field">',jQuery.each(t.additionals,function(e,i){l+='<option value="'+e+'">'+i+"</option>"}),l+="</select>",l+="</div>"),r.find(".logic-field").append(l),r.find(".logic-field .fusion-select-field").select2();break;case"text":l='<div class="logic-additionals">',l+='<input type="text" value="" placeholder="'+t.additionals.placeholder+'" class="fusion-hide-from-atts fusion-logic-additionals-field" />',l+="</div>",r.find(".logic-field").append(l)}}i()}),o.on("click",".fusion-sortable-remove",function(e){e.preventDefault(),jQuery(e.target).closest(".fusion-logic").remove(),i()}),o.on("click",".fusion-sortable-edit, h4.logic-title",function(e){var i=jQuery(this).closest(".fusion-logic");e.preventDefault(),i.find(".fusion-logic-controller-content").slideToggle("fast")}),o.on("click",".logic-operator",function(){var e=jQuery(this).find(".fusion-sortable-operator");e.hasClass("and")?(e.removeClass("and").addClass("or"),e.closest(".fusion-logic").addClass("has-or").attr("aria-label-or",fusionBuilderText.logic_separator_text)):(e.removeClass("or").addClass("and"),e.closest(".fusion-logic").removeClass("has-or")),i()}),o.on("change",".logic-comparison-selection",function(){event.preventDefault(),i()}),n.on("click",function(e){var t=a.clone(!0);e.preventDefault(),o.find(".fusion-logic-controller-content").hide(),o.append(t),t.find(".logic-field .fusion-select-field").select2(),t.find("select.fusion-logic-choices").trigger("change"),i()})},fusion_builder_iconpicker:function(e,t,n,o){var a=jQuery(".fusion-icons-rendered").length?jQuery(".fusion-icons-rendered").html():"",s=jQuery(".fusion-icon-picker-nav-rendered").length?jQuery(".fusion-icon-picker-nav-rendered").html():"",r="",u=jQuery(n),l=u.parent(),d="",c="";""!==e&&("fusion-prefix-"===e.substr(0,14)?e=e.replace("fusion-prefix-",""):void 0===(e=e.split(" "))[1]&&(e[1]="fas",void 0!==window["fusion-fontawesome-free-shims"]&&(r=e[0].substr(3),jQuery.each(window["fusion-fontawesome-free-shims"],function(i,t){if(t[0]===r)return null!==t[2]&&(e[0]="fa-"+t[2]),null!==t[1]&&(e[1]=t[1]),!1})),l.find(".fusion-iconpicker-input").attr("value",e[0]+" "+e[1]))),u.html(a).before('<div class="fusion-icon-picker-nav">'+s+"</div>"),l.find(".fusion-icon-picker-nav > a").on("click",function(e){e.preventDefault(),jQuery(".fusion-icon-picker-nav-active").removeClass("fusion-icon-picker-nav-active"),jQuery(this).addClass("fusion-icon-picker-nav-active"),u.find(".fusion-icon-set").css("display","none"),u.find(jQuery(this).attr("href")).css("display","grid")}),""!==e&&(d="."+(Array.isArray(e)?e.join("."):e),u.find(d).parent().addClass("selected-element").css("display","flex"),c=u.find(".selected-element").closest(".fusion-icon-set").prepend(u.find(".selected-element")).attr("id"),l.find('.fusion-icon-picker-nav a[href="#'+c+'"]').trigger("click")),jQuery(o).on("change paste keyup",function(){var e=jQuery(this);i(function(){var i,t;if(e.val()){if(3>(t=e.val().toLowerCase()).length)return;u.find(".fusion-icon-set .icon_preview").css("display","none"),i=new Fuse(fusionIconSearch,{threshold:.2,location:0,distance:100,maxPatternLength:32,minMatchCharLength:3,keys:["name","keywords","categories"]}).search(t),_.each(i,function(e){u.find(".icon_preview."+e.name).css("display","flex")}),_.each(u.find(".fusion-icon-set"),function(e){var i=!1;e.classList.add("no-search-results"),jQuery(".icon_preview").each(function(t,n){"none"!==n.style.display&&e.classList.contains("no-search-results")&&(i=!0)}),i||e.querySelector(".no-search-results-notice")?i&&e.classList.remove("no-search-results"):jQuery(e).append('<div class="no-search-results-notice">'+fusionBuilderText.no_results_in.replace("%s",jQuery('a[href="#'+e.id+'"]').html())+"</div>")})}else u.find(".fusion-icon-set .icon_preview").css("display","flex"),_.each(u.find(".fusion-icon-set"),function(e){e.classList.remove("no-search-results")})},100)})},contextMenu:function(e){var i,t,n,o=this,a=jQuery(e.target),s=a.closest("[data-cid]:not(.fusion-builder-row-content)"),r="default";if(!a.hasClass("fusion_builder_blank_page")&&!a.closest(".fusion_builder_blank_page").length){if(a.data("cid")&&(s=a),a.hasClass("fusion-builder-section-header")||a.closest(".fusion-builder-section-header").length){if(a.hasClass("fusion-builder-section-name"))return;s=a.closest(".fusion_builder_container").find(".fusion-builder-section-content").first()}if(this.removeContextMenu(),e.preventDefault(),t=FusionPageBuilderViewManager.getView(s.data("cid"))){if(n=this.getElementType(t.model.attributes.element_type),jQuery("body").hasClass("fusion-builder-library-edit")&&!a.closest(".fusion-builder-row-container-inner").length){if(jQuery("body").hasClass("fusion-element-post-type-sections")&&(r="container"),(jQuery("body").hasClass("fusion-element-post-type-columns")||jQuery("body").hasClass("fusion-element-post-type-post_cards"))&&(r="column","fusion_builder_container"===n))return;if(jQuery("body").hasClass("fusion-element-post-type-elements")&&(r="element","fusion_builder_container"===n||"fusion_builder_column"===n||"fusion_builder_column_inner"===n))return}t&&(i={model:{parent:t.model,event:e,parentView:t,pageType:r}},this.contextMenuView=new FusionPageBuilder.ContextMenuView(i),this.$el.append(this.contextMenuView.render().el),this.$el.one("click",function(){o.removeContextMenu()}))}}},removeContextMenu:function(){this.contextMenuView&&"function"==typeof this.contextMenuView.removeMenu&&this.contextMenuView.removeMenu()},getElementType:function(e){return"fusion_builder_container"===e||"fusion_builder_column"===e||"fusion_builder_column_inner"===e?e:e in fusionMultiElements?"parent_element":-1!==_.values(fusionMultiElements).indexOf(e)?"child_element":"fusion_builder_row_inner"===e&&FusionPageBuilderApp.pauseBuilder?"fusion_builder_row_inner":"element"},fusionBuilderImagePreview:function(e){var i,t,n=e.siblings(".fusion-builder-upload-field"),o=n.siblings(".fusion-builder-upload-preview"),a=e.siblings(".upload-image-remove"),s=n.val().trim();if(FusionPageBuilderEvents.trigger("awb-image-upload-url-"+e.data("param"),s),i=0<=s.indexOf("<img")?s:'<img src="'+s+'" />',"image"===e.data("type")&&!e.hasClass("hide-edit-buttons")){if(""===s)return o.length&&(o.remove(),a.remove(),e.val("Upload Image")),t=e.parents(".fusion-builder-option").next().find("#"+e.data("param")+"_id"),"element_content"===e.data("param")&&(t=e.parents(".fusion-builder-option").next().find("#image_id")),void(t.length&&t.val(""));o.length||(e.siblings(".preview").before('<div class="fusion-builder-upload-preview"><strong class="fusion-builder-upload-preview-title">Preview</strong><div class="fusion-builder-preview-image"><img src="" width="300" height="300" /></div></div>'),e.after('<input type="button" class="button upload-image-remove" value="Remove" />'),e.val("Edit"),o=n.siblings(".fusion-builder-upload-preview")),o.find("img").replaceWith(i)}},FusionBuilderActivateUpload:function(i){i.click(function(i){var t,n,o,a,s,r=!1,u=!1,l="",d="",c="",f=e(this).closest(".fusion_builder_module_settings").data("element_type"),p=e(this).closest(".fusion-builder-option").data("option-id");return i&&i.preventDefault(),"fusion-multiple-upload"===(t=e(this)).data("id")&&(r=!0),"fusion-multiple-images"===t.data("id")&&(u=!0,o=jQuery(t.next(".fusion-multiple-image-container"))[0],a=jQuery(t).prev(".fusion-multi-image-input")),n=wp.media({library:{type:t.data("type")},title:t.data("title"),multiple:!(!r&&!u)&&"between",frame:"post",className:"media-frame mode-select fusion-builder-media-dialog "+t.data("id"),displayUserSettings:!1,displaySettings:!0,allowLocalEdits:!0}),wp.media.frames.file_frame=n,u&&"fusion_gallery"===f&&(s=a.val(),d="string"==typeof s?s.split(","):"",[],"",wp.media._galleryDefaults.link="none",wp.media._galleryDefaults.size="thumbnail",n.options.syncSelection=!0,n.options.state=void 0!==s&&""!==s?"gallery-edit":"gallery"),n.on("open",function(){var i,o,a=n.state().get("selection"),s=n.state().get("library"),r=[];u?("fusion_gallery"===f&&"gallery-edit"===n.options.state||e(".fusion-builder-media-dialog").addClass("hide-menu"),jQuery.each(d,function(e,i){""!==i&&"NaN"!==i&&(void 0!==wp.media.attachment(i).get("url")?(a.add(wp.media.attachment(i)),s.add(wp.media.attachment(i))):r.push(i))}),0<r.length&&wp.media.query({post__in:r,posts_per_page:r.length}).more().then(function(){jQuery.each(d,function(e,i){""!==i&&"NaN"!==i&&(a.add(wp.media.attachment(i)),s.add(wp.media.attachment(i)))})})):(c=t.parents(".fusion-builder-option.upload").data("option-id"),void 0!==(o=void 0!==(o=t.parents(".fusion-builder-module-settings").find("#"+c+"_id").val())?o:t.parents(".fusion-builder-module-settings").find("#image_id").val())&&""!==o&&(o=o.split("|")[0]),i=wp.media.attachment(o),e(".fusion-builder-media-dialog").addClass("hide-menu"),o&&i.fetch({success:function(e){s.add(e?[e]:[]),a.add(e?[e]:[])}}))}),u&&"fusion_gallery"===f&&n.on("update",function(e){var i,t="";i=e.map(function(e){var i=e.id;return e.attributes.sizes&&void 0!==e.attributes.sizes.thumbnail?t=e.attributes.sizes.thumbnail.url:e.attributes.url&&(t=e.attributes.url),u&&(l+='<div class="fusion-multi-image" data-image-id="'+i+'">',l+='<img src="'+t+'"/>',l+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',l+="</div>"),e.id}),a.val(i),jQuery(o).html(l)}),n.on("select insert",function(){var e,i,s,d,c,m,g,h=n.state();void 0===h.get("selection")?e=jQuery(n.$el).find("#embed-url-field").val():(d=h.get("selection").map(function(e){return e.id}),u&&a.val(d),r&&(c=jQuery(t).parents(".fusion-builder-main-settings").find(".fusion-builder-sortable-options li:first-child")).length&&(!(m=FusionPageBuilderElements.find(function(e){return e.get("cid")===c.data("cid")}))||void 0!==m.attributes.params.image&&""!==m.attributes.params.image||jQuery(t).parents(".fusion-builder-main-settings").find(".fusion-builder-sortable-options li:first-child .fusion-builder-multi-setting-remove").trigger("click")),h.get("selection").map(function(n){var o,a,d,c=n.toJSON(),m=h.display(n).toJSON(),g={};i=c.id,s=m.size,c.sizes&&c.sizes[m.size]&&c.sizes[m.size].url?e=c.sizes[m.size].url:c.url&&(e=c.url),u&&(l+='<div class="fusion-multi-image" data-image-id="'+i+'">',l+='<img src="'+e+'"/>',l+='<span class="fusion-multi-image-remove dashicons dashicons-no-alt"></span>',l+="</div>"),r&&(o=fusionAllElements[f].element_child,a=fusionAllElements[f].params[p].child_params,d=void 0===fusionAllElements[f].params[p].create_children||fusionAllElements[f].params[p].create_children,_.each(a,function(e,i){g[i]=fusionAllElements[o].params[i].value}),_.each(a,function(e,i){fusionAllElements[o].params[i].value=n.attributes[e]}),"image"===p&&(fusionAllElements[f].params[p+"_id"].value=i+"|"+s),d&&(jQuery(t).parents(".fusion-builder-main-settings").find(".fusion-builder-add-multi-child").trigger("click"),FusionPageBuilderEvents.trigger("fusion-multi-child-update-preview")),_.each(g,function(e,i){fusionAllElements[o].params[i].value=e}))})),jQuery(o).html(l),r||u||(t.siblings(".fusion-builder-upload-field").val(e).trigger("change"),g=t.parents(".fusion-builder-option").next().find("#"+p+"_id"),"element_content"===p&&(g=t.parents(".fusion-builder-option").next().find("#image_id")),g.length&&g.val(i+"|"+s),FusionPageBuilderApp.fusionBuilderImagePreview(t))}),n.open(),!1}),i.siblings(".fusion-builder-upload-field").on("input",function(){FusionPageBuilderApp.fusionBuilderImagePreview(e(this).siblings(".fusion-builder-upload-button"))}),i.siblings(".fusion-builder-upload-field").each(function(){FusionPageBuilderApp.fusionBuilderImagePreview(e(this).siblings(".fusion-builder-upload-button"))}),jQuery("body").on("click",".fusion-multi-image-remove",function(){var e,i,t,n=jQuery(this).parents(".fusion-multiple-upload-images").find(".fusion-multi-image-input");i=jQuery(this).parent(".fusion-multi-image").data("image-id"),-1!==(t=(e=n.val().split(",").map(function(e){return parseInt(e,10)})).indexOf(i))&&e.splice(t,1),e=e.join(","),n.val(e),jQuery(this).parent(".fusion-multi-image").remove()})},fusionBuilderActivateLinkSelector:function(i){var t,n,o=jQuery("#wp-link-submit"),a=jQuery(".wp-link-text-field"),s=jQuery(".link-target"),r=jQuery('<input type="button" name="fusion-link-submit" id="fusion-link-submit" class="button-primary" value="Set Link">'),u=window.wpLink,l=window.wpLinkL10n;jQuery(i).click(function(i){r.insertBefore(o),t=jQuery(i.target).prev(".fusion-builder-link-field"),n=t.val(),o.hide(),a.hide(),s.hide(),r.show(),(u=!window.wpLink&&e.fn.wpdialog&&jQuery("#wp-link").length?{$link:!1,open:function(){this.$link=jQuery("#wp-link").wpdialog({title:l.title,width:480,height:"auto",modal:!0,dialogClass:"wp-dialog",zIndex:3e5})},close:function(){this.$link.wpdialog("close")}}:window.wpLink).fusionUpdateLink=function(e){i.preventDefault(),i.stopImmediatePropagation(),i.stopPropagation(),n=jQuery("#wp-link-url").length?jQuery("#wp-link-url").val():jQuery("#url-field").val(),t.val(n).trigger("change"),o.show(),a.show(),s.show(),e.remove(),jQuery("#wp-link-cancel").off("click"),u.close()},u.open("fusion-custom-css-field"),jQuery("#wp-link-url").val(n)}),jQuery("body").on("click","#fusion-link-submit",function(){u.fusionUpdateLink(jQuery(this))}),jQuery("body").on("click","#wp-link-cancel, #wp-link-close, #wp-link-backdrop",function(){o.show(),a.show(),s.show(),r.remove()})},fusionBuilderSetContent:function(i,t){void 0!==window.tinyMCE&&window.tinyMCE.get(i)&&!window.tinyMCE.get(i).isHidden()?(window.tinyMCE.get(i).getParam("wpautop",!0)&&void 0!==window.switchEditors&&(t=window.switchEditors.wpautop(t)),window.tinyMCE.get(i).setContent(t,{format:"html"})):e("#"+i).val(t)},layoutLoaded:function(){this.newLayoutLoaded=!0},clearLayout:function(e){if(e&&e.preventDefault(),!1===confirm(fusionBuilderText.are_you_sure_you_want_to_delete_this_layout))return!1;this.blankPage=!0,this.clearBuilderLayout(!0),fusionHistoryManager.clearEditor("blank")},showHistoryDialog:function(e){e&&e.preventDefault(),this.$el.find(".fusion-builder-history-list").show()},hideHistoryDialog:function(e){e&&e.preventDefault(),this.$el.find(".fusion-builder-history-list").hide()},saveTemplateDialog:function(i){i&&i.preventDefault(),this.showLibrary(),e("#fusion-builder-layouts-templates-trigger").click()},loadPreBuiltPage:function(e){e&&e.preventDefault(),this.showLibrary(),jQuery("#fusion-builder-layouts-demos-trigger").click()},loadSutdioPage:function(e){e&&e.preventDefault(),this.showLibrary(),jQuery("#fusion-builder-layouts-studio-trigger").click()},saveLayout:function(i){var t,n,o,a,s,r,u,l,d,c=[];i&&i.preventDefault(),jQuery('input[id^="pyre_"], select[id^="pyre_"]').each(function(e){l=jQuery(this).attr("id"),d=jQuery(this).val(),void 0!==l&&void 0!==d&&(c[e]=[l,d])}),t=fusionBuilderGetContent("content",!0),n=e("#new_template_name").val(),o=e("#fusion-builder-layouts-templates .fusion-page-layouts"),a=e("#fusion_builder_main_container").data("post-id"),s=e("#fusion-builder-layouts-templates .fusion-page-layouts .fusion-empty-library-message"),r=e("#fusion-custom-css-field").val(),u=e("#page_template").val(),""!==n?(e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_save_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_name:n,fusion_layout_content:t,fusion_layout_post_type:"fusion_template",fusion_current_post_id:a,fusion_custom_css:r,fusion_page_template:u,fusion_options:c},complete:function(e){o.prepend(e.responseText),s.hide()}}),e("#new_template_name").val("")):alert(fusionBuilderText.please_enter_template_name)},saveElement:function(i){var t;i&&i.preventDefault(),e(i.currentTarget).data("element-type"),t=e(i.currentTarget).data("element-cid"),FusionPageBuilderViewManager.getView(t).saveElement()},loadLayout:function(i){var t,n,o,a;i&&i.preventDefault(),!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,t=e(i.currentTarget).closest("li"),n=e(i.currentTarget).data("load-type"),o=fusionBuilderGetContent("content"),a=jQuery("#fusion-custom-css-field").val(),e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:t.data("layout_id")},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),e("#fusion-builder-layouts").hide()}}).done(function(i){var t;FusionPageBuilderApp.layoutLoaded(),t=JSON.parse(i),"above"===n?(o=t.post_content+o,void 0!==t.custom_css&&e("#fusion-custom-css-field").val(t.custom_css+"\n"+a)):"below"===n?(o+=t.post_content,void 0!==t.custom_css&&(a.length?e("#fusion-custom-css-field").val(a+"\n"+t.custom_css):e("#fusion-custom-css-field").val(t.custom_css))):(o=t.post_content,void 0!==t.custom_css&&e("#fusion-custom-css-field").val(t.custom_css),jQuery.each(t.post_meta,function(e,i){jQuery("#"+e).val(i).trigger("change")})),FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.createBuilderLayout(o),void 0!==t.page_template&&e("#page_template").val(t.page_template),FusionPageBuilderApp.layoutIsLoading=!1}).always(function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}))},loadDemoPage:function(i){var t,n,o,a;if(i&&i.preventDefault(),!1===confirm(fusionBuilderText.importing_single_page))return!1;!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,t=e(i.currentTarget).data("page-name"),n=e(i.currentTarget).data("demo-name"),o=e(i.currentTarget).data("post-id"),e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_load_demo",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,page_name:t,demo_name:n,post_id:o},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),e("#fusion-builder-layouts").hide()}}).done(function(i){var t,n;FusionPageBuilderApp.layoutLoaded(),t=JSON.parse(i),a=t.post_content,FusionPageBuilderApp.clearBuilderLayout(!1),FusionPageBuilderApp.createBuilderLayout(a),void 0!==t.page_template&&e("#page_template").val(t.page_template),n=t.meta,_.each(n,function(i,t){e("#"+t).val(i).trigger("change")}),FusionPageBuilderApp.layoutIsLoading=!1}).always(function(){FusionPageBuilderEvents.trigger("fusion-hide-loader")}))},deleteLayout:function(i){var t,n,o=!1;if(i&&(i.preventDefault(),e(i.currentTarget).closest("li").hasClass("fusion-global")?(n=confirm(fusionBuilderText.are_you_sure_you_want_to_delete_global),o=!0):n=confirm(fusionBuilderText.are_you_sure_you_want_to_delete_this),!1===n))return!1;!0!==this.layoutIsDeleting&&(this.layoutIsDeleting=!0,t=e(i.currentTarget).closest("li"),e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"fusion_builder_delete_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:t.data("layout_id")}}).done(function(){var i="elements";t.parents("#fusion-builder-layouts-templates").length&&(i="templates"),t.remove(),FusionPageBuilderApp.layoutIsDeleting=!1,e("#fusion-builder-layouts-"+i+" .fusion-page-layouts").find("li").length||e("#fusion-builder-layouts-"+i+" .fusion-page-layouts .fusion-empty-library-message").show(),!0===o&&e.each(e('div[fusion-global-layout="'+t.data("layout_id")+'"]'),function(i,t){e(this).hasClass("fusion-builder-section-content")?e(this).parent().parent().find("a.fusion-builder-remove").first().trigger("click"):(e(this).find("a.fusion-builder-remove").first().trigger("click"),e(this).find("a.fusion-builder-remove-inner-row").first().trigger("click"))})}))},toggleImportOptions:function(e){var i=jQuery(e.currentTarget).closest(".studio-wrapper");i.hasClass("fusion-studio-preview-active")||i.find(".awb-import-options").toggleClass("open")},loadStudioLayout:function(i){var t,n,o=this,a=void 0!==fusionBuilderConfig.post_type&&"fusion_form"===fusionBuilderConfig.post_type?"forms":"fusion_template",s=FusionPageBuilderApp.studio.getImportOptions(i);i&&i.preventDefault(),a=void 0!==fusionBuilderConfig.post_type&&"awb_off_canvas"===fusionBuilderConfig.post_type?fusionBuilderConfig.post_type:a,"string"==typeof fusionBuilderConfig.template_category&&0<fusionBuilderConfig.template_category.length&&(a=fusionBuilderConfig.template_category),!0!==this.layoutIsLoading&&(this.layoutIsLoading=!0,(t=jQuery(i.currentTarget).closest(".fusion-page-layout")).closest(".studio-imports"),FusionPageBuilderApp.builderToShortcodes(),fusionBuilderGetContent("content"),FusionPageBuilderApp.loaded=!1,jQuery.ajax({type:"POST",url:FusionPageBuilderApp.ajaxurl,dataType:"JSON",data:{action:"fusion_builder_load_layout",fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce,fusion_layout_id:t.data("layout-id"),overWriteType:s.overWriteType,shouldInvert:s.shouldInvert,imagesImport:s.imagesImport,fusion_studio:!0,post_id:fusionBuilderConfig.post_id,category:a},beforeSend:function(){FusionPageBuilderEvents.trigger("fusion-show-loader"),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),e("#fusion-builder-layouts").hide(),e("#fusion-builder-fusion_template-studio").find(".studio-wrapper").addClass("loading"),jQuery("#fusion-loader .awb-studio-import-status").html(fusionBuilderText.studio_importing_content)},success:function(e){var i,t=[],a=jQuery.Deferred(),r=a;if(a.resolve(),o.mediaImportKeys=[],"object"==typeof e.avada_media&&Object.keys(e.avada_media).forEach(function(i){"object"!=typeof e.avada_media[i]||Array.isArray(e.avada_media[i])||o.mediaImportKeys.push(i)}),0<o.mediaImportKeys.length){for(o.studio.setImportData(e),i=0;i<o.mediaImportKeys.length;i++)!function(e){r=r.then(function(){return o.importStudioMedia(o.studio.getImportData(),o.mediaImportKeys[e],s)}),t.push(r)}(i);jQuery.when.apply(null,t).then(function(){o.setStudioContent(e,o.studio.getImportData().post_content,s.loadType),FusionPageBuilderEvents.trigger("fusion-studio-content-imported",o.studio.getImportData()),o.studioLayoutImportComplete(),"function"==typeof awbUpdatePOPanel&&void 0!==(n=o.studio.getImportData().post_meta)&&void 0!==n._fusion&&awbUpdatePOPanel(n._fusion),o.studio.resetImportData()},function(){jQuery("#fusion-loader .awb-studio-import-status").html(fusionBuilderText.studio_importing_content_failed),o.studioLayoutImportComplete(),o.studio.resetImportData()})}else o.setStudioContent(e,e.post_content,s.loadType),FusionPageBuilderEvents.trigger("fusion-studio-content-imported",e),"function"==typeof awbUpdatePOPanel&&void 0!==(n=e.post_meta)&&void 0!==n._fusion&&awbUpdatePOPanel(n._fusion),o.studioLayoutImportComplete()}}))},studioLayoutImportComplete:function(){FusionPageBuilderEvents.trigger("fusion-hide-loader"),e("#fusion-builder-fusion_template-studio").find(".studio-wrapper").removeClass("loading")},setStudioContent:function(e,i,t){var n,o=jQuery("#fusion-custom-css-field").val(),a="";FusionPageBuilderApp.builderToShortcodes(),a=fusionBuilderGetContent("content"),FusionPageBuilderApp.layoutLoaded(),n=void 0!==e.custom_css&&e.custom_css,"load-type-above"===t?(a=i+a,n&&jQuery("#fusion-custom-css-field").val(n+"\n"+o)):"load-type-below"===t?(a+=i,n&&jQuery("#fusion-custom-css-field").val(o+"\n"+n)):(a=i,n&&jQuery("#fusion-custom-css-field").val(n),jQuery.each(e.post_meta,function(e,i){jQuery("#"+e).val(i).trigger("change")}),jQuery("#page_template").val("100-width.php")),FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.createBuilderLayout(a),FusionPageBuilderApp.layoutIsLoading=!1},importStudioMedia:function(e,i,t){var n=this;return jQuery("#fusion-loader .awb-studio-import-status").html(fusionBuilderText.studio_importing_media+" "+i.replace("_"," ")),jQuery.ajax({type:"POST",url:ajaxurl,dataType:"JSON",data:{action:"awb_studio_import_media",data:{mediaImportKey:i,postData:e},overWriteType:t.overWriteType,shouldInvert:t.shouldInvert,imagesImport:t.imagesImport,fusion_load_nonce:FusionPageBuilderApp.fusion_load_nonce},success:function(e){n.studio.setImportData(e)}})},studioPreviewLoaded:function(){window.dispatchEvent(new Event("awb-studio-update-preview")),jQuery(".studio-wrapper").removeClass("loading"),jQuery(".studio-wrapper").find(".fusion-loader").hide()},openLibrary:function(i){i&&i.preventDefault(),this.showLibrary(),e(".fusion-tabs-menu > li:first-child > a").click()},showLibrary:function(i){i&&i.preventDefault(),e("#fusion-builder-layouts").show(),e("body").addClass("fusion_builder_inner_row_no_scroll").append('<div class="fusion_builder_modal_inner_row_overlay"></div>'),setTimeout(function(){e(".fusion-builder-save-element-input, #new_template_name").focus()},20)},hideLibrary:function(i){i&&i.preventDefault(),e("#fusion-builder-layouts").hide(),e("body").removeClass("fusion_builder_inner_row_no_scroll"),e(".fusion_builder_modal_inner_row_overlay").remove(),e(".fusion-save-element-fields").remove()},showLoader:function(){e("#fusion_builder_main_container").css("height","148px"),e("#fusion_builder_container").hide(),e("#fusion-loader").fadeIn("fast")},hideLoader:function(){e("#fusion_builder_container").fadeIn("fast"),e("#fusion_builder_main_container").removeAttr("style"),e("#fusion-loader").fadeOut("fast")},sortableContainers:function(){this.$el.sortable({handle:".fusion-builder-section-header",items:".fusion_builder_container, .fusion-builder-next-page, .fusion-checkout-form",cancel:".fusion-builder-section-name, .fusion-builder-settings, .fusion-builder-clone, .fusion-builder-remove, .fusion-builder-section-add, .fusion-builder-add-element, .fusion-builder-insert-column, #fusion_builder_controls, .fusion-builder-save-element",cursor:"move",update:function(){fusionHistoryManager.turnOnTracking(),fusionHistoryState=fusionBuilderText.moved_container,FusionPageBuilderEvents.trigger("fusion-element-sorted")}})},initialBuilderLayout:function(e){FusionPageBuilderViewManager.removeViews(),FusionPageBuilderEvents.trigger("fusion-show-loader"),setTimeout(function(){var i=fusionBuilderGetContent("content",!0,e),t="",n="",o="";try{jQuery("body").hasClass("fusion-builder-library-edit")||(i=FusionPageBuilderApp.validateContent(i)),FusionPageBuilderApp.createBuilderLayout(i),FusionPageBuilderEvents.trigger("fusion-hide-loader")}catch(e){FusionPageBuilderApp.fusionBuilderSetContent("content",i),jQuery("#fusion_toggle_builder").trigger("click"),t=FusionPageBuilderApp.$el.find("#content-error"),n=FusionPageBuilderApp.$el,o=t.clone(),t.dialog({dialogClass:"fusion-builder-dialog",autoOpen:!1,modal:!0,closeText:"",buttons:{OK:function(){jQuery(this).dialog("close")}},close:function(){n.append(o)}}),t.dialog("open")}},50)},validateContent:function(e){var i,t,n,o=""===e,a="",s=[],r=[];if(-1!==e.indexOf("[fullwidth"))throw"Avada 4.0.3 or earlier fullwidth container used!";return o||(e=(e=e.replace(/\[fusion\_text \/\]/g,"[fusion_text][/fusion_text]").replace(/\[\/fusion\_text\]\[\/fusion\_text\]/g,"[/fusion_text]")).replace(/\$\$/g,"&#36;&#36;"),a=e,a=wp.shortcode.replace("fusion_builder_container",a,function(){return"@|@"}),a=wp.shortcode.replace("fusion_builder_next_page",a,function(){return"@|@"}),a=(a=wp.shortcode.replace("fusion_woo_checkout_form",a,function(){return"@|@"})).trim().split("@|@"),_.each(a,function(i){""!==i.trim()&&(e=e.replace(i,'[fusion_builder_container type="flex" hundred_percent="no" equal_height_columns="no" menu_anchor="" hide_on_mobile="small-visibility,medium-visibility,large-visibility" class="" id="" background_color="" background_image="" background_position="center center" background_repeat="no-repeat" fade="no" background_parallax="none" parallax_speed="0.3" video_mp4="" video_webm="" video_ogv="" video_url="" video_aspect_ratio="16:9" video_loop="yes" video_mute="yes" overlay_color="" overlay_opacity="0.5" video_preview_image="" border_size="" border_color="" border_style="solid" padding_top="" padding_bottom="" padding_left="" padding_right=""][fusion_builder_row]'+i+"[/fusion_builder_row][/fusion_builder_container]"))}),a=wp.shortcode.replace("fusion_builder_container",e,function(e){r.push(e.content)}),_.each(r,function(i){i=wp.shortcode.replace("fusion_builder_row",i,function(e){return e.content}),i=(i=wp.shortcode.replace("fusion_builder_column",i,function(){return"@|@"})).trim().split("@|@"),_.each(i,function(i){""!==i.trim()&&"[fusion_builder_row][/fusion_builder_row]"!==i.trim()&&(t='[fusion_builder_column type="1_1" background_position="left top" background_color="" border_size="" border_color="" border_style="solid" border_position="all" spacing="yes" background_image="" background_repeat="no-repeat" padding="" margin_top="0px" margin_bottom="0px" class="" id="" animation_type="" animation_speed="0.3" animation_direction="left" hide_on_mobile="small-visibility,medium-visibility,large-visibility" center_content="no" last="no" min_height="" hover_type="none" link=""]'+i+"[/fusion_builder_column]",e=e.replace(i,t))})}),a=wp.shortcode.replace("fusion_builder_column_inner",e,function(e){s.push(e.content)}),a=wp.shortcode.replace("fusion_builder_column",e,function(e){s.push(e.content)}),_.each(s,function(t){i=fusionAllElements,_.each(i,function(e){void 0===e.generator_only&&(t=wp.shortcode.replace(e.shortcode,t,function(){return"@|@"}))}),t=t.trim().split("@|@"),_.each(t,function(i){""!==i.trim()&&"<br />"!==i.trim()&&(n="@=%~@","@"===i.slice(-1)&&(n="#=%~#"),e=e.replace(i,"[fusion_text]"+i.slice(0,-1)+n+i.slice(-1)+"[/fusion_text]"))})}),e=e.replace(/@=%~@/g,"").replace(/#=%~#/g,""),e=wp.shortcode.replace("fusion_text",e,function(e){if(i=fusionAllElements,a=e.content,_.each(i,function(e){void 0===e.generator_only&&(a=wp.shortcode.replace(e.shortcode,a,function(){return"|"}))}),!a.replace(/\|/g,"").length)return e.content})),e=e.replace(/&#36;&#36;/g,function(){return"$$"})},validateLibraryContent:function(e){var i=""===e,t='[fusion_builder_container type="flex" hundred_percent="no" equal_height_columns="no" menu_anchor="" hide_on_mobile="small-visibility,medium-visibility,large-visibility" class="" id="" background_color="" background_image="" background_position="center center" background_repeat="no-repeat" fade="no" background_parallax="none" parallax_speed="0.3" video_mp4="" video_webm="" video_ogv="" video_url="" video_aspect_ratio="16:9" video_loop="yes" video_mute="yes" overlay_color="" overlay_opacity="0.5" video_preview_image="" border_size="" border_color="" border_style="solid" padding_top="" padding_bottom="" padding_left="" padding_right=""][fusion_builder_row]',n="[/fusion_builder_row][/fusion_builder_container]",o='[fusion_builder_column type="1_1" background_position="left top" background_color="" border_size="" border_color="" border_style="solid" border_position="all" spacing="yes" background_image="" background_repeat="no-repeat" padding="" margin_top="0px" margin_bottom="0px" class="" id="" animation_type="" animation_speed="0.3" animation_direction="left" hide_on_mobile="small-visibility,medium-visibility,large-visibility" center_content="no" last="no" min_height="" hover_type="none" link=""]',a=jQuery("body").hasClass("fusion-element-post-type-columns")||jQuery("body").hasClass("fusion-element-post-type-post_cards");return a&&"[fusion_builder_blank_page][/fusion_builder_blank_page]"===e&&(e=o+"[/fusion_builder_column]",i=!1),i||(jQuery("body").hasClass("fusion-element-post-type-elements")?e=t+o+e+"[/fusion_builder_column]"+n:a&&(e=t+e+n)),e=e.replace(/&#36;&#36;/g,function(){return"$$"})},clearBuilderLayout:function(i){this.$el.find(".fusion-builder-blank-page-content").each(function(){var i=e(this),t=FusionPageBuilderViewManager.getView(i.data("cid"));void 0!==t&&t.removeBlankPageHelper()}),this.$el.find(".fusion-builder-section-content").each(function(){var i=e(this),t=FusionPageBuilderViewManager.getView(i.data("cid"));void 0!==t&&t.removeContainer()}),i&&!jQuery("body").hasClass("fusion-element-post-type-post_cards")&&!0===this.blankPage&&(this.$el.find(".fusion-builder-blank-page-content").length||this.createBuilderLayout("[fusion_builder_blank_page][/fusion_builder_blank_page]"),this.blankPage=!1)},convertGalleryElement:function(e){var i=window.wp.shortcode.regexp("fusion_gallery"),t=this.regExpShortcode("fusion_gallery"),n=e.match(i),o=e,a=[];return n&&(_.each(n,function(e){var i,n=e.match(t),s=""!==n[3]?window.wp.shortcode.attrs(n[3]):"",r="",u="";void 0!==s.named.image_ids&&""!==s.named.image_ids&&(i=s.named.image_ids.split(","),_.each(i,function(e){r+='[fusion_gallery_image image="" image_id="'+e+'" /]',a.push(e)}),u=e.replace("][/fusion_gallery]","]"+r+"[/fusion_gallery]").replace("/]","]"+r+"[/fusion_gallery]").replace('image_ids="'+s.named.image_ids+'" ',""),o=o.replace(e,u))}),0<a.length&&wp.media.query({post__in:a,posts_per_page:a.length}).more()),o},mapStudioImages:function(e,i){"object"==typeof e&&_.each(e,function(e){var t;if("upload"===e.type&&void 0!==i[e.param_name]&&""!==i[e.param_name]){if(void 0===(t=i[e.param_name])||"undefined"===t)return;void 0===FusionPageBuilderApp.mediaMap.images[t]&&(FusionPageBuilderApp.mediaMap.images[t]=!0),void 0!==i[e.param_name+"_id"]&&""!==i[e.param_name+"_id"]&&("object"!=typeof FusionPageBuilderApp.mediaMap.images[t]&&(FusionPageBuilderApp.mediaMap.images[t]={}),FusionPageBuilderApp.mediaMap.images[t][e.param_name+"_id"]=i[e.param_name+"_id"])}})},createMultiElementParentMediaMap:function(e,i){var t=window.wp.shortcode.regexp(e),n=this.regExpShortcode(e),o=fusionAllElements[e].params,a=i.match(t);"object"==typeof o&&a&&_.each(a,function(i){var t=i.match(n),a=""!==t[3]?window.wp.shortcode.attrs(t[3]):"";void 0!==a.named&&void 0!==a.named.image_id&&void 0!==a.named.image&&_.each(o,function(e){var i,t;if("upload"===e.type&&void 0!==a.named[e.param_name]){if(t=a.named[e.param_name],i=a.named.image_id,""===t)return;void 0===FusionPageBuilderApp.mediaMap.images[t]&&(FusionPageBuilderApp.mediaMap.images[t]=!0),""!==i&&"image"===e.param_name&&("object"!=typeof FusionPageBuilderApp.mediaMap.images[t]&&(FusionPageBuilderApp.mediaMap.images[t]={}),FusionPageBuilderApp.mediaMap.images[t].image_id=i)}}),"fusion_slide"===e&&void 0!==t[5]&&""!==t[5]&&void 0===FusionPageBuilderApp.mediaMap.images[t[5]]&&(FusionPageBuilderApp.mediaMap.images[t[5]]=!0)})},createBuilderLayout:function(e){jQuery("body").hasClass("fusion-builder-library-edit")&&(e=FusionPageBuilderApp.validateLibraryContent(e)),e=this.convertGalleryElement(e),this.shortcodesToBuilder(e),this.legacyColumnSpacing(),this.legacyContainerBorderSize(),jQuery("body").hasClass("fusion-builder-library-edit")?this.libraryBuilderToShortcodes():this.builderToShortcodes()},legacyContainerBorderSize:function(){this.collection.each(function(e){var i;"fusion_builder_container"===e.get("type")&&void 0!==(i=e.get("params")).border_size&&(""!==i.border_size&&(i.border_sizes_top=isNaN(i.border_size)?i.border_size:i.border_size+"px",i.border_sizes_bottom=i.border_sizes_top,i.border_sizes_left="0px",i.border_sizes_right="0px"),delete i.border_size,e.set("params",i))})},legacyColumnSpacing:function(){var e,i=this,t={parent:{},nested:{}},n=0,o=0,a=0,s=0;this.collection.each(function(r){"fusion_builder_row"===r.get("type")?n++:"fusion_builder_row_inner"===r.get("type")?o++:"fusion_builder_column"!==r.get("type")&&"fusion_builder_column_inner"!==r.get("type")||(params=r.get("params"),width=i.validateColumnWidth(params.type),e={model:r},"fusion_builder_column"===r.get("type")?(1<(s+=width)&&(n+=1,s=width),void 0===t.parent[n]?t.parent[n]=[e]:t.parent[n].push(e)):(1<(a+=width)&&(o+=1,a=width),void 0===t.nested[o]?t.nested[o]=[e]:t.nested[o].push(e)))}),_.each(t.parent,function(e,t){i.setLegacySpacing(e,t)}),_.isEmpty(t.nested)||_.each(t.nested,function(e,t){i.setLegacySpacing(e,t)})},setLegacySpacing:function(e,i){var t=this,n=e.length,o=n-1,a="",s=!0,r=!1,u=!1;_.each(e,function(e,i){var u,l,d=!1,c=!1,f=e.model,p=jQuery.extend(!0,{},f.get("params"));0===i&&(d=!0),o===i&&(c=!0),p.first=d,p.last=c,void 0!==p.spacing?("yes"===(u=p.spacing)?u="4%":"no"===u&&(u="0px"),"0px"!==u&&0!==u&&"0"!==u&&(s=!1),l=t.getWeightedSpacing(u,p,n),void 0===p.spacing_left&&void 0===p.spacing_right&&(p.last||(p.spacing_right=l),""!==a&&(p.spacing_left=t.getWeightedSpacing(a,p,n))),a=u):s=!1,r=f,f.set("params",p)}),r&&s&&(u=this.getParentContainer(r.get("cid")))&&(u.model.attributes.params.flex_column_spacing="0px")},getHalfSpacing:function(e){var i=parseFloat(e),t=i/2;return e.replace(i,t)},getWeightedSpacing:function(e,i,t){var n,o=parseFloat(this.validateColumnWidth(i.type)),a=parseFloat(e);return n=!1!==(t=void 0!==t&&!1!==t&&parseInt(t))&&3>t?a*o:a/2,e.replace(a,n)},validateColumnWidth:function(e){var i;return void 0===e&&(e="1_3"),-1!==e.indexOf("_")?(i=e.split("_"),parseFloat(i[0])/parseFloat(i[1])):1<parseFloat(e)?parseFloat(e)/100:e},shortcodesToBuilder:function(e,i,t,n){var o,a,s,r,u;""!==e||this.$el.find(".fusion-builder-blank-page-content").length?(o=this,u=_.keys(fusionAllElements).join("|"),a=window.wp.shortcode.regexp(u),s=this.regExpShortcode(u),r=e.match(a),_.each(r,function(e){var r,u,l,d,c,f,p,m,g,h,b=e.match(s),v=b[2],y=""!==b[3]?window.wp.shortcode.attrs(b[3]):"",w=void 0!==b[5]?b[5]:"",B=FusionPageBuilderViewManager.generateCid(),P={params:{}},F=void 0!==w&&""!==w&&w.match(a);if(r={type:v,element_type:v,cid:B,created:"manually",multi:"",params:{},allow_generator:void 0!==fusionAllElements[v].allow_generator?fusionAllElements[v].allow_generator:""},"fusion_builder_container"===v&&"fusion_builder_next_page"===v&&"fusion_woo_checkout_form"===v||(r.parent=i),"fusion_builder_container"!==v&&"fusion_builder_row"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v&&"fusion_builder_row_inner"!==v&&"fusion_builder_blank_page"!==v&&"fusion_builder_next_page"!==v&&"fusion_woo_checkout_form"!==v&&(-1===v.indexOf("fusion_")&&-1===v.indexOf("layerslider")&&-1===v.indexOf("rev_slider")&&void 0===fusionAllElements[v]||(r.type="element")),_.isObject(y.named)){if("fusion_builder_container"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||void 0!==y.named.background_blend_mode||(backgroundColor=y.named.background_color,videoBg="fusion_builder_container"===v&&void 0!==y.named.video_bg?y.named.video_bg:"","fusion_builder_container"!==v||"undefined"!=typeof backgroundColor&&""!==backgroundColor||(backgroundColor=fusionAllElements[v].defaults.background_color),""!==backgroundColor&&(alphaBackgroundColor=jQuery.AWB_Color(backgroundColor).alpha(),1>alphaBackgroundColor&&0!==alphaBackgroundColor&&(""!==y.named.background_image||""!==videoBg)&&(y.named.background_blend_mode="overlay"))),"fusion_builder_container"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||void 0===y.named.radial_direction||(h={bottom:"center bottom","bottom center":"center bottom",left:"left center",right:"right center",top:"center top",center:"center center","center left":"left center"},y.named.radial_direction in h&&(y.named.radial_direction=h[y.named.radial_direction])),"fusion_tb_meta"===v&&(void 0!==y.named.border_top&&void 0!==y.named.border_bottom&&void 0!==y.named.border_left&&void 0!==y.named.border_right||"string"!=typeof y.named.border_size||(y.named.border_top=y.named.border_size+"px",y.named.border_bottom=y.named.border_size+"px"),delete y.named.border_size),"fusion_builder_container"===v&&(void 0===y.named.type&&"object"==typeof fusionAllElements.fusion_builder_container?y.named.type=fusionAllElements.fusion_builder_container.defaults.type:void 0===fusionBuilderConfig.container_legacy_support||"0"!==fusionBuilderConfig.container_legacy_support&&0!==fusionBuilderConfig.container_legacy_support&&!1!==fusionBuilderConfig.container_legacy_support||(y.named.type="flex"),void 0===y.named.flex_align_items&&void 0!==y.named.equal_height_columns&&"yes"===y.named.equal_height_columns&&(y.named.flex_align_items="stretch"),void 0===y.named.align_content&&void 0!==y.named.hundred_percent_height&&"yes"===y.named.hundred_percent_height&&void 0!==y.named.hundred_percent_height_center_content&&"yes"===y.named.hundred_percent_height_center_content&&(y.named.align_content="center")),!("fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||(void 0===y.named.align_self&&void 0!==y.named.min_height&&"none"===y.named.min_height&&(y.named.align_self="flex-start"),void 0===y.named.align_content&&void 0!==y.named.center_content&&"yes"===y.named.center_content&&(y.named.align_content="center"),void 0!==y.named.border_sizes_top&&void 0!==y.named.border_sizes_bottom&&void 0!==y.named.border_sizes_left&&void 0!==y.named.border_sizes_right||"string"!=typeof y.named.border_size))){switch(y.named.border_position){case"all":y.named.border_sizes_top=y.named.border_size,y.named.border_sizes_bottom=y.named.border_size,y.named.border_sizes_left=y.named.border_size,y.named.border_sizes_right=y.named.border_size;break;default:y.named["border_sizes_"+y.named.border_position]=y.named.border_size}delete y.named.border_size}for(u in"fusion_fontawesome"===v&&(void 0===y.named.iconcolor_hover&&"string"==typeof y.named.iconcolor&&(y.named.iconcolor_hover=y.named.iconcolor),void 0===y.named.circlecolor_hover&&"string"==typeof y.named.circlecolor&&(y.named.circlecolor_hover=y.named.circlecolor),void 0===y.named.circlebordercolor_hover&&"string"==typeof y.named.circlebordercolor&&(y.named.circlebordercolor_hover=y.named.circlebordercolor)),"fusion_title"===v&&(void 0===y.named.margin_top_small&&"string"==typeof y.named.margin_top_mobile&&(y.named.margin_top_small=y.named.margin_top_mobile),void 0===y.named.margin_bottom_small&&"string"==typeof y.named.margin_bottom_mobile&&(y.named.margin_bottom_small=y.named.margin_bottom_mobile)),"fusion_countdown"===v&&(void 0===y.named.counter_border_radius&&"string"==typeof y.named.border_radius&&(y.named.counter_border_radius=y.named.border_radius),void 0===y.named.label_color&&"string"==typeof y.named.counter_text_color&&(y.named.label_color=y.named.counter_text_color)),y.named)l=u,"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||"type"!==l||(P[l="layout"]=y.named[u]),P.params[l]=y.named[u],"fusion_products_slider"===v&&"cat_slug"===u&&(P.params.cat_slug=y.named[u].replace(/\|/g,",")),"gradient_colors"===u&&(delete P.params[l],-1!==y.named[u].indexOf("|")?(P.params.button_gradient_top_color=y.named[u].split("|")[0].replace("transparent","rgba(255,255,255,0)"),P.params.button_gradient_bottom_color=y.named[u].split("|")[1]?y.named[u].split("|")[1].replace("transparent","rgba(255,255,255,0)"):y.named[u].split("|")[0].replace("transparent","rgba(255,255,255,0)")):P.params.button_gradient_bottom_color=P.params.button_gradient_top_color=y.named[u].replace("transparent","rgba(255,255,255,0)")),"gradient_hover_colors"===u&&(delete P.params[l],-1!==y.named[u].indexOf("|")?(P.params.button_gradient_top_color_hover=y.named[u].split("|")[0].replace("transparent","rgba(255,255,255,0)"),P.params.button_gradient_bottom_color_hover=y.named[u].split("|")[1]?y.named[u].split("|")[1].replace("transparent","rgba(255,255,255,0)"):y.named[u].split("|")[0].replace("transparent","rgba(255,255,255,0)")):P.params.button_gradient_bottom_color_hover=P.params.button_gradient_top_color_hover=y.named[u].replace("transparent","rgba(255,255,255,0)")),"overlay_color"===u&&""!==y.named[u]&&"fusion_builder_container"===v&&(delete P.params[l],p=void 0!==y.named.overlay_opacity?y.named.overlay_opacity:1,P.params.background_color=jQuery.AWB_Color(y.named[u]).alpha(p).toRgbaString()),"overlay_opacity"===u&&delete P.params[l],"scrolling"===u&&"fusion_blog"===v&&(delete P.params.paging,"no"===(void 0!==y.named.paging?y.named.paging:"")&&"pagination"===y.named.scrolling&&(P.params.scrolling="no")),"fusion_portfolio"===v&&("layout"===u&&("grid"===y.named[u]&&y.named.hasOwnProperty("boxed_text")?y.named.boxed_text="no_text":"grid-with-text"===y.named[u]&&(P.params[u]="grid")),"boxed_text"===u&&(P.params.text_layout=y.named[u],delete P.params[u]),"content_length"===u&&"full-content"===y.named[u]&&(P.params[u]="full_content")),"fusion_pricing_table"===v&&("backgroundcolor"!==u||y.named.hasOwnProperty("background_color_hover")||(P.params.background_color_hover=y.named.bordercolor)),"type"===u&&"fusion_widget"===v&&-1!==P.params[u].indexOf("Tribe")&&(P.params[u]=P.params[u].replace(/\\/g,"").split(/(?=[A-Z])/).join("\\").replace("_\\","_")),"padding"!==u||"fusion_widget_area"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||(1===(m=y.named[u].split(" ")).length&&(P.params.padding_top=m[0],P.params.padding_right=m[0],P.params.padding_bottom=m[0],P.params.padding_left=m[0]),2===m.length&&(P.params.padding_top=m[0],P.params.padding_right=m[1],P.params.padding_bottom=m[0],P.params.padding_left=m[1]),3===m.length&&(P.params.padding_top=m[0],P.params.padding_right=m[1],P.params.padding_bottom=m[2],P.params.padding_left=m[1]),4===m.length&&(P.params.padding_top=m[0],P.params.padding_right=m[1],P.params.padding_bottom=m[2],P.params.padding_left=m[3]),delete P.params[u]);"fusion_widget"===v&&"Fusion_Widget_Vertical_Menu"===y.named.type&&void 0===y.named.fusion_divider_color&&(P.params.fusion_divider_color=y.named.fusion_widget_vertical_menu__border_color,delete P.params.fusion_widget_vertical_menu__border_color),"fusion_table"===v&&void 0===y.named.fusion_table_type&&("1"!==w.charAt(18)&&"2"!==w.charAt(18)||(P.params.fusion_table_type=w.charAt(18))),"fusion_content_boxes"!==v&&"fusion_flip_boxes"!==v||(void 0!==y.named.image_width&&(P.params.image_max_width=y.named.image_width),w=w.replace(/image_width/g,"image_max_width")),"fusion_button"!==v&&"fusion_tagline_box"!==v||(g="fusion_tagline_box"===v?"button_":"",void 0!==y.named[g+"shape"]&&("square"===y.named[g+"shape"]?P.params[g+"border_radius"]="0":"round"===y.named[g+"shape"]?(P.params[g+"border_radius"]="2","3d"===y.named.type&&(P.params[g+"border_radius"]="4")):"pill"===y.named[g+"shape"]?P.params[g+"border_radius"]="25":""===y.named[g+"shape"]&&(P.params[g+"border_radius"]=""),delete P.params[g+"shape"])),"fusion_button"===v&&(void 0===y.named.border_color&&void 0!==y.named.accent_color&&""!==y.named.accent_color&&(P.params.border_color=y.named.accent_color),void 0===y.named.border_hover_color&&void 0!==y.named.accent_hover_color&&""!==y.named.accent_hover_color&&(P.params.border_hover_color=y.named.accent_hover_color)),"fusion_button"!==v&&"fusion_form_submit"!==v||(void 0===y.named.border_top&&void 0!==y.named.border_width&&""!==y.named.border_width&&(P.params.border_top=parseInt(y.named.border_width)+"px",P.params.border_right=P.params.border_top,P.params.border_bottom=P.params.border_top,P.params.border_left=P.params.border_top,delete y.named.border_width),void 0===y.named.border_radius_top_left&&void 0!==y.named.border_radius&&""!==y.named.border_radius&&(P.params.border_radius_top_left=parseInt(y.named.border_radius)+"px",P.params.border_radius_top_right=P.params.border_radius_top_left,P.params.border_radius_bottom_right=P.params.border_radius_top_left,P.params.border_radius_bottom_left=P.params.border_radius_top_left,delete y.named.border_radius)),"fusion_tagline_box"===v&&void 0===y.named.button_border_radius_top_left&&void 0!==y.named.button_border_radius&&""!==y.named.button_border_radius&&(P.params.button_border_radius_top_left=parseInt(y.named.border_radius)+"px",P.params.button_border_radius_top_right=P.params.button_border_radius_top_left,P.params.button_border_radius_bottom_right=P.params.button_border_radius_top_left,P.params.button_border_radius_bottom_left=P.params.button_border_radius_top_left,delete y.named.button_border_radius),"fusion_tb_woo_cart"!==v&&"fusion_tb_woo_reviews"!==v&&"fusion_post_card_cart"!==v&&"fusion_tb_woo_checkout_payment"!==v||void 0===y.named.button_border_top&&void 0!==y.named.button_border_width&&""!==y.named.button_border_width&&(P.params.button_border_top=parseInt(y.named.button_border_width)+"px",P.params.button_border_right=P.params.button_border_top,P.params.button_border_bottom=P.params.button_border_top,P.params.button_border_left=P.params.button_border_top,delete y.named.button_border_width),"fusion_post_card_cart"===v&&void 0===y.named.button_details_border_top&&void 0!==y.named.button_details_border_width&&""!==y.named.button_details_border_width&&(P.params.button_details_border_top=parseInt(y.named.button_details_border_width)+"px",P.params.button_details_border_right=P.params.button_details_border_top,P.params.button_details_border_bottom=P.params.button_details_border_top,P.params.button_details_border_left=P.params.button_details_border_top,delete y.named.button_details_border_width),"fusion_register"===v&&void 0===y.named.register_note&&(P.params.register_note=fusionBuilderText.user_login_register_note),r=_.extend(r,P)}F||"fusion_builder_column"===v||(r.params.element_content=w),v in fusionMultiElements&&(r.multi="multi_element_parent"),void 0!==fusionAllElements[v].option_dependency&&(d=fusionAllElements[v].option_dependency,c=P.params[d],f=P.params.element_content,P.params[c]=f),F&&"fusion_builder_container"!==v&&"fusion_builder_row"!==v&&"fusion_builder_row_inner"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v&&"fusion_builder_next_page"!==v&&"fusion_woo_checkout_form"!==v&&(r.params.element_content=w),void 0!==t&&t&&(r.targetElement=t),void 0!==n&&n&&(r.targetElementPosition=n),o.collection.add([r]),F&&("fusion_builder_container"!==v&&"fusion_builder_row"!==v&&"fusion_builder_row_inner"!==v&&"fusion_builder_column"!==v&&"fusion_builder_column_inner"!==v||o.shortcodesToBuilder(w,B))})):this.createBuilderLayout("[fusion_builder_blank_page][/fusion_builder_blank_page]")},addBuilderElement:function(i){var t,n,o,a,s={model:i,collection:FusionPageBuilderElements};switch(i.get("type")){case"fusion_builder_blank_page":void 0!==fusionBuilderConfig.post_type&&"fusion_form"===fusionBuilderConfig.post_type?(s.className="fusion_builder_blank_page",t=new FusionPageBuilder.BlankFormView(s)):t=new FusionPageBuilder.BlankPageView(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("view"))?this.$el.find("#fusion_builder_container").append(t.render().el):i.get("view").$el.after(t.render().el);break;case"fusion_builder_container":""!==FusionPageBuilderApp.targetContainerCID&&(i.attributes.view=FusionPageBuilderViewManager.getView(FusionPageBuilderApp.targetContainerCID),FusionPageBuilderApp.targetContainerCID=""),t=new FusionPageBuilder.ContainerView(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("view"))?(this.$el.find("#fusion_builder_container").append(t.render().el),this.$el.find(".fusion_builder_blank_page").remove()):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("view").$el.after(t.render().el):i.get("view").$el.before(t.render().el),"manually"!==i.get("created")&&t.addRow(),(!_.isUndefined(i.attributes.params.admin_toggled)&&"no"===i.attributes.params.admin_toggled||_.isUndefined(i.attributes.params.admin_toggled))&&(FusionPageBuilderApp.toggledContainers=!1,e(".fusion-builder-layout-buttons-toggle-containers").find("span").addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down"));break;case"fusion_builder_row":t=new FusionPageBuilder.RowView(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").length?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").append(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-add-element").hide().end().append(t.render().el),"manually"===i.get("created")&&"row_inner"===i.get("element_type")&&i.set("view",FusionPageBuilderViewManager.getView(i.get("parent")),{silent:!0});break;case"fusion_builder_row_inner":FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),t=new FusionPageBuilder.InnerRowView(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("appendAfter"))?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").length?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-section-content").append(t.render().el):_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-add-element").before(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find("> .fusion-builder-column-controls").after(t.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el):(i.get("appendAfter").after(t.render().el),i.unset("appendAfter")),"manually"===i.get("created")&&"row_inner"===i.get("element_type")&&i.set("view",FusionPageBuilderViewManager.getView(i.get("parent")),{silent:!0});break;case"fusion_builder_column":i.get("layout")&&(s.className="fusion-builder-column fusion-builder-column-outer fusion-builder-column-"+i.get("layout"),t=new FusionPageBuilder.ColumnView(s),_.isUndefined(i.get("cloned"))||!0!==i.get("cloned")||(i.targetElement=t.$el,i.unset("cloned")),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?(void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container").append(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container .fusion-builder-empty-section").after(t.render().el),i.unset("from")):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el));break;case"fusion_builder_column_inner":s.className="fusion-builder-column fusion-builder-column-inner fusion-builder-column-"+i.get("layout"),t=new FusionPageBuilder.NestedColumnView(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container-inner").append(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-row-container-inner").prepend(t.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el);break;case"element":s.attributes={"data-cid":i.get("cid")},void 0!==i.get("multi")&&"multi_element_child"===i.get("multi")?(t=new FusionPageBuilder.MultiElementSortableChild(s),i.targetElement=t.$el,i.attributes.view.child_views.push(t),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("targetElement"))?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-sortable-options").append(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-sortable-options").prepend(t.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el),_.isUndefined(i.get("titleLabel"))||(_.isUndefined(i.get("cloned"))||t.$el.find(".multi-element-child-name").html(i.get("titleLabel")),i.unset("cloned"))):(FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),t=new FusionPageBuilder.ElementView(s),void 0!==(n=this.collection.find(function(e){return e.get("cid")===i.get("parent")}))&&"fusion_builder_column_inner"===n.get("type")?_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-add-element").before(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.prepend(t.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el):_.isUndefined(i.get("targetElement"))||void 0!==i.get("from")?void 0===i.get("targetElementPosition")||"end"===i.get("targetElementPosition")?FusionPageBuilderViewManager.getView(i.get("parent")).$el.find(".fusion-builder-add-element:not(.fusion-builder-column-inner .fusion-builder-add-element)").before(t.render().el):FusionPageBuilderViewManager.getView(i.get("parent")).$el.prepend(t.render().el):void 0===i.get("targetElementPosition")||"after"===i.get("targetElementPosition")?i.get("targetElement").after(t.render().el):i.get("targetElement").before(t.render().el),FusionPageBuilderViewManager.addView(i.get("cid"),t),"manually"===i.get("added")?(s.attributes={"data-modal_view":"element_settings"},t=new FusionPageBuilder.ModalView(s),e("body").append(t.render().el)):(o=i.get("element_type"),void 0!==fusionAllElements[o].preview&&(a=new FusionPageBuilder.ElementPreviewView(s),t.$el.find(".fusion-builder-module-preview").append(a.render().el))));break;case"generated_element":FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),"fusion_builder_column_inner"!==i.get("element_type")&&"fusion_builder_column"!==i.get("element_type")&&(s.attributes={"data-modal_view":"element_settings"},t=new FusionPageBuilder.ModalView(s),e("body").append(t.render().el));break;case"fusion_builder_next_page":t=new FusionPageBuilder.NextPage(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("appendAfter"))?e(".fusion_builder_container:last-child").after(t.render().el):i.get("appendAfter").next().next().hasClass("fusion-builder-next-page")||i.get("appendAfter").after(t.render().el);break;case"fusion_woo_checkout_form":t=new FusionPageBuilder.checkoutForm(s),FusionPageBuilderViewManager.addView(i.get("cid"),t),_.isUndefined(i.get("appendAfter"))?e(".fusion_builder_container:last-child").length?e(".fusion_builder_container:last-child").after(t.render().el):e("#fusion_builder_container").append(t.render().el):2>this.$el.find(".fusion-checkout-form").length&&i.get("appendAfter").after(t.render().el)}},regExpShortcode:_.memoize(function(e){return new RegExp("\\[(\\[?)("+e+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)")}),findShortcodeMatches:function(e,i){var t,n;return _.isObject(e)&&(e=e.value),t="",e=void 0!==e?e:"",n=window.wp.shortcode.regexp(i),new RegExp("\\[(\\[?)("+i+")(?![\\w-])([^\\]\\/]*(?:\\/(?!\\])[^\\]\\/]*)*?)(?:(\\/)\\]|\\](?:([^\\[]*(?:\\[(?!\\/\\2\\])[^\\[]*)*)(\\[\\/\\2\\]))?)(\\]?)"),void 0!==e&&""!==e&&(t=e.match(n)),t},beforeGenerateShortcode:function(e){var i,t=FusionPageBuilderViewManager.getView(e),n=t.model.get("element_type"),o=fusionAllElements[n].params,a=jQuery.extend(!0,{},fusionAllElements[n].defaults,t.model.get("params"));"object"==typeof o&&(void 0===fusionBuilderConfig.replaceAssets||!fusionBuilderConfig.replaceAssets||"-1"===jQuery("body").attr("class").indexOf("fusion-element-post-type-")&&"fusion_template"!==fusionBuilderConfig.post_type||(this.mapStudioImages(o,a),void 0!==t.model.get("multi")&&"multi_element_parent"===t.model.get("multi")&&""!==a.element_content&&this.createMultiElementParentMediaMap(fusionAllElements[n].element_child,a.element_content),"fusion_imageframe"===n&&""!==a.element_content&&(void 0===FusionPageBuilderApp.mediaMap.images[a.element_content]&&(FusionPageBuilderApp.mediaMap.images[a.element_content]=!0),void 0!==a.image_id&&""!==a.image_id&&("object"!=typeof FusionPageBuilderApp.mediaMap.images[a.element_content]&&(FusionPageBuilderApp.mediaMap.images[a.element_content]={}),FusionPageBuilderApp.mediaMap.images[a.element_content].image_id=a.image_id)),"fusion_menu"===n&&""!==a.menu&&void 0===FusionPageBuilderApp.mediaMap.menus[a.menu]&&(FusionPageBuilderApp.mediaMap.menus[a.menu]=!0),"fusion_form"===n&&""!==a.form_post_id&&void 0===FusionPageBuilderApp.mediaMap.forms[a.form_post_id]&&(FusionPageBuilderApp.mediaMap.forms[a.form_post_id]=!0),"fusion_tb_post_card_archives"!==n&&"fusion_post_cards"!==n||""===a.post_card||void 0===FusionPageBuilderApp.mediaMap.post_cards[a.post_card]&&(FusionPageBuilderApp.mediaMap.post_cards[a.post_card]=!0),"fusion_video"===n&&""!==a.video&&void 0===FusionPageBuilderApp.mediaMap.videos[a.video]&&(FusionPageBuilderApp.mediaMap.videos[a.video]=!0),"fusion_builder_container"===n&&""!==a.video_mp4&&void 0===FusionPageBuilderApp.mediaMap.videos[a.video_mp4]&&(FusionPageBuilderApp.mediaMap.videos[a.video_mp4]=!0),"fusion_fontawesome"===n&&""!==a.icon&&"fusion-prefix-"===a.icon.substr(0,14)&&void 0!==fusionBuilderConfig.customIcons&&(i=a.icon.substr(14),jQuery.each(fusionBuilderConfig.customIcons,function(e,t){if(0===i.indexOf(t.css_prefix))return FusionPageBuilderApp.mediaMap.icons[t.post_id]=t.css_prefix,!1}))))},libraryBuilderToShortcodes:function(){var e,i,t="";jQuery("body").hasClass("fusion-element-post-type-elements")?jQuery(".fusion-builder-column-outer .fusion_builder_row_inner").length?(e=jQuery(".fusion-builder-column-outer .fusion_builder_row_inner").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getInnerRowContent()):jQuery(".fusion_module_block").length&&(t=FusionPageBuilderApp.generateElementShortcode(jQuery(".fusion_module_block"),!1)):jQuery("body").hasClass("fusion-element-post-type-columns")||jQuery("body").hasClass("fusion-element-post-type-post_cards")?jQuery(".fusion-builder-column-outer").length&&(e=jQuery(".fusion-builder-column-outer").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getColumnContent(jQuery(".fusion-builder-column-outer"))):jQuery("body").hasClass("fusion-element-post-type-sections")&&jQuery(".fusion-builder-section-content").length&&(e=jQuery(".fusion-builder-section-content.fusion-builder-data-cid").data("cid"),i=FusionPageBuilderViewManager.getView(e),t=i.getContainerContent()),setTimeout(function(){FusionPageBuilderApp.fusionBuilderSetContent("content",t),FusionPageBuilderEvents.trigger("fusion-save-history-state"),FusionPageBuilderApp.setGoogleFonts(t)},500)},builderToShortcodes:function(){var i,t="",n=this,o="object"==typeof fusionBuilderConfig.plugins_active&&fusionBuilderConfig.plugins_active;this.simplifiedMap=[],this.mediaMap={images:{},menus:{},forms:{},post_cards:{},videos:{},icons:{},off_canvases:{}},jQuery("body").hasClass("fusion-builder-library-edit")?this.libraryBuilderToShortcodes():"undefined"===this.pauseBuilder||this.pauseBuilder||(this.$el.find(".fusion_builder_container").each(function(i,o){var a=e(this).find(".fusion-builder-section-content");t+=n.generateElementShortcode(e(this),!0),a.find(".fusion_builder_row").each(function(){var i=e(this);t+="[fusion_builder_row]",i.find(".fusion-builder-column-outer").each(function(){var i=e(this),n=i.data("cid"),o=FusionPageBuilderViewManager.getView(n);t+=o.getColumnContent(i)}),t+="[/fusion_builder_row]"}),t+="[/fusion_builder_container]",e(this).next().hasClass("fusion-builder-next-page")&&(t+="[fusion_builder_next_page]"),e(this).next().hasClass("fusion-checkout-form")&&(t+="[fusion_woo_checkout_form]"),e(this).prev().hasClass("fusion-checkout-form")&&0===i&&(t="[fusion_woo_checkout_form]"+t)}),setTimeout(function(){FusionPageBuilderApp.fusionBuilderSetContent("content",t),FusionPageBuilderEvents.trigger("fusion-save-history-state"),FusionPageBuilderApp.setGoogleFonts(t),jQuery(document).trigger("fusion-builder-content-updated")},500)),!1!==o&&!0===o.awb_studio&&void 0!==(i=jQuery("#pyre_off_canvases").val())&&i.length&&_.each(i,function(e,i){FusionPageBuilderApp.mediaMap.off_canvases[e]=!0}),!_.isEmpty(this.mediaMap)&&void 0!==fusionBuilderConfig.replaceAssets&&fusionBuilderConfig.replaceAssets&&jQuery("#fusion-studio-media-map-field").val(JSON.stringify(FusionPageBuilderApp.mediaMap))},setGoogleFonts:function(e){var i,t={},n=jQuery("#fusion-google-fonts-field"),o=n.val();if(o&&""!==o)try{o=JSON.parse(o)}catch(e){}for(i in t=this.setElementFonts(e,t),t=this.setInlineFonts(e,t))i.includes("var(")&&window.awbOriginalPalette&&a(i);function a(e){var i,n,o,a,s,r,u=e.match(/--awb-typography(\d)/);if(u[1]&&Array.isArray(t[e].variants)){for(r=u[1],i=awbTypoData.data["typography"+r]["font-family"],n=[],s=0;s<t[e].variants.length;s++)t[e].variants[s].includes("var(")?(a=t[e].variants[s].match(/--awb-typography(\d)/))[1]&&(awbTypoData.data["typography"+a[1]].variant?n.push(awbTypoData.data["typography"+a[1]].variant):n.push("400")):n.push(t[e].variants[s]);t[i]?t[i].variants?t[i].variants=t[i].variants.concat(n):t[i].variants=n:(t[i]={},t[i].variants=n),o=[],t[i].variants.forEach(function(e){o.includes(e)||o.push(e)}),t[i].variants=o,delete t[e]}else delete t[e]}"object"==typeof o?(_.each(o,function(e,i){_.each(e,function(e,t){o[i][t]=_.values(e)})}),_.isEqual(o,t)||(_.isEmpty(t)&&(t=""),o=t)):_.isEmpty(t)||(o=t),n.val(JSON.stringify(o))},setElementFonts:function(e,i){var t,n,o={},a=[];return""!==e&&-1!==e.indexOf("fusion_font_")&&(t=new RegExp('(fusion_font_[^=]*=")([^"]*)"',"g"),"object"==typeof(n=e.match(t))&&_.each(n,function(e,i){var t=e.slice(0,-1).split('="'),n=t[0].replace("fusion_font_family_","").replace("fusion_font_variant_",""),s="family";-1!==t[0].indexOf("fusion_font_variant_")&&(s="variant"),""===t[1]&&"family"===s||("object"!=typeof o[n]?o[n]={}:"family"===s&&(a.push(o[n]),o[n]={}),o[n][s]=t[1],void 0!==o[n].family&&void 0!==o[n].variant&&(a.push(o[n]),delete o[n]))}),_.each(o,function(e,i){void 0!==e.family&&""!==e.family&&a.push(o[i])}),_.each(a,function(e,t){void 0!==e.family&&""!==e.family&&(void 0===i[e.family]&&(i[e.family]={variants:[]}),"string"!=typeof e.variant||i[e.family].variants.includes(e.variant)||i[e.family].variants.push(e.variant))})),i},setInlineFonts:function(e,i){var t,n,o={},a=[],s=[];return""!==e&&-1!==e.indexOf("data-fusion-google-")&&(t=new RegExp('data-fusion-google-[^=]*="([^"]*)"',"g"),"object"==typeof(n=e.match(t))&&_.each(n,function(e,i){var t=e.slice(0,-1).split('="'),n="family";-1!==t[0].indexOf("data-fusion-google-variant")&&(n="variant"),"string"==typeof o.family&&"family"===n&&(a.push(o),o={}),o[n]=t[1],void 0!==o.family&&void 0!==o.variant&&(s.push(o),o={})}),_.each(a,function(e,i){void 0!==e.family&&s.push(a[i])}),_.each(s,function(e,t){void 0===i[e.family]&&(i[e.family]={variants:[],subsets:[]}),"string"==typeof e.variant&&i[e.family].variants.push(e.variant)})),i},syncGlobalLayouts:function(){var i,t,n=e("#fusion_builder_main_container"),o=!1,a=[];0!==n.find('div[class^="fusion-global-"],div[class*=" fusion-global-"]').length&&e('div[class^="fusion-global-"],div[class*=" fusion-global-"]').each(function(){var s=e(this).attr("fusion-global-layout");1<n.find('[fusion-global-layout="'+s+'"]').length&&e('[fusion-global-layout="'+s+'"]').each(function(){o=!1,e(this).hasClass("fusion-global-container")?o=FusionPageBuilderApp.isChildElementChanged(e(this),"container"):e(this).hasClass("fusion-global-column")&&(o=FusionPageBuilderApp.isChildElementChanged(e(this),"column")),i=void 0===e(this).data("cid")?e(this).find(".fusion-builder-data-cid").data("cid"):e(this).data("cid"),t=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),(0<_.keys(t.changed).length||!0===o)&&-1===e.inArray(s,a)&&(FusionPageBuilderApp.updateGlobalLayouts(this,t,s),a.push(s))})})},isChildElementChanged:function(i,t){var n,o,a=!1;if("container"===t)i.find(".fusion-builder-row-content:not(.fusion_builder_row_inner .fusion-builder-row-content)").each(function(){var i,t=e(this),n=t.data("cid");if(i=FusionPageBuilderElements.find(function(e){return e.get("cid")===n}),0<_.keys(i.changed).length)return a=!0,!1;t.find(".fusion-builder-column-outer").each(function(){var i=e(this),t=i.data("cid"),n=FusionPageBuilderElements.find(function(e){return e.get("cid")===t});if(0<_.keys(n.changed).length)return a=!0,!1;i.children(".fusion_module_block, .fusion_builder_row_inner").each(function(){var i,n,o,s;if(e(this).hasClass("fusion_module_block")){if(i=e(this),n=i.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===n}),0<_.keys(o.changed).length)return a=!0,!1}else e(this).hasClass("fusion_builder_row_inner")&&(s=e(this).data("cid"),void 0!==FusionPageBuilderViewManager.getView(s)&&(a=FusionPageBuilderApp.isNestedRowChanged("",t)))})})});else if("column"===t){if("",n=i.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===n}),0<_.keys(o.changed).length)return a=!0,!1;i.find(".fusion_builder_column_element:not(.fusion-builder-column-inner .fusion_builder_column_element)").each(function(){var i,t,o,s,r;if(e(this).hasClass("fusion_module_block")){if(i=e(this),t=void 0===i.data("cid")?i.find(".fusion-builder-data-cid").data("cid"):i.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===t}),0<_.keys(o.changed).length)return a=!0,!1}else e(this).hasClass("fusion_builder_row_inner")&&(r=void 0===(s=e(this)).data("cid")?s.find(".fusion-builder-data-cid").data("cid"):s.data("cid"),void 0!==FusionPageBuilderViewManager.getView(r)&&(a=FusionPageBuilderApp.isNestedRowChanged("",n)))})}return a},isNestedRowChanged:function(i){var t;return i&&i.preventDefault(),0<_.keys(this.model.changed).length?(t=!0,!1):(this.$el.find(".fusion-builder-column-inner").each(function(){var i=e(this),n=i.data("cid"),o=FusionPageBuilderElements.findWhere({cid:n});if(0<_.keys(o.changed).length)return t=!0,!1;i.find(".fusion_module_block").each(function(){var i=e(this),n=void 0===i.data("cid")?i.find(".fusion-builder-data-cid").data("cid"):i.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===n});if(0<_.keys(o.changed).length)return t=!0,!1})}),t)},checkGlobalParents:function(i){var t,n=e("#fusion_builder_main_container");module=FusionPageBuilderElements.find(function(e){return e.get("cid")===i}),"undefined"!=typeof module&&(void 0!==module.attributes.params&&void 0!==module.attributes.params.fusion_global&&1<n.find('[fusion-global-layout="'+module.attributes.params.fusion_global+'"]').length&&void 0!==(t=FusionPageBuilderViewManager.getView(module.get("cid")))&&FusionPageBuilderApp.updateGlobalLayouts(t.$el,module,module.attributes.params.fusion_global),void 0!==module.attributes.params&&void 0!==module.get("parent")&&FusionPageBuilderApp.checkGlobalParents(module.get("parent")))},updateGlobalLayouts:function(i,t,n){var o,a,s,r,u=e(i),l="";e(i).hasClass("fusion_builder_column_element")&&!e(i).hasClass("fusion_builder_row_inner")?l+=FusionPageBuilderApp.generateElementShortcode(e(i),!1):e(i).hasClass("fusion_builder_row_inner")?(s=u.data("cid"),r=FusionPageBuilderViewManager.getView(s),l+=r.getInnerRowContent(u)):e(i).hasClass("fusion-builder-column")?(o=e(i).data("cid"),a=FusionPageBuilderViewManager.getView(o),l+=a.getColumnContent(e(i))):e(i).hasClass("fusion_builder_container")&&(l+=FusionPageBuilderApp.generateElementShortcode(e(i),!0),u.find(".fusion_builder_row").each(function(){var i=e(this);l+="[fusion_builder_row]",i.find(".fusion-builder-column-outer").each(function(){var i=e(this),t=i.data("cid"),n=FusionPageBuilderViewManager.getView(t);l+=n.getColumnContent(i)}),l+="[/fusion_builder_row]"}),l+="[/fusion_builder_container]"),e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,dataType:"json",data:{action:"fusion_builder_update_layout",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,fusion_layout_id:n,fusion_layout_content:l},complete:function(){}})},saveHistoryState:function(){!0===this.newLayoutLoaded&&(fusionHistoryManager.clearEditor(),this.newLayoutLoaded=!1),fusionHistoryManager.captureEditor(),fusionHistoryManager.turnOffTracking()},generateElementShortcode:function(i,t,n){var o,a,s,r,u,l,d,c,f,p,m,g,_,h,b,v,y,w,B="",P="";if(!0===n?o=i:(s=void 0===(a=i).data("cid")?a.find(".fusion-builder-data-cid").data("cid"):a.data("cid"),o=FusionPageBuilderElements.find(function(e){return e.get("cid")===s})),void 0!==FusionPageBuilderViewManager.getView(s)&&"function"==typeof this.beforeGenerateShortcode&&this.beforeGenerateShortcode(s),r=void 0!==o?o.get("element_type"):"undefined",l="",u=o.attributes,(d=void 0!==fusionAllElements[r].remove_from_atts?fusionAllElements[r].remove_from_atts:[]).push("undefined"),c=void 0!==fusionAllElements[r].option_dependency?fusionAllElements[r].option_dependency:"",void 0!==u.params)for(g in m=void 0!==o.get("params")?o.get("params"):"")"element_content"===(_=g)?(P=h=void 0!==m[g]?m[g]:"",void 0!==m[c]&&""!==c&&(P=void 0!==m[f=void 0!==m[c=fusionAllElements[r].option_dependency]?m[c]:""]?m[f]:"")):(b="",""!==c&&(p=_,f=void 0!==m[c]?m[c]:"",void 0!==fusionAllElements[r].params[p]&&void 0!==fusionAllElements[r].params[p].dependency&&(y=void 0!==(v=fusionAllElements[r].params[p].dependency).element?v.element:"",w=void 0!==v.value?v.value:"",y===c&&w!==f&&(b="",b=p))),-1<e.inArray(g,d)||b===g||(null===(h=void 0!==m[g]?m[g]:"")&&(h=""),("on"===fusionBuilderConfig.removeEmptyAttributes&&""!==h||"off"===fusionBuilderConfig.removeEmptyAttributes)&&(B+=" "+g+'="'+h+'"')));return l="["+r+B,""===P&&"fusion_tab"!==r&&"fusion_text"!==r&&"fusion_code"!==r&&void 0!==u.type&&"element"===u.type?(t=!0,l+=" /]"):l+="]",t||(l+=P+"[/"+r+"]"),"object"!=typeof this.simplifiedMap&&(this.simplifiedMap=[]),this.simplifiedMap.push({shortcode:l,params:m,type:r}),l},shouldExclude:function(e,i){var t={link_color:"fusion_builder_container",link_hover_color:"fusion_builder_container"};return void 0!==t[e]&&i===t[e]},customCSS:function(i){i&&i.preventDefault(),e(".fusion-custom-css").slideToggle()},toggleAllContainers:function(i){var t,n,o=this;i&&i.preventDefault(),(t=e(".fusion-builder-layout-buttons-toggle-containers").find("span")).hasClass("dashicons-arrow-up")?(t.removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down"),jQuery(".fusion_builder_container").each(function(){n=jQuery(this).find(".fusion-builder-data-cid").data("cid"),o.collection.find(function(e){return e.get("cid")===n}).attributes.params.admin_toggled="yes",jQuery(this).addClass("fusion-builder-section-folded"),jQuery(this).find(".fusion-builder-toggle > span").removeClass("dashicons-arrow-up").addClass("dashicons-arrow-down")})):(t.addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down"),jQuery(".fusion_builder_container").each(function(){n=jQuery(this).find(".fusion-builder-data-cid").data("cid"),o.collection.find(function(e){return e.get("cid")===n}).attributes.params.admin_toggled="no",jQuery(this).removeClass("fusion-builder-section-folded"),jQuery(this).find(".fusion-builder-toggle > span").addClass("dashicons-arrow-up").removeClass("dashicons-arrow-down")})),FusionPageBuilderEvents.trigger("fusion-element-edited")},showSavedElements:function(e,i){var t,n=jQuery("#fusion-builder-layouts-"+e).find(".fusion-page-layouts").clone();n.find("li").each(function(){t=jQuery(this).find(".fusion-builder-demo-button-load").attr("data-post-id"),jQuery(this).find(".fusion-layout-buttons").remove(),jQuery(this).find("h4").attr("class","fusion_module_title"),jQuery(this).attr("data-layout_id",t),jQuery(this).addClass("fusion_builder_custom_"+e+"_load"),""!==jQuery(this).attr("data-layout_type")&&jQuery(this).addClass("fusion-element-type-"+jQuery(this).attr("data-layout_type"))}),i.append('<div id="fusion-loader"><span class="fusion-builder-loader"></span></div>'),i.append('<ul class="fusion-builder-all-modules">'+n.html()+"</div>")},rangeOptionPreview:function(i){i.find(".fusion-range-option").each(function(){e(this).next().html(e(this).val()),e(this).on("change mousemove",function(){e(this).next().html(e(this).val())})})},addClassToElement:function(e,i,t,n){var o=fusionBuilderText.global_element;e.addClass(i),e.attr("fusion-global-layout",t),"fusion-global-column"===i?o=fusionBuilderText.global_column:"fusion-global-container"===i&&(o=fusionBuilderText.global_container),e.find(".fusion-builder-container-utility-toolbar").length?e.find(".fusion-builder-container-utility-toolbar").append('<div class="fusion-builder-global-tooltip" data-cid="'+n+'"><span>'+o+"</span></div>"):e.append('<div class="fusion-builder-global-tooltip" data-cid="'+n+'"><span>'+o+"</span></div>")},calculateTableData:function(e,i){var t,n,o,a,s,r;return void 0===e.element_content||""===e.element_content?e:(t=jQuery.parseHTML(e.element_content.trim()),o=(n=jQuery(t).find("tbody > tr")).length+1,a=jQuery(t).find("th").length,s=n.first().children("td").length,r=Math.max(a,s),e.fusion_table_columns=r,e.fusion_table_rows=o,e)},checkOptionDependency:function(i,t,n,o,a){var s,r,u,l,d,c,f,p,m,g,_,h={},b="",v="",y=i.params;function w(e,i,t){return"=="===t&&e==i||("!="===t&&e!=i||(">"===t&&e>i||("<"===t&&e<i||("contains"===t&&-1!==e.toString().indexOf(i)||("not_contain"===t||"doesnt_contain"===t)&&-1===e.toString().indexOf(i)))))}void 0!==o&&(y=o),void 0!==i.shortcode&&"fusion_section_separator"===i.shortcode&&(d=t.find("#divider_type"),c=d.parents("ul").find('li[data-option-id="divider_candy"]').find(".fusion-option-divider_candy").find('.ui-button[data-value="bottom,top"]'),f=d.parents("ul").find('li[data-option-id="divider_position"]').find(".fusion-option-divider_position").find('.ui-button[data-value="center"]'),"triangle"!==d.val()?c.hide():c.show(),"bigtriangle"!==d.val()?f.hide():f.show(),d.on("change paste keyup",function(){"triangle"!==jQuery(this).val()?c.hide():c.show(),"bigtriangle"!==jQuery(this).val()?(f.hide(),f.hasClass("ui-state-active")&&f.prev().click()):f.show()})),jQuery.each(y,function(i,a){void 0!==a.dependency&&(u=i,l=[],jQuery.each(a.dependency,function(e,i){void 0!==o&&"parent_"===i.element.substring(0,7)&&0>v.indexOf("#"+i.element.replace("parent_",""))?v+=', [data-option-id="'+i.element.replace("parent_","")+'"]':0>b.indexOf('[data-option-id="'+i.element+'"]')&&(b+=', [data-option-id="'+i.element+'"]'),void 0===h[i.element]?h[i.element]=[{option:u,or:a.or}]:h[i.element].push({option:u,or:a.or}),"fusion_builder_container"===i.element?(s="legacy",(g=t.attr("data-cid"))&&(g=FusionPageBuilderApp.$el.find("[data-cid="+g+"]").closest(".fusion-builder-section-content").attr("data-cid"))&&"object"==typeof(m=FusionPageBuilderViewManager.getView(g))&&(_=m.model.get("params"),_=jQuery.extend(!0,{},fusionAllElements.fusion_builder_container.defaults,_),s=_[void 0!==i.param?i.param:"type"])):"parent_"===i.element.substring(0,7)?s=void 0!==o?t.parents(".fusion-builder-main-settings").find("#"+i.element.replace("parent_","")).val():"object"==typeof n&&n[i.element.replace(i.element.substring(0,7),"")]?n[i.element.replace(i.element.substring(0,7),"")]:"":""===(s=t.find('[data-option-id="'+i.element+'"]').filter(function(){return 0===jQuery(this).closest(".dynamic-param-fields").length}).find("#"+i.element).val())&&"true"===t.find("#"+i.element).closest(".fusion-builder-option").attr("data-dynamic")&&(s="using-dynamic-value"),l.push(w(s,i.value,i.operator))}),p=t.find('[name ="'+i+'"]').closest(".fusion-builder-option"),-1===e.inArray(!1,l)&&void 0===a.or?p.fadeIn(300):-1!==e.inArray(!0,l)&&void 0!==a.or?p.fadeIn(300):p.hide())}),b.length&&t.find(b.substring(2)).filter(function(){return 0===jQuery(this).closest(".dynamic-param-fields").length}).on("change paste keyup",function(){r=jQuery(this).attr("data-option-id"),jQuery.each(h[r],function(i,o){l=[],jQuery.each(y[o.option].dependency,function(e,i){"fusion_builder_container"===i.element?(s="legacy",(g=t.attr("data-cid"))&&(g=FusionPageBuilderApp.$el.find("[data-cid="+g+"]").closest(".fusion-builder-section-content").attr("data-cid"))&&"object"==typeof(m=FusionPageBuilderViewManager.getView(g))&&(_=m.model.get("params"),_=jQuery.extend(!0,{},fusionAllElements.fusion_builder_container.defaults,_),s=_[void 0!==i.param?i.param:"type"])):s="parent_"===i.element.substring(0,7)?"object"==typeof n&&n[i.element.replace(i.element.substring(0,7),"")]?n[i.element.replace(i.element.substring(0,7),"")]:"":t.find('[data-option-id="'+i.element+'"]').filter(function(){return 0===jQuery(this).closest(".dynamic-param-fields").length}).find("#"+i.element).val(),""===s&&"true"===jQuery("#"+r).closest(".fusion-builder-option").attr("data-dynamic")&&(s="using-dynamic-value"),l.push(w(s,i.value,i.operator))}),p=t.find('[data-option-id="'+o.option+'"]'),-1===e.inArray(!1,l)&&void 0===o.or?p.fadeIn(300):-1!==e.inArray(!0,l)&&void 0!==o.or?p.fadeIn(300):p.hide()})}),void 0!==o&&void 0!==a&&v.length&&a.on("change paste keyup",v.substring(2),function(){r=jQuery(this).attr("id"),jQuery.each(h["parent_"+r],function(i,n){l=[],jQuery.each(y[n.option].dependency,function(e,i){s="parent_"===i.element.substring(0,7)?a.find("#"+i.element.replace("parent_","")).val():a.find("#"+i.element).val(),l.push(w(s,i.value,i.operator))}),p=t.find("#"+n.option).parents(".fusion-builder-option").first(),-1===e.inArray(!1,l)&&void 0===n.or?p.fadeIn(300):-1!==e.inArray(!0,l)&&void 0!==n.or?p.fadeIn(300):p.hide()})})},getParentContainer:function(e){var i=e;return"object"!=typeof e&&(i=FusionPageBuilderViewManager.getView(e)),!(!i||void 0===i.model.get)&&("fusion_builder_container"===i.model.get("element_type")?i:!!i.model.get("parent")&&this.getParentContainer(i.model.get("parent")))},getParentColumn:function(e){var i=e;return"object"!=typeof e&&(i=FusionPageBuilderViewManager.getView(e)),!(!i||void 0===i.model.get)&&("fusion_builder_column"===i.model.get("element_type")||"fusion_builder_column_inner"===i.model.get("element_type")?i:!!i.model.get("parent")&&this.getParentColumn(i.model.get("parent")))},isBlockLayoutColumn:function(e){var i;return!(!e||void 0===e.model.get)&&((i=e.model.get("params"))&&"block"===i.content_layout)},isFlex:function(e){var i,t=void 0!==fusionBuilderConfig.container_legacy_support&&fusionBuilderConfig.container_legacy_support;return!1===t||0===t||"0"===t||!(!e||void 0===e.model.get)&&((i=e.model.get("params"))&&"flex"===i.type)}}),FusionPageBuilderApp=new FusionPageBuilder.AppView({model:FusionPageBuilder.Element,collection:FusionPageBuilderElements}),n=e("#fusion_use_builder"),o=e("#fusion_toggle_builder"),a=e("#fusion_builder_layout"),s=e("#fusion_main_editor_wrap"),o.hasClass("fusion_builder_is_active")&&(a.show(),FusionPageBuilderApp.builderActive=!0,r(),jQuery("body").addClass("fusion-builder-enabled")),o.click(function(i){var t,l,d;i&&i.preventDefault(),e(this).hasClass("fusion_builder_is_active")?(e(this),u(),l=e("body"),d=0,window.wpActiveEditor="content",n.val("off"),a.hide(),o.children("span").text(o.data("builder")),o.toggleClass("fusion_builder_is_active").toggleClass("button-primary").toggleClass("fusiona-FB_logo_black"),s.toggleClass("fusion_builder_hidden"),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),d=l.scrollTop(),jQuery("html, body").scrollTop(d+1),FusionPageBuilderApp.builderActive=!1,jQuery("body").removeClass("fusion-builder-enabled"),jQuery("body").trigger("scroll")):(t=e(this),u(),FusionPageBuilderApp.initialBuilderLayout(),n.val("active"),a.show(),t.children("span").text(t.data("editor")),t.toggleClass("fusion_builder_is_active").toggleClass("button-primary").toggleClass("fusiona-FB_logo_black"),s.toggleClass("fusion_builder_hidden"),r(),FusionPageBuilderApp.builderActive=!0,jQuery("body").addClass("fusion-builder-enabled"))}),jQuery("#fusion_toggle_front_end").on("click",function(i){var t=jQuery("#title"),n=jQuery(this);i.preventDefault(),window.confirm(fusionBuilderText.front_end_redirect_confirm)&&(t.val()||t.val("FB #"+jQuery("#post_ID").val()),wp.autosave&&wp.autosave.server.triggerSave(),jQuery(document).on("heartbeat-tick.autosave",function(){jQuery(window).off("beforeunload.edit-post"),e.ajax({type:"POST",url:fusionBuilderConfig.ajaxurl,data:{action:"update_page_template_post_meta",fusion_load_nonce:fusionBuilderConfig.fusion_load_nonce,post_id:jQuery("#post_ID").val()}}).done(function(){window.location=n.attr("href")})}))}),e("body").on("click",".upload-image-remove",function(i){var t,n,o,a;i&&i.preventDefault(),t=e(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-field"),n=e(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-preview"),o=e(this).parents(".fusion-builder-option-container").find(".fusion-builder-upload-button"),t.val("").trigger("change"),o.val("Upload Image"),n.remove(),FusionPageBuilderEvents.trigger("awb-image-upload-url-"+o.data("param"),""),a=o.parents(".fusion-builder-option").next().find("#"+o.data("param")+"_id"),"element_content"===o.data("param")&&(a=o.parents(".fusion-builder-option").next().find("#image_id")),a.length&&a.val(""),jQuery(this).remove()}),e("body").on("click",".fusion-builder-history-list li",function(i){var t;i&&i.preventDefault(),t=e(i.currentTarget).data("state-id"),fusionHistoryManager.historyStep(t)}),e("body").on("click",".fusion-studio-preview-active .awb-import-studio-item-in-preview",function(e){var i=jQuery(e.currentTarget).closest(".studio-wrapper ").data("layout-id");e.preventDefault(),jQuery(".fusion-studio-preview-active .fusion-studio-preview-back").trigger("click"),jQuery('.fusion-page-layout[data-layout-id="'+i+'"]').find(".awb-import-studio-item").trigger("click")}),e("body").on("click",".studio-wrapper .fusion-page-layout:not(.awb-demo-pages-layout) img",function(i){var t=jQuery(i.currentTarget).closest(".fusion-page-layout"),n=t.data("url"),o=e(i.currentTarget).closest(".studio-wrapper");o.addClass("loading fusion-studio-preview-active"),o.find(".awb-import-options").addClass("open"),o.find(".fusion-loader").show(),o.append('<iframe class="awb-studio-preview-frame" src="'+n+'" frameBorder="0" scrolling="auto" onload="FusionPageBuilderApp.studioPreviewLoaded();" allowfullscreen=""></iframe>'),o.data("layout-id",t.data("layout-id"))}),e("body").on("click",".fusion-studio-preview-back",function(i){var t=e(i.currentTarget).closest(".studio-wrapper");i.preventDefault(),t.removeClass("fusion-studio-preview-active"),t.find(".awb-import-options").removeClass("open"),t.find(".awb-studio-preview-frame").remove()}),e("body").on("click",".fusion-tabs-menu a",function(i){var t;i&&i.preventDefault(),FusionPageBuilderEvents.trigger("fusion-switch-element-option-tabs"),FusionPageBuilderEvents.trigger("fusion-switch-element-option-tabs"),e(this).parent().addClass("current").removeClass("inactive"),e(this).parent().siblings().removeClass("current").addClass("inactive"),t=e(this).attr("href"),e(this).parents(".fusion-builder-modal-container").find(".fusion-tab-content").not(t).css("display","none"),e(".fusion-builder-layouts-tab").hide(),e(this).parents(".fusion-builder-modal-container").length?e(this).parents(".fusion-builder-modal-container").find(".fusion-tab-content"+t).fadeIn("fast"):e(t).fadeIn("fast"),e(this).parents(".fusion-builder-modal-container").find(".fusion-builder-main-settings").scrollTop(0),jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").length&&setTimeout(function(){jQuery(".fusion-builder-modal-top-container").find(".fusion-elements-filter").focus()},50),"#fusion-builder-fusion_template-studio"===t&&(new FusionPageBuilder.BaseLibraryView).loadStudio("fusion_template"),"#fusion-builder-layouts-demos"===t&&(new FusionPageBuilder.BaseLibraryView).loadWebsite()}),e("body").on("click",".fusion-viewport-indicator a",function(e){var i=jQuery(e.target),t=i.closest("li").data("viewport");e&&e.preventDefault(),i.closest(".fusion-builder-modal-settings-container").find(".fusion-builder-main-settings").removeClass("fusion-large fusion-medium fusion-small").addClass(t),i.closest("ul").find("li").removeClass("active"),i.closest("li").addClass("active"),i.closest(".postbox").removeClass("fusion-large fusion-medium fusion-small").addClass(t),i.closest(".postbox").find("ul.fusion-viewport-indicator li").removeClass("active"),i.closest(".postbox").find("ul.fusion-viewport-indicator").find('li[data-viewport="'+t+'"]').addClass("active")}),e("body").on("click",'.fusion_builder_module_settings[data-type="fusion_builder_container"] li.fusion-builder-option[data-option-id="type"] a',function(e){var i=jQuery(e.target),t=jQuery(e.target).closest(".fusion_builder_module_settings");"flex"===i.data("value")?t.addClass("has-flex"):t.removeClass("has-flex")}),jQuery(".fusion_builder_modal_overlay").on("click",function(){FusionPageBuilderEvents.trigger("fusion-remove-modal-view"),FusionPageBuilderEvents.trigger("fusion-close-modal")}),jQuery(".fusion_builder_modal_inner_row_overlay").on("click",function(){FusionPageBuilderEvents.trigger("fusion-close-inner-modal"),FusionPageBuilderEvents.trigger("fusion-hide-library")}),t=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .demo-"+t).show(),jQuery(".fusion-builder-demo-select").on("change",function(){t=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .fusion-page-layouts").hide(),jQuery("#fusion-builder-demo-url-invalid").hide(),jQuery(".fusion-builder-demo-page-link").val(""),jQuery("#fusion-builder-layouts-demos .demo-"+t).show()}),jQuery(".fusion-builder-demo-page-link").on("input",function(){var e,i,t,n=jQuery(this).val();"/"===(n=n.replace("https://","").replace("http://",""))[n.length-1]||_.isEmpty(n)||(n+="/"),i=(e=jQuery("#fusion-builder-layouts-demos").find('.fusion-page-layout[data-page-link="'+n+'"]')).closest(".fusion-page-layouts"),jQuery("#fusion-builder-layouts-demos .fusion-page-layouts").hide(),jQuery("#fusion-builder-demo-url-invalid").hide(),_.isEmpty(n)?(t=jQuery(".fusion-builder-demo-select").val(),jQuery("#fusion-builder-layouts-demos .demo-"+t).show()):e.length?(i.show(),i.find(".fusion-page-layout").hide(),e.show()):jQuery("#fusion-builder-demo-url-invalid").show()}),jQuery("body").on("click",".icon_select_container .icon_preview",function(i){var t,n="fas",o=jQuery(this).find("i"),a="",s=jQuery(this).closest(".fusion-iconpicker");i.preventDefault(),t="fa-"+jQuery(this).find("i").attr("data-name"),o.hasClass("fas")||o.hasClass("fab")||o.hasClass("far")||o.hasClass("fal")?o.hasClass("fab")?n="fab":o.hasClass("far")?n="far":o.hasClass("fal")&&(n="fal"):a="fusion-prefix-"+jQuery(this).find("i").attr("class"),""===a&&(a=t+" "+n),e(this).hasClass("selected-element")?(s.find(".selected-element").removeClass("selected-element"),s.find(".fusion-iconpicker-input").attr("value","").trigger("change")):(s.find(".selected-element").removeClass("selected-element"),e(this).find("i").parent().addClass("selected-element"),s.find(".fusion-iconpicker-input").attr("value",a).trigger("change"))}),e(document).on("click","#qt_content_fusion_shortcodes_text_mode, #qt_excerpt_fusion_shortcodes_text_mode, #qt_element_content_fusion_shortcodes_text_mode",function(){openShortcodeGenerator(e(this))}),e('input[type="radio"][name="screen_columns"]').on("click",function(){e(window).trigger("resize")}),e(".notice-dismiss, #show-settings-link").on("click",function(){setTimeout(function(){e(window).trigger("resize")},750)}),e("#new_template_name").on("keydown",function(e){return 13!==e.keyCode&&"13"!==e.keyCode||(e.preventDefault(),e.stopPropagation(),FusionPageBuilderEvents.trigger("fusion-save-layout"),!1)}),e("body").on("keydown","#fusion-builder-save-element-input",function(i){return 13!==i.keyCode&&"13"!==i.keyCode||(i.preventDefault(),i.stopPropagation(),e(".fusion-builder-element-button-save").trigger("click"),!1)}),jQuery(".fusion-preview").click(function(e){e.preventDefault(),jQuery("#post-preview").trigger("click")}),jQuery(".fusion-save-draft").click(function(e){e.preventDefault(),jQuery("#save-post").trigger("click")}),jQuery(".fusion-update").click(function(e){e.preventDefault(),jQuery("#publish").trigger("click")}),l(),FusionPageBuilder.reInitIconPicker=function(){jQuery(".fusion-icons-rendered").remove(),jQuery(".fusion-icon-picker-nav-rendered").remove(),l()}})}(jQuery),function(e){window.fusionBuilderInsertIntoEditor=function(i,t){var n,o;"tinymce"!==window.SCmoduleContentEditorMode||""!==t&&void 0!==t?("excerpt"===(n=e(null===t||""===t||void 0===t?window.editorArea:"#"+t)).attr("id")&&(FusionPageBuilderApp.fromExcerpt=!0),void 0===window.cursorPosition?0===n.getCursorPosition()?n.val(i+n.val()):n.val().length===n.getCursorPosition()?n.val(n.val()+i):n.val(n.val().slice(0,n.getCursorPosition())+i+n.val().slice(n.getCursorPosition())):n.val([n.val().slice(0,window.cursorPosition),i,n.val().slice(window.cursorPosition)].join(""))):void 0!==window.tinyMCE&&((o=FusionPageBuilderApp.shortcodeGeneratorActiveEditor).focus(),"excerpt"===o.id&&(FusionPageBuilderApp.fromExcerpt=!0),window.tinyMCE.activeEditor.execCommand("mceInsertContent",!1,i),window.tinyMCE.activeEditor.execCommand("mceCleanup",!1)),!1===FusionPageBuilderApp.manuallyAdded&&(FusionPageBuilderApp.shortcodeGeneratorActiveEditor="")}}(jQuery),function(e){e.fn.getCursorPosition=function(){var i,t,n=e(this).get(0),o=0;return"selectionStart"in n?o=n.selectionStart:"selection"in document&&(n.focus(),i=document.selection.createRange(),t=document.selection.createRange().text.length,i.moveStart("character",-n.value.length),o=i.text.length-t),o}}(jQuery),function(e){var i={},t=new Array("[]"),n=new Array("[]"),o=0;window.tracking="on",window.fusionHistoryState="",window.fusionHistoryManager=i,i.captureEditor=function(){var a;i.isTrackingOn()&&(25==o?t.shift():o+=1,1<o&&(e(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),e(".fusion-builder-history-list").prepend('<li data-state-id="'+o+'" class="history-state-'+o+' fusion-history-active-state"><span class="dashicons dashicons-arrow-right-alt2"></span>'+fusionHistoryState+"</li>")),a=fusionBuilderGetContent("content",!0),t[o]=a,n[o]=fusionHistoryState,i.updateButtons(),fusionHistoryState="")},i.turnOnTracking=function(){window.tracking="on","undefined"!=typeof FusionPageBuilderApp&&FusionPageBuilderApp.pauseBuilder&&i.turnOffTracking()},i.turnOffTracking=function(){window.tracking="off"},i.doUndo=function(n){var a;n&&n.preventDefault(),i.hasUndo()&&(i.turnOffTracking(),"[]"!==(a=t[o-=1])&&(FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(a),e(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),e(".fusion-builder-history-list").find(".history-state-"+o).addClass("fusion-history-active-state")),i.updateButtons())},i.doRedo=function(n){var a;n&&n.preventDefault(),i.hasRedo()&&(i.turnOffTracking(),a=t[o+=1],FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(a),i.updateButtons(),e(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),e(".fusion-builder-history-list").find(".history-state-"+o).addClass("fusion-history-active-state"))},i.historyStep=function(n,a){var s;a&&a.preventDefault(),s=t[n],FusionPageBuilderApp.clearBuilderLayout(),FusionPageBuilderApp.$el.find(".fusion_builder_container").remove(),FusionPageBuilderApp.createBuilderLayout(s),o=n,i.updateButtons(),e(".fusion-builder-history-list li").removeClass("fusion-history-active-state"),e(".fusion-builder-history-list").find(".history-state-"+o).addClass("fusion-history-active-state")},i.isTrackingOn=function(){return"on"===window.tracking},i.logStacks=function(){},i.clearEditor=function(a){var s;t=new Array("[]"),n=new Array("[]"),o=1,fusionHistoryState="","blank"===a?t[o]="":(s=fusionBuilderGetContent("content",!0),t[o]=s),i.updateButtons(),e(".fusion-builder-history-list").html('<li data-state-id="1" class="history-state-1 fusion-history-active-state"><span class="dashicons dashicons-arrow-right-alt2"></span>'+fusionBuilderText.empty+"</li>")},i.hasUndo=function(){return 1!==o},i.hasRedo=function(){return o<t.length-1},i.getCommands=function(){return t},i.updateButtons=function(){i.hasUndo()?(e(".fusion-builder-layout-buttons-undo").addClass("fusion-history-has-step"),e(".fusion-builder-layout-buttons-history").addClass("fusion-history-has-step")):(e(".fusion-builder-layout-buttons-undo").removeClass("fusion-history-has-step"),e(".fusion-builder-layout-buttons-history").removeClass("fusion-history-has-step")),i.hasRedo()?e(".fusion-builder-layout-buttons-redo").addClass("fusion-history-has-step"):e(".fusion-builder-layout-buttons-redo").removeClass("fusion-history-has-step")}}(jQuery);